
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>NASM</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="/global/main.css" title="default">
</head>

<body>



<div id="container">
<div id="banner">
<a href='/'><img src='/include/images/linuxmanpages_logo.png' alt='Linux Man Pages' border='0'></a>
</div>
<div id="formLinks">
<table id="searchTable">
<tr>
<form action='/search.php' method='post'>
<td>Search For :</td>
<td><input type="text" size="20" name="term"></td>
<td>in: </td>

<td>
<select name="section">
<option value="-1">All Sections</option>
<option value="1">1. General Commands</option>
<option value="2">2. System Calls</option>
<option value="3">3. Subroutines</option>
<option value="4">4. Special Files</option>
<option value="5">5. File Formats</option>
<option value="6">6. Games and Demos</option>
<option value="7">7. Macros and Conventions</option>
<option value="8">8. Maintenence Commands</option>
</select> 
</td>
<td>
<input type='hidden' name='submitted' value='1'>
<input type="submit" value="Get Man Page">
</td>
</form>
</tr>
</table>
</div>
<div id="content">

<div id='catHeader'><table width='100%'><tr><td>
<H1>NASM</H1>
Section: User Commands  (1)<BR>Updated: The Netwide Assembler Project<BR>
</td><td align='right' valign='bottom'><div class='ad_header_right'></div></td></tr></table></div></div>
<div id='categories'>
<div class='ad_man_right'>
</div>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

nasm - the Netwide Assembler - portable 80x86 assembler
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>nasm</B>

[
<B>-f</B>

format
] [
<B>-o</B>

outfile
] [
<I>options</I>...

] infile
<BR>

<B>nasm -h</B>

<BR>

<B>nasm -r</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

The
<B>nasm</B>

command assembles the file
<I>infile</I>

and directs output to the file
<I>outfile</I>

if specified. If
<I>outfile</I>

is not specified,
<B>nasm</B>

will derive a default output file name from the name of its input
file, usually by appending `.o' or `.obj', or by removing all
extensions for a raw binary file. Failing that, the output file name
will be `nasm.out'.
<A NAME="lbAE">&nbsp;</A>
<H3>OPTIONS</H3>

<DL COMPACT>
<DT><B>-h</B>

<DD>
Causes
<B>nasm</B>

to exit immediately, after giving a summary of its invocation
options, and listing all its supported output file formats.
<DT><B>-a</B>

<DD>
Causes
<B>nasm</B>

to assemble the given input file without first applying the macro
preprocessor.
<DT><B>-e</B>

<DD>
Causes
<B>nasm</B>

to preprocess the given input file, and write the output to
<I>stdout</I>

(or the specified output file name), and not actually assemble
anything.
<DT><B>-M</B>

<DD>
Causes
<B>nasm</B>

to output Makefile-style dependencies to stdout; normal output is
suppressed.
<DT><B>-E</B><I> filename</I>

<DD>
Causes
<B>nasm</B>

to redirect error messages to
<I>filename</I>.

This option exists to support operating systems on which stderr is not
easily redirected.
<DT><B>-r</B>

<DD>
Causes
<B>nasm</B>

to exit immediately, after displaying its version number.
<I>(obsolete)</I>

<DT><B>-v</B>

<DD>
Causes
<B>nasm</B>

to exit immediately, after displaying its version number.
<DT><B>-f</B><I> format</I>

<DD>
Specifies the output file format. Formats include
<I>bin</I>,

to produce flat-form binary files, and
<I>aout</I>

and
<I>elf</I>

to produce Linux a.out and ELF object files, respectively.
<DT><B>-o</B><I> outfile</I>

<DD>
Specifies a precise name for the output file, overriding
<B>nasm</B>'s

default means of determining it.
<DT><B>-l</B><I> listfile</I>

<DD>
Causes an assembly listing to be directed to the given file, in
which the original source is displayed on the right hand side (plus
the source for included files and the expansions of multi-line
macros) and the generated code is shown in hex on the left.
<DT><B>-s</B>

<DD>
Causes
<B>nasm</B>

to send its error messages and/or help text to
<I>stdout</I>

instead of
<I>stderr</I>.

<DT><B>-w</B><I>[+-]foo</I>

<DD>
Causes
<B>nasm</B>

to enable or disable certain classes of warning messages, for
example
<B>-w+orphan-labels</B>

or
<B>-w-macro-params</B>

to, respectively, enable warnings about labels alone on lines or
disable warnings about incorrect numbers of parameters in macro
calls.
<DT><B>-I</B><I> directory</I>

<DD>
Adds a directory to the search path for include files. The directory
specification must include the trailing slash, as it will be
directly prepended to the name of the include file.
<DT><B>-i</B><I> directory</I>

<DD>
Same as the
<B>-I</B>

option.
<DT><B>-P</B><I> file</I>

<DD>
Specifies a file to be pre-included, before the main source file
starts to be processed.
<DT><B>-p</B><I> file</I>

<DD>
Same as the
<B>-P</B>

option.
<DT><B>-D</B><I> macro[=value]</I>

<DD>
Pre-defines a single-line macro.
<DT><B>-d</B><I> macro[=value]</I>

<DD>
Same as the
<B>-D</B>

option.
<DT><B>-U</B><I> macro</I>

<DD>
Undefines a single-line macro.
<DT><B>-u</B><I> macro</I>

<DD>
Same as the
<B>-U</B>

option.
</DL>
<P>


<A NAME="lbAF">&nbsp;</A>
<H3>SYNTAX</H3>

This man page does not fully describe the syntax of
<B>nasm</B>'s

assembly language, but does give a summary of the differences from
other assemblers.
<P>

<I>Registers</I>

have no leading `%' sign, unlike
<B>gas</B>,

and floating-point stack registers are referred to as
<I>st0</I>,

<I>st1</I>,

and so on.
<P>

<I>Floating-point instructions</I>

may use either the single-operand form or the double. A
<I>TO</I>

keyword is provided; thus, one could either write
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fadd st0,st1
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fadd st1,st0
<P>

or one could use the alternative single-operand forms
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fadd st1
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fadd to st1
<P>

<I>Uninitialised storage</I>

is reserved using the
<I>RESB</I>,

<I>RESW</I>,

<I>RESD</I>,

<I>RESQ</I>

and
<I>REST</I>

pseudo-opcodes, each taking one parameter which gives the number of
bytes, words, doublewords, quadwords or ten-byte words to reserve.
<P>

<I>Repetition</I>

of data items is not done by the
<I>DUP</I>

keyword as seen in DOS assemblers, but by the use of the
<I>TIMES</I>

prefix, like this:
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


message:<TT>&nbsp;</TT>times 3 db 'abc'<BR>
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
times 64-$+message db 0
<P>

which defines the string `abcabcabc', followed by the right number
of zero bytes to make the total length up to 64 bytes.
<P>

<I>Symbol references</I>

are always understood to be immediate (i.e. the address of the
symbol), unless square brackets are used, in which case the contents
of the memory location are used. Thus:
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ax,wordvar
<P>

loads AX with the address of the variable `wordvar', whereas
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ax,[wordvar]
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ax,[wordvar+1]
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ax,[es:wordvar+bx]
<P>

all refer to the
<I>contents</I>

of memory locations. The syntaxes
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ax,es:wordvar[bx]
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
es mov ax,wordvar[1]
<P>

are not legal at all, although the use of a segment register name as
an instruction prefix is valid, and can be used with instructions
such as
<I>LODSB</I>

which can't be overridden any other way.
<P>

<I>Constants</I>

may be expressed numerically in most formats: a trailing H, Q or B
denotes hex, octal or binary respectively, and a leading `0x' or `$'
denotes hex as well. Leading zeros are not treated specially at all.
Character constants may be enclosed in single or double quotes;
there is no escape character. The ordering is little-endian
(reversed), so that the character constant
<I>'abcd'</I>

denotes 0x64636261 and not 0x61626364.
<P>

<I>Local labels</I>

begin with a period, and their `locality' is granted by the
assembler prepending the name of the previous non-local symbol. Thus
declaring a label `.loop' after a label `label' has actually defined
a symbol called `label.loop'.
<A NAME="lbAG">&nbsp;</A>
<H3>DIRECTIVES</H3>

<I>SECTION name</I>

or
<I>SEGMENT name</I>

causes
<B>nasm</B>

to direct all following code to the named section. Section names
vary with output file format, although most formats support the
names
<I>.text</I>,

<I>.data</I>

and
<I>.bss</I>.

(The exception is the
<I>obj</I>

format, in which all segments are user-definable.)
<P>

<I>ABSOLUTE address</I>

causes
<B>nasm</B>

to position its notional assembly point at an absolute address: so
no code or data may be generated, but you can use
<I>RESB</I>,

<I>RESW</I>

and
<I>RESD</I>

to move the assembly point further on, and you can define labels. So
this directive may be used to define data structures. When you have
finished doing absolute assembly, you must issue another
<I>SECTION</I>

directive to return to normal assembly.
<P>

<I>BITS 16</I>

or
<I>BITS 32</I>

switches the default processor mode for which
<B>nasm</B>

is generating code: it is equivalent to
<I>USE16</I>

or
<I>USE32</I>

in DOS assemblers.
<P>

<I>EXTERN symbol</I>

and
<I>GLOBAL symbol</I>

import and export symbol definitions, respectively, from and to
other modules. Note that the
<I>GLOBAL</I>

directive must appear before the definition of the symbol it refers
to.
<P>

<I>STRUC strucname</I>

and
<I>ENDSTRUC</I>,

when used to bracket a number of
<I>RESB</I>,

<I>RESW</I>

or similar instructions, define a data structure. In addition to
defining the offsets of the structure members, the construct also
defines a symbol for the size of the structure, which is simply the
structure name with
<I>_size</I>

tacked on to the end.
<A NAME="lbAH">&nbsp;</A>
<H3>FORMAT-SPECIFIC DIRECTIVES</H3>

<I>ORG address</I>

is used by the
<I>bin</I>

flat-form binary output format, and specifies the address at which
the output code will eventually be loaded.
<P>

<I>GROUP grpname seg1 seg2...</I>

is used by the
<I>obj</I>

(Microsoft 16-bit) output format, and defines segment groups. This
format also uses
<I>UPPERCASE</I>,

which directs that all segment, group and symbol names output to the
object file should be in uppercase. Note that the actual assembly is
still case sensitive.
<P>

<I>LIBRARY libname</I>

is used by the
<I>rdf</I>

output format, and causes a dependency record to be written to the
output file which indicates that the program requires a certain
library in order to run.
<A NAME="lbAI">&nbsp;</A>
<H3>MACRO PREPROCESSOR</H3>

Single-line macros are defined using the
<I>%define</I>

or
<I>%idefine</I>

commands, in a similar fashion to the C preprocessor. They can be
overloaded with respect to number of parameters, although defining a
macro with no parameters prevents the definition of any macro with
the same name taking parameters, and vice versa.
<I>%define</I>

defines macros whose names match case-sensitively, whereas
<I>%idefine</I>

defines case-insensitive macros.
<P>

Multi-line macros are defined using
<I>%macro</I>

and
<I>%imacro</I>

(the distinction is the same as that between
<I>%define</I>

and
<I>%idefine</I>),

whose syntax is as follows:
<P>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
%macro
<I>name</I>

<I>minprm</I>[-<I>maxprm</I>][+][.nolist] [<I>defaults</I>]

<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;some lines of macro expansion text&gt;
<BR>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
%endmacro
<P>

Again, these macros may be overloaded. The trailing plus sign
indicates that any parameters after the last one get subsumed, with
their separating commas, into the last parameter. The
<I>defaults</I>

part can be used to specify defaults for unspecified macro
parameters after
<I>minparam</I>.

<I>%endm</I>

is a valid synonym for
<I>%endmacro</I>.

<P>

To refer to the macro parameters within a macro expansion, you use
<I>%1</I>,

<I>%2</I>

and so on. You can also enforce that a macro parameter should
contain a condition code by using
<I>%+1</I>,

and you can invert the condition code by using
<I>%-1</I>.

You can also define a label specific to a macro invocation by
prefixing it with a double % sign.
<P>

Files can be included using the
<I>%include</I>

directive, which works like C.
<P>

The preprocessor has a `context stack', which may be used by one
macro to store information that a later one will retrieve. You can
push a context on the stack using
<I>%push</I>,

remove one using
<I>%pop</I>,

and change the name of the top context (without disturbing any
associated definitions) using
<I>%repl</I>.

Labels and
<I>%define</I>

macros specific to the top context may be defined by prefixing their
names with %$, and things specific to the next context down with
%$$, and so on.
<P>

Conditional assembly is done by means of
<I>%ifdef</I>,

<I>%ifndef</I>,

<I>%else</I>

and
<I>%endif</I>

as in C. (Except that
<I>%ifdef</I>

can accept several putative macro names, and will evaluate TRUE if
any of them is defined.) In addition, the directives
<I>%ifctx</I>

and
<I>%ifnctx</I>

can be used to condition on the name of the top context on the
context stack. The obvious set of `else-if' directives,
<I>%elifdef</I>,

<I>%elifndef</I>,

<I>%elifctx</I>

and
<I>%elifnctx</I>

are also supported.
<A NAME="lbAJ">&nbsp;</A>
<H2>BUGS</H2>

There is a reported seg-fault on some (Linux) systems with some
large source files. This appears to be very hard to reproduce. All
other
<I>known</I>

bugs have been fixed...
<A NAME="lbAK">&nbsp;</A>
<H2>RESTRICTIONS</H2>

There is no support for listing files, symbol maps, or debugging
object-file records. The advanced features of the ELF and Win32
object file formats are not supported, and there is no means for
warning the programmer against using an instruction beyond the
capability of the target processor.
<A NAME="lbAL">&nbsp;</A>
<H2>SEE ALSO</H2>

<B>as</B>(<B>1</B>),

<B>ld</B>(<B>1</B>).

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DL>
<DT><A HREF="#lbAE">OPTIONS</A><DD>
<DT><A HREF="#lbAF">SYNTAX</A><DD>
<DT><A HREF="#lbAG">DIRECTIVES</A><DD>
<DT><A HREF="#lbAH">FORMAT-SPECIFIC DIRECTIVES</A><DD>
<DT><A HREF="#lbAI">MACRO PREPROCESSOR</A><DD>
</DL>
<DT><A HREF="#lbAJ">BUGS</A><DD>
<DT><A HREF="#lbAK">RESTRICTIONS</A><DD>
<DT><A HREF="#lbAL">SEE ALSO</A><DD>
</DL>

</div>

<div id="disqus_thread"></div>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=linuxmanpages">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
<div id="footer"><div class="littletext"> LinuxManPages.com &copy; <a class="white"  href="http://www.name.com">Name.com</a>&nbsp;&nbsp;&nbsp;Links: <!--<a class='white' href='http://www.earthsearch.net'>geographic information</a> |-->
<a class='white' href='http://www.who.is'>who.is search</a> |
<a class='white' href='http://www.bluerider.com'>dictionary</a> |
<a class='white' href='http://www.tld.io' class='small'>ccTLD information</a> 
</div></div>
</div>




</body>
</html>
