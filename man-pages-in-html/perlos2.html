
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>PERLOS2</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="/global/main.css" title="default">
</head>

<body>



<div id="container">


<div id="content">

<div id='catHeader'><table width='100%'><tr><td>
<H1>PERLOS2</H1>
Section: Perl Programmers Reference Guide (1)<BR>Updated: 2004-04-23<BR>
</td><td align='right' valign='bottom'><div class='ad_header_right'></div></td></tr></table></div></div>
<div id='categories'>
<div class='ad_man_right'>
</div>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

perlos2 - Perl under OS/2, DOS, Win0.3*, Win0.95 and WinNT.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>
One can read this document in the following formats:
<P>



<PRE>
        man perlos2
        view perl perlos2
        explorer perlos2.html
        info perlos2

</PRE>


<P>

to list some (not all may be available simultaneously), or it may
be read <I>as is</I>: either as <I></I><FONT SIZE="-1"><I>README</I></FONT><I>.os2</I>, or <I>pod/perlos2.pod</I>.
<P>

To read the <I>.INF</I> version of documentation (<B>very</B> recommended)
outside of <FONT SIZE="-1">OS/2</FONT>, one needs an <FONT SIZE="-1">IBM</FONT>'s reader (may be available on <FONT SIZE="-1">IBM</FONT>
ftp sites (?)  (<FONT SIZE="-1">URL</FONT> anyone?)) or shipped with <FONT SIZE="-1">PC</FONT> <FONT SIZE="-1">DOS</FONT> 7.0 and <FONT SIZE="-1">IBM</FONT>'s
Visual Age C<FONT SIZE="-2">++</FONT> 3.5.
<P>

A copy of a Win* viewer is contained in the ``Just add <FONT SIZE="-1">OS/2</FONT> Warp'' package
<P>



<PRE>
  <A HREF="ftp://ftp.software.ibm.com/ps/products/os2/tools/jaow/jaow.zip">ftp://ftp.software.ibm.com/ps/products/os2/tools/jaow/jaow.zip</A>

</PRE>


<P>

in <I>?:\JUST_ADD\view.exe</I>. This gives one an access to <FONT SIZE="-1">EMX</FONT>'s 
<I>.INF</I> docs as well (text form is available in <I>/emx/doc</I> in 
<FONT SIZE="-1">EMX</FONT>'s distribution).  There is also a different viewer named xview.
<P>

Note that if you have <I>lynx.exe</I> or <I>netscape.exe</I> installed, you can follow <FONT SIZE="-1">WWW</FONT> links
from this document in <I>.INF</I> format. If you have <FONT SIZE="-1">EMX</FONT> docs installed 
correctly, you can follow library links (you need to have <TT>&quot;view emxbook&quot;</TT>
working by setting <TT>&quot;EMXBOOK&quot;</TT> environment variable as it is described
in <FONT SIZE="-1">EMX</FONT> docs).
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
<A NAME="lbAE">&nbsp;</A>
<H2>Target</H2>

<A NAME="ixAAE"></A>
The target is to make <FONT SIZE="-1">OS/2</FONT> one of the best supported platform for
using/building/developing Perl and <I>Perl applications</I>, as well as
make Perl the best language to use under <FONT SIZE="-1">OS/2</FONT>. The secondary target is
to try to make this work under <FONT SIZE="-1">DOS</FONT> and Win* as well (but not <B>too</B> hard).
<P>

The current state is quite close to this target. Known limitations:
<DL COMPACT>
<DT>*<DD>
Some *nix programs use <I>fork()</I> a lot; with the mostly useful flavors of
perl for <FONT SIZE="-1">OS/2</FONT> (there are several built simultaneously) this is
supported; but some flavors do not support this (e.g., when Perl is
called from inside <FONT SIZE="-1">REXX</FONT>).  Using <I>fork()</I> after
<I>use</I>ing dynamically loading extensions would not work with <I>very</I> old
versions of <FONT SIZE="-1">EMX</FONT>.
<DT>*<DD>
You need a separate perl executable <I>perl__.exe</I> (see perl__.exe)
if you want to use <FONT SIZE="-1">PM</FONT> code in your application (as Perl/Tk or OpenGL
Perl modules do) without having a text-mode window present.


<P>


While using the standard <I>perl.exe</I> from a text-mode window is possible
too, I have seen cases when this causes degradation of the system stability.
Using <I>perl__.exe</I> avoids such a degradation.
<DT>*<DD>
There is no simple way to access <FONT SIZE="-1">WPS</FONT> objects. The only way I know
is via <TT>&quot;OS2::REXX&quot;</TT> and <TT>&quot;SOM&quot;</TT> extensions (see <FONT SIZE="-1">OS2::REXX</FONT>, Som).
However, we do not have access to
convenience methods of Object-REXX. (Is it possible at all? I know
of no Object-REXX <FONT SIZE="-1">API</FONT>.)  The <TT>&quot;SOM&quot;</TT> extension (currently in alpha-text)
may eventually remove this shortcoming; however, due to the fact that
<FONT SIZE="-1">DII</FONT> is not supported by the <TT>&quot;SOM&quot;</TT> module, using <TT>&quot;SOM&quot;</TT> is not as
convenient as one would like it.
</DL>
<P>

Please keep this list up-to-date by informing me about other items.
<A NAME="lbAF">&nbsp;</A>
<H2>Other OSes</H2>

<A NAME="ixAAF"></A>
Since <FONT SIZE="-1">OS/2</FONT> port of perl uses a remarkable <FONT SIZE="-1">EMX</FONT> environment, it can
run (and build extensions, and - possibly - be built itself) under any
environment which can run <FONT SIZE="-1">EMX</FONT>. The current list is <FONT SIZE="-1">DOS</FONT>,
DOS-inside-OS/2, Win0.3*, Win0.95 and WinNT. Out of many perl flavors,
only one works, see ``perl_.exe''.
<P>

Note that not all features of Perl are available under these
environments. This depends on the features the <I>extender</I> - most
probably <FONT SIZE="-1">RSX</FONT> - decided to implement.
<P>

Cf. Prerequisites.
<A NAME="lbAG">&nbsp;</A>
<H2>Prerequisites</H2>

<A NAME="ixAAG"></A>
<DL COMPACT>
<DT><FONT SIZE="-1">EMX</FONT><DD>
<A NAME="ixAAH"></A>
<FONT SIZE="-1">EMX</FONT> runtime is required (may be substituted by <FONT SIZE="-1">RSX</FONT>). Note that
it is possible to make <I>perl_.exe</I> to run under <FONT SIZE="-1">DOS</FONT> without any
external support by binding <I>emx.exe</I>/<I>rsx.exe</I> to it, see emxbind. Note
that under <FONT SIZE="-1">DOS</FONT> for best results one should use <FONT SIZE="-1">RSX</FONT> runtime, which
has much more functions working (like <TT>&quot;fork&quot;</TT>, <TT>&quot;popen&quot;</TT> and so on). In
fact <FONT SIZE="-1">RSX</FONT> is required if there is no <FONT SIZE="-1">VCPI</FONT> present. Note the
<FONT SIZE="-1">RSX</FONT> requires <FONT SIZE="-1">DPMI</FONT>.  Many implementations of <FONT SIZE="-1">DPMI</FONT> are known to be very
buggy, beware!


<P>


Only the latest runtime is supported, currently <TT>&quot;0.9d fix 03&quot;</TT>. Perl may run
under earlier versions of <FONT SIZE="-1">EMX</FONT>, but this is not tested.


<P>


One can get different parts of <FONT SIZE="-1">EMX</FONT> from, say


<P>




<PRE>
  <A HREF="http://www.leo.org/pub/comp/os/os2/leo/gnu/emx+gcc/">http://www.leo.org/pub/comp/os/os2/leo/gnu/emx+gcc/</A>
  <A HREF="http://powerusersbbs.com/pub/os2/dev/">http://powerusersbbs.com/pub/os2/dev/</A>   [EMX+GCC Development]
  <A HREF="http://hobbes.nmsu.edu/pub/os2/dev/emx/v0.9d/">http://hobbes.nmsu.edu/pub/os2/dev/emx/v0.9d/</A>

</PRE>




<P>


The runtime component should have the name <I>emxrt.zip</I>.


<P>


<B></B><FONT SIZE="-1"><B>NOTE</B></FONT><B></B>. When using <I>emx.exe</I>/<I>rsx.exe</I>, it is enough to have them on your path. One
does not need to specify them explicitly (though this


<P>




<PRE>
  emx perl_.exe -de 0

</PRE>




<P>


will work as well.)
<DT><FONT SIZE="-1">RSX</FONT><DD>
<A NAME="ixAAI"></A>
To run Perl on <FONT SIZE="-1">DPMI</FONT> platforms one needs <FONT SIZE="-1">RSX</FONT> runtime. This is
needed under DOS-inside-OS/2, Win0.3*, Win0.95 and WinNT (see 
``Other OSes''). <FONT SIZE="-1">RSX</FONT> would not work with <FONT SIZE="-1">VCPI</FONT>
only, as <FONT SIZE="-1">EMX</FONT> would, it requires <FONT SIZE="-1">DMPI</FONT>.


<P>


Having <FONT SIZE="-1">RSX</FONT> and the latest <I>sh.exe</I> one gets a fully functional
<B>*nix</B>-ish environment under <FONT SIZE="-1">DOS</FONT>, say, <TT>&quot;fork&quot;</TT>, <TT>``</TT> and
pipe-<TT>&quot;open&quot;</TT> work. In fact, MakeMaker works (for static build), so one
can have Perl development environment under <FONT SIZE="-1">DOS</FONT>. 


<P>


One can get <FONT SIZE="-1">RSX</FONT> from, say


<P>




<PRE>
  <A HREF="ftp://ftp.cdrom.com/pub/os2/emx09c/contrib">ftp://ftp.cdrom.com/pub/os2/emx09c/contrib</A>
  <A HREF="ftp://ftp.uni-bielefeld.de/pub/systems/msdos/misc">ftp://ftp.uni-bielefeld.de/pub/systems/msdos/misc</A>
  <A HREF="ftp://ftp.leo.org/pub/comp/os/os2/leo/devtools/emx+gcc/contrib">ftp://ftp.leo.org/pub/comp/os/os2/leo/devtools/emx+gcc/contrib</A>

</PRE>




<P>


Contact the author on <TT>&quot;<A HREF="mailto:rainer@mathematik.uni-bielefeld.de">rainer@mathematik.uni-bielefeld.de</A>&quot;</TT>.


<P>


The latest <I>sh.exe</I> with <FONT SIZE="-1">DOS</FONT> hooks is available in


<P>




<PRE>
  <A HREF="http://www.ilyaz.org/software/os2/">http://www.ilyaz.org/software/os2/</A>

</PRE>




<P>


as <I>sh_dos.zip</I> or under similar names starting with <TT>&quot;sh&quot;</TT>, <TT>&quot;pdksh&quot;</TT> etc.
<DT><FONT SIZE="-1">HPFS</FONT><DD>
<A NAME="ixAAJ"></A>
Perl does not care about file systems, but the perl library contains
many files with long names, so to install it intact one needs a file
system which supports long file names.


<P>


Note that if you do not plan to build the perl itself, it may be
possible to fool <FONT SIZE="-1">EMX</FONT> to truncate file names. This is not supported,
read <FONT SIZE="-1">EMX</FONT> docs to see how to do it.
<DT>pdksh<DD>
<A NAME="ixAAK"></A>
To start external programs with complicated command lines (like with
pipes in between, and/or quoting of arguments), Perl uses an external
shell. With <FONT SIZE="-1">EMX</FONT> port such shell should be named <I>sh.exe</I>, and located
either in the wired-in-during-compile locations (usually <I>F:/bin</I>),
or in configurable location (see ``<FONT SIZE="-1">PERL_SH_DIR</FONT>'').


<P>


For best results use <FONT SIZE="-1">EMX</FONT> pdksh. The standard binary (5.2.14 or later) runs
under <FONT SIZE="-1">DOS</FONT> (with <FONT SIZE="-1">RSX</FONT>) as well, see


<P>




<PRE>
  <A HREF="http://www.ilyaz.org/software/os2/">http://www.ilyaz.org/software/os2/</A>

</PRE>


</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>Starting Perl programs under <FONT SIZE="-1">OS/2</FONT> (and <FONT SIZE="-1">DOS</FONT> and...)</H2>

<A NAME="ixAAL"></A>
Start your Perl program <I>foo.pl</I> with arguments <TT>&quot;arg1 arg2 arg3&quot;</TT> the
same way as on any other platform, by
<P>



<PRE>
        perl foo.pl arg1 arg2 arg3

</PRE>


<P>

If you want to specify perl options <TT>&quot;-my_opts&quot;</TT> to the perl itself (as
opposed to your program), use
<P>



<PRE>
        perl -my_opts foo.pl arg1 arg2 arg3

</PRE>


<P>

Alternately, if you use OS/2-ish shell, like <FONT SIZE="-1">CMD</FONT> or 4os2, put
the following at the start of your perl script:
<P>



<PRE>
        extproc perl -S -my_opts

</PRE>


<P>

rename your program to <I>foo.cmd</I>, and start it by typing
<P>



<PRE>
        foo arg1 arg2 arg3

</PRE>


<P>

Note that because of stupid <FONT SIZE="-1">OS/2</FONT> limitations the full path of the perl
script is not available when you use <TT>&quot;extproc&quot;</TT>, thus you are forced to
use <TT>&quot;-S&quot;</TT> perl switch, and your script should be on the <TT>&quot;PATH&quot;</TT>. As a plus
side, if you know a full path to your script, you may still start it
with 
<P>



<PRE>
        perl ../../blah/foo.cmd arg1 arg2 arg3

</PRE>


<P>

(note that the argument <TT>&quot;-my_opts&quot;</TT> is taken care of by the <TT>&quot;extproc&quot;</TT> line
in your script, see &quot;<TT>&quot;extproc&quot;</TT> on the first line&quot;).
<P>

To understand what the above <I>magic</I> does, read perl docs about <TT>&quot;-S&quot;</TT>
switch - see perlrun, and cmdref about <TT>&quot;extproc&quot;</TT>:
<P>



<PRE>
        view perl perlrun
        man perlrun
        view cmdref extproc
        help extproc

</PRE>


<P>

or whatever method you prefer.
<P>

There are also endless possibilities to use <I>executable extensions</I> of
4os2, <I>associations</I> of <FONT SIZE="-1">WPS</FONT> and so on... However, if you use
*nixish shell (like <I>sh.exe</I> supplied in the binary distribution),
you need to follow the syntax specified in ``Switches'' in perlrun.
<P>

Note that <B>-S</B> switch supports scripts with additional extensions 
<I>.cmd</I>, <I>.btm</I>, <I>.bat</I>, <I>.pl</I> as well.
<A NAME="lbAI">&nbsp;</A>
<H2>Starting <FONT SIZE="-1">OS/2</FONT> (and <FONT SIZE="-1">DOS</FONT>) programs under Perl</H2>

<A NAME="ixAAM"></A>
This is what <I>system()</I> (see ``system'' in perlfunc), <TT>``</TT> (see
``I/O Operators'' in perlop), and <I>open pipe</I> (see ``open'' in perlfunc)
are for. (Avoid <I>exec()</I> (see ``exec'' in perlfunc) unless you know what you
do).
<P>

Note however that to use some of these operators you need to have a
sh-syntax shell installed (see ``Pdksh'', 
``Frequently asked questions''), and perl should be able to find it
(see ``<FONT SIZE="-1">PERL_SH_DIR</FONT>'').
<P>

The cases when the shell is used are:
<DL COMPACT>
<DT>1<DD>
<A NAME="ixAAN"></A>
One-argument <I>system()</I> (see ``system'' in perlfunc), <I>exec()</I> (see ``exec'' in perlfunc)
with redirection or shell meta-characters;
<DT>2<DD>
<A NAME="ixAAO"></A>
Pipe-open (see ``open'' in perlfunc) with the command which contains redirection 
or shell meta-characters;
<DT>3<DD>
<A NAME="ixAAP"></A>
Backticks <TT>``</TT> (see ``I/O Operators'' in perlop) with the command which contains
redirection or shell meta-characters;
<DT>4<DD>
<A NAME="ixAAQ"></A>
If the executable called by <I>system()</I>/<I>exec()</I>/pipe-<I>open()</I>/<TT>``</TT> is a script
with the ``magic'' <TT>&quot;#!&quot;</TT> line or <TT>&quot;extproc&quot;</TT> line which specifies shell;
<DT>5<DD>
<A NAME="ixAAR"></A>
If the executable called by <I>system()</I>/<I>exec()</I>/pipe-<I>open()</I>/<TT>``</TT> is a script
without ``magic'' line, and <TT>$ENV{EXECSHELL}</TT> is set to shell;
<DT>6<DD>
<A NAME="ixAAS"></A>
If the executable called by <I>system()</I>/<I>exec()</I>/pipe-<I>open()</I>/<TT>``</TT> is not
found (is not this remark obsolete?);
<DT>7<DD>
<A NAME="ixAAT"></A>
For globbing (see ``glob'' in perlfunc, ``I/O Operators'' in perlop)
(obsolete? Perl uses builtin globbing nowadays...).
</DL>
<P>

For the sake of speed for a common case, in the above algorithms 
backslashes in the command name are not considered as shell metacharacters.
<P>

Perl starts scripts which begin with cookies
<TT>&quot;extproc&quot;</TT> or <TT>&quot;#!&quot;</TT> directly, without an intervention of shell.  Perl uses the
same algorithm to find the executable as <I>pdksh</I>: if the path
on <TT>&quot;#!&quot;</TT> line does not work, and contains <TT>&quot;/&quot;</TT>, then the directory
part of the executable is ignored, and the executable
is searched in <I>.</I> and on <TT>&quot;PATH&quot;</TT>.  To find arguments for these scripts
Perl uses a different algorithm than <I>pdksh</I>: up to 3 arguments are 
recognized, and trailing whitespace is stripped.
<P>

If a script
does not contain such a cooky, then to avoid calling <I>sh.exe</I>, Perl uses
the same algorithm as <I>pdksh</I>: if <TT>$ENV{EXECSHELL}</TT> is set, the
script is given as the first argument to this command, if not set, then
<TT>&quot;$ENV{COMSPEC} /c&quot;</TT> is used (or a hardwired guess if <TT>$ENV{COMSPEC}</TT> is
not set).
<P>

When starting scripts directly, Perl uses exactly the same algorithm as for 
the search of script given by <B>-S</B> command-line option: it will look in
the current directory, then on components of <TT>$ENV{PATH}</TT> using the 
following order of appended extensions: no extension, <I>.cmd</I>, <I>.btm</I>, 
<I>.bat</I>, <I>.pl</I>.
<P>

Note that Perl will start to look for scripts only if <FONT SIZE="-1">OS/2</FONT> cannot start the
specified application, thus <TT>&quot;system 'blah'&quot;</TT> will not look for a script if 
there is an executable file <I>blah.exe</I> <I>anywhere</I> on <TT>&quot;PATH&quot;</TT>.  In
other words, <TT>&quot;PATH&quot;</TT> is essentially searched twice: once by the <FONT SIZE="-1">OS</FONT> for
an executable, then by Perl for scripts.
<P>

Note also that executable files on <FONT SIZE="-1">OS/2</FONT> can have an arbitrary extension, 
but <I>.exe</I> will be automatically appended if no dot is present in the name.  
The workaround is as simple as that:  since <I>blah.</I> and <I>blah</I> denote the 
same file (at list on <FONT SIZE="-1">FAT</FONT> and <FONT SIZE="-1">HPFS</FONT> file systems), to start an executable residing in file <I>n:/bin/blah</I> (no 
extension) give an argument <TT>&quot;n:/bin/blah.&quot;</TT> (dot appended) to <I>system()</I>.
<P>

Perl will start <FONT SIZE="-1">PM</FONT> programs from <FONT SIZE="-1">VIO</FONT> (=text-mode) Perl process in a
separate <FONT SIZE="-1">PM</FONT> session;
the opposite is not true: when you start a non-PM program from a <FONT SIZE="-1">PM</FONT>
Perl process, Perl would not run it in a separate session.  If a separate
session is desired, either ensure
that shell will be used, as in <TT>&quot;system 'cmd /c myprog'&quot;</TT>, or start it using
optional arguments to <I>system()</I> documented in <TT>&quot;OS2::Process&quot;</TT> module.  This
is considered to be a feature.
<A NAME="lbAJ">&nbsp;</A>
<H2>Frequently asked questions</H2>

<A NAME="ixAAU"></A>
<A NAME="lbAK">&nbsp;</A>
<H2>
does not work</H2>



<A NAME="ixAAV"></A>
Perl binary distributions come with a <I>testperl.cmd</I> script which tries
to detect common problems with misconfigured installations.  There is a
pretty large chance it will discover which step of the installation you
managed to goof.  <TT>&quot;;-)&quot;</TT>
<A NAME="lbAL">&nbsp;</A>
<H2>I cannot run external programs</H2>

<A NAME="ixAAW"></A>
<DL COMPACT>
<DT>*<DD>
Did you run your programs with <TT>&quot;-w&quot;</TT> switch? See 
``2 (and <FONT SIZE="-1">DOS</FONT>) programs under Perl'' in Starting <FONT SIZE="-1">OS</FONT>.
<DT>*<DD>
Do you try to run <I>internal</I> shell commands, like <TT>`copy a b`</TT>
(internal for <I>cmd.exe</I>), or <TT>`glob a*b`</TT> (internal for ksh)? You
need to specify your shell explicitly, like <TT>`cmd /c copy a b`</TT>,
since Perl cannot deduce which commands are internal to your shell.
</DL>
<A NAME="lbAM">&nbsp;</A>
<H2>I cannot embed perl into my program, or use <I>perl.dll</I> from my program.</H2>

<A NAME="ixAAX"></A>
<DL COMPACT>
<DT>Is your program EMX-compiled with -Zmt -Zcrtdll?<DD>


<A NAME="ixAAY"></A>
Well, nowadays Perl <FONT SIZE="-1">DLL</FONT> should be usable from a differently compiled
program too...  If you can run Perl code from <FONT SIZE="-1">REXX</FONT> scripts (see
<FONT SIZE="-1">OS2::REXX</FONT>), then there are some other aspect of interaction which
are overlooked by the current hackish code to support
differently-compiled principal programs.


<P>


If everything else fails, you need to build a stand-alone <FONT SIZE="-1">DLL</FONT> for
perl. Contact me, I did it once. Sockets would not work, as a lot of
other stuff.
<DT>Did you use ExtUtils::Embed?<DD>
<A NAME="ixAAZ"></A>
Some time ago I had reports it does not work.  Nowadays it is checked
in the Perl test suite, so grep <I>./t</I> subdirectory of the build tree
(as well as <I>*.t</I> files in the <I>./lib</I> subdirectory) to find how it
should be done ``correctly''.
</DL>
<A NAME="lbAN">&nbsp;</A>
<H2>``</TT> and pipe-<TT>open do not work under </TT><FONT SIZE="-1"><TT>DOS</TT></FONT><TT>.</H2>



<A NAME="ixABA"></A>
This may a variant of just ``I cannot run external programs'', or a
deeper problem. Basically: you </TT><I>need</I> <FONT SIZE="-1">RSX</FONT> (see ``Prerequisites'')
for these commands to work, and you may need a port of <I>sh.exe</I> which
understands command arguments. One of such ports is listed in
``Prerequisites'' under <FONT SIZE="-1">RSX</FONT>. Do not forget to set variable
<TT>&quot;``</TT><FONT SIZE="-1"><TT>PERL_SH_DIR</TT></FONT><TT>''&quot;</TT> as well.
<P>

<FONT SIZE="-1">DPMI</FONT> is required for <FONT SIZE="-1">RSX</FONT>.
<A NAME="lbAO">&nbsp;</A>
<H2>Cannot start find.exe pattern file</H2>



<A NAME="ixABB"></A>
The whole idea of the ``standard C <FONT SIZE="-1">API</FONT> to start applications'' is that
the forms <TT>&quot;foo&quot;</TT> and <TT>&quot;foo&quot;</TT> of program arguments are completely
interchangable.  <I>find</I> breaks this paradigm;
<P>



<PRE>
  find &quot;pattern&quot; file
  find pattern file

</PRE>


<P>

are not equivalent; <I>find</I> cannot be started directly using the above
<FONT SIZE="-1">API</FONT>.  One needs a way to surround the doublequotes in some other
quoting construction, necessarily having an extra non-Unixish shell in
between.
<P>

Use one of
<P>



<PRE>
  system 'cmd', '/c', 'find &quot;pattern&quot; file';
  `cmd /c 'find &quot;pattern&quot; file'`

</PRE>


<P>

This would start <I>find.exe</I> via <I>cmd.exe</I> via <TT>&quot;sh.exe&quot;</TT> via
<TT>&quot;perl.exe&quot;</TT>, but this is a price to pay if you want to use
non-conforming program.
<A NAME="lbAP">&nbsp;</A>
<H2>INSTALLATION</H2>

<A NAME="ixABC"></A>
<A NAME="lbAQ">&nbsp;</A>
<H2>Automatic binary installation</H2>

<A NAME="ixABD"></A>
The most convenient way of installing a binary distribution of perl is via perl installer
<I>install.exe</I>. Just follow the instructions, and 99% of the
installation blues would go away. 
<P>

Note however, that you need to have <I>unzip.exe</I> on your path, and
<FONT SIZE="-1">EMX</FONT> environment <I>running</I>. The latter means that if you just
installed <FONT SIZE="-1">EMX</FONT>, and made all the needed changes to <I>Config.sys</I>,
you may need to reboot in between. Check <FONT SIZE="-1">EMX</FONT> runtime by running
<P>



<PRE>
        emxrev

</PRE>


<P>

Binary installer also creates a folder on your desktop with some useful
objects.  If you need to change some aspects of the work of the binary
installer, feel free to edit the file <I>Perl.pkg</I>.  This may be useful
e.g., if you need to run the installer many times and do not want to
make many interactive changes in the <FONT SIZE="-1">GUI</FONT>.
<P>

<B>Things not taken care of by automatic binary installation:</B>
<DL COMPACT>
<DT>PERL_BADLANG<DD>


<A NAME="ixABE"></A>
may be needed if you change your codepage <I>after</I> perl installation,
and the new value is not supported by <FONT SIZE="-1">EMX</FONT>. See ``<FONT SIZE="-1">PERL_BADLANG</FONT>''.
<DT>PERL_BADFREE<DD>


<A NAME="ixABF"></A>
see ``<FONT SIZE="-1">PERL_BADFREE</FONT>''.
<DT><I>Config.pm</I><DD>
<A NAME="ixABG"></A>
This file resides somewhere deep in the location you installed your
perl library, find it out by 


<P>




<PRE>
  perl -MConfig -le &quot;print $INC{'Config.pm'}&quot;

</PRE>




<P>


While most important values in this file <I>are</I> updated by the binary
installer, some of them may need to be hand-edited. I know no such
data, please keep me informed if you find one.  Moreover, manual
changes to the installed version may need to be accompanied by an edit
of this file.
</DL>
<P>

<B></B><FONT SIZE="-1"><B>NOTE</B></FONT><B></B>. Because of a typo the binary installer of 5.00305
would install a variable <TT>&quot;PERL_SHPATH&quot;</TT> into <I>Config.sys</I>. Please
remove this variable and put <TT>&quot;</TT><FONT SIZE="-1"><TT>PERL_SH_DIR</TT></FONT><TT>&quot;</TT> instead.
<A NAME="lbAR">&nbsp;</A>
<H2>Manual binary installation</H2>

<A NAME="ixABH"></A>
As of version 5.00305, <FONT SIZE="-1">OS/2</FONT> perl binary distribution comes split
into 11 components. Unfortunately, to enable configurable binary
installation, the file paths in the zip files are not absolute, but
relative to some directory.
<P>

Note that the extraction with the stored paths is still necessary
(default with unzip, specify <TT>&quot;-d&quot;</TT> to pkunzip). However, you
need to know where to extract the files. You need also to manually
change entries in <I>Config.sys</I> to reflect where did you put the
files. Note that if you have some primitive unzipper (like
<TT>&quot;pkunzip&quot;</TT>), you may get a lot of warnings/errors during
unzipping. Upgrade to <TT>&quot;(w)unzip&quot;</TT>.
<P>

Below is the sample of what to do to reproduce the configuration on my
machine.  In <I></I><FONT SIZE="-1"><I>VIEW</I></FONT><I>.EXE</I> you can press <TT>&quot;Ctrl-Insert&quot;</TT> now, and
cut-and-paste from the resulting file - created in the directory you
started <I></I><FONT SIZE="-1"><I>VIEW</I></FONT><I>.EXE</I> from.
<P>

For each component, we mention environment variables related to each
installation directory.  Either choose directories to match your
values of the variables, or create/append-to variables to take into
account the directories.
<DL COMPACT>
<DT>Perl <FONT SIZE="-1">VIO</FONT> and <FONT SIZE="-1">PM</FONT> executables (dynamically linked)<DD>
<A NAME="ixABI"></A>


<PRE>
  unzip perl_exc.zip *.exe *.ico -d f:/emx.add/bin
  unzip perl_exc.zip *.dll -d f:/emx.add/dll

</PRE>




<P>


(have the directories with <TT>&quot;*.exe&quot;</TT> on <FONT SIZE="-1">PATH</FONT>, and <TT>&quot;*.dll&quot;</TT> on
<FONT SIZE="-1">LIBPATH</FONT>);
<DT>Perl_ <FONT SIZE="-1">VIO</FONT> executable (statically linked)<DD>
<A NAME="ixABJ"></A>


<PRE>
  unzip perl_aou.zip -d f:/emx.add/bin

</PRE>




<P>


(have the directory on <FONT SIZE="-1">PATH</FONT>);
<DT>Executables for Perl utilities<DD>
<A NAME="ixABK"></A>


<PRE>
  unzip perl_utl.zip -d f:/emx.add/bin

</PRE>




<P>


(have the directory on <FONT SIZE="-1">PATH</FONT>);
<DT>Main Perl library<DD>
<A NAME="ixABL"></A>


<PRE>
  unzip perl_mlb.zip -d f:/perllib/lib

</PRE>




<P>


If this directory is exactly the same as the prefix which was compiled
into <I>perl.exe</I>, you do not need to change
anything. However, for perl to find the library if you use a different
path, you need to
<TT>&quot;set PERLLIB_PREFIX&quot;</TT> in <I>Config.sys</I>, see ``<FONT SIZE="-1">PERLLIB_PREFIX</FONT>''.
<DT>Additional Perl modules<DD>
<A NAME="ixABM"></A>


<PRE>
  unzip perl_ste.zip -d f:/perllib/lib/site_perl/5.8.5/

</PRE>




<P>


Same remark as above applies.  Additionally, if this directory is not
one of directories on <TT>@INC</TT> (and <TT>@INC</TT> is influenced by <TT>&quot;PERLLIB_PREFIX&quot;</TT>), you
need to put this
directory and subdirectory <I>./os2</I> in <TT>&quot;PERLLIB&quot;</TT> or <TT>&quot;PERL5LIB&quot;</TT>
variable. Do not use <TT>&quot;PERL5LIB&quot;</TT> unless you have it set already. See
``<FONT SIZE="-1">ENVIRONMENT</FONT>'' in perl.


<P>


<B>[Check whether this extraction directory is still applicable with
the new directory structure layout!]</B>
<DT>Tools to compile Perl modules<DD>
<A NAME="ixABN"></A>


<PRE>
  unzip perl_blb.zip -d f:/perllib/lib

</PRE>




<P>


Same remark as for <I>perl_ste.zip</I>.
<DT>Manpages for Perl and utilities<DD>
<A NAME="ixABO"></A>


<PRE>
  unzip perl_man.zip -d f:/perllib/man

</PRE>




<P>


This directory should better be on <TT>&quot;MANPATH&quot;</TT>. You need to have a
working <I>man</I> to access these files.
<DT>Manpages for Perl modules<DD>
<A NAME="ixABP"></A>


<PRE>
  unzip perl_mam.zip -d f:/perllib/man

</PRE>




<P>


This directory should better be on <TT>&quot;MANPATH&quot;</TT>. You need to have a
working man to access these files.
<DT>Source for Perl documentation<DD>
<A NAME="ixABQ"></A>


<PRE>
  unzip perl_pod.zip -d f:/perllib/lib

</PRE>




<P>


This is used by the <TT>&quot;perldoc&quot;</TT> program (see perldoc), and may be used to
generate <FONT SIZE="-1">HTML</FONT> documentation usable by <FONT SIZE="-1">WWW</FONT> browsers, and
documentation in zillions of other formats: <TT>&quot;info&quot;</TT>, <TT>&quot;LaTeX&quot;</TT>,
<TT>&quot;Acrobat&quot;</TT>, <TT>&quot;FrameMaker&quot;</TT> and so on.  [Use programs such as
<I>pod2latex</I> etc.]
<DT>Perl manual in <I>.INF</I> format<DD>
<A NAME="ixABR"></A>


<PRE>
  unzip perl_inf.zip -d d:/os2/book

</PRE>




<P>


This directory should better be on <TT>&quot;BOOKSHELF&quot;</TT>.
<DT>Pdksh<DD>
<A NAME="ixABS"></A>


<PRE>
  unzip perl_sh.zip -d f:/bin

</PRE>




<P>


This is used by perl to run external commands which explicitly
require shell, like the commands using <I>redirection</I> and <I>shell
metacharacters</I>. It is also used instead of explicit <I>/bin/sh</I>.


<P>


Set <TT>&quot;PERL_SH_DIR&quot;</TT> (see ``<FONT SIZE="-1">PERL_SH_DIR</FONT>'') if you move <I>sh.exe</I> from
the above location.


<P>


<B>Note.</B> It may be possible to use some other sh-compatible shell (untested).
</DL>
<P>

After you installed the components you needed and updated the
<I>Config.sys</I> correspondingly, you need to hand-edit
<I>Config.pm</I>. This file resides somewhere deep in the location you
installed your perl library, find it out by
<P>



<PRE>
  perl -MConfig -le &quot;print $INC{'Config.pm'}&quot;

</PRE>


<P>

You need to correct all the entries which look like file paths (they
currently start with <TT>&quot;f:/&quot;</TT>).
<A NAME="lbAS">&nbsp;</A>
<H2><B>Warning</B></H2>

<A NAME="ixABT"></A>
The automatic and manual perl installation leave precompiled paths
inside perl executables. While these paths are overwriteable (see
``<FONT SIZE="-1">PERLLIB_PREFIX</FONT>'', ``<FONT SIZE="-1">PERL_SH_DIR</FONT>''), some people may prefer
binary editing of paths inside the executables/DLLs.
<A NAME="lbAT">&nbsp;</A>
<H2>Accessing documentation</H2>

<A NAME="ixABU"></A>
Depending on how you built/installed perl you may have (otherwise
identical) Perl documentation in the following formats:
<A NAME="lbAU">&nbsp;</A>
<H2><FONT SIZE="-1">OS/2</FONT> <I>.INF</I> file</H2>

<A NAME="ixABV"></A>
Most probably the most convenient form. Under <FONT SIZE="-1">OS/2</FONT> view it as
<P>



<PRE>
  view perl
  view perl perlfunc
  view perl less
  view perl ExtUtils::MakeMaker

</PRE>


<P>

(currently the last two may hit a wrong location, but this may improve
soon). Under Win* see ``<FONT SIZE="-1">SYNOPSIS</FONT>''.
<P>

If you want to build the docs yourself, and have <I></I><FONT SIZE="-1"><I>OS/2</I></FONT><I> toolkit</I>, run
<P>



<PRE>
        pod2ipf &gt; perl.ipf

</PRE>


<P>

in <I>/perllib/lib/pod</I> directory, then
<P>



<PRE>
        ipfc /inf perl.ipf

</PRE>


<P>

(Expect a lot of errors during the both steps.) Now move it on your
<FONT SIZE="-1">BOOKSHELF</FONT> path.
<A NAME="lbAV">&nbsp;</A>
<H2>Plain text</H2>

<A NAME="ixABW"></A>
If you have perl documentation in the source form, perl utilities
installed, and <FONT SIZE="-1">GNU</FONT> groff installed, you may use 
<P>



<PRE>
        perldoc perlfunc
        perldoc less
        perldoc ExtUtils::MakeMaker

</PRE>


<P>

to access the perl documentation in the text form (note that you may get
better results using perl manpages).
<P>

Alternately, try running pod2text on <I>.pod</I> files.
<A NAME="lbAW">&nbsp;</A>
<H2>Manpages</H2>

<A NAME="ixABX"></A>
If you have <I>man</I> installed on your system, and you installed perl
manpages, use something like this:
<P>



<PRE>
        man perlfunc
        man 3 less
        man ExtUtils.MakeMaker

</PRE>


<P>

to access documentation for different components of Perl. Start with
<P>



<PRE>
        man perl

</PRE>


<P>

Note that dot (<I>.</I>) is used as a package separator for documentation
for packages, and as usual, sometimes you need to give the section - <TT>3</TT>
above - to avoid shadowing by the <I><A HREF="../man1/less.1.php">less</A>(1) manpage</I>.
<P>

Make sure that the directory <B>above</B> the directory with manpages is
on our <TT>&quot;MANPATH&quot;</TT>, like this
<P>



<PRE>
  set MANPATH=c:/man;f:/perllib/man

</PRE>


<P>

for Perl manpages in <TT>&quot;f:/perllib/man/man1/&quot;</TT> etc.
<A NAME="lbAX">&nbsp;</A>
<H2><FONT SIZE="-1">HTML</FONT></H2>

<A NAME="ixABY"></A>
If you have some <FONT SIZE="-1">WWW</FONT> browser available, installed the Perl
documentation in the source form, and Perl utilities, you can build
<FONT SIZE="-1">HTML</FONT> docs. Cd to directory with <I>.pod</I> files, and do like this
<P>



<PRE>
        cd f:/perllib/lib/pod
        pod2html

</PRE>


<P>

After this you can direct your browser the file <I>perl.html</I> in this
directory, and go ahead with reading docs, like this:
<P>



<PRE>
        explore <A HREF="file:///f:/perllib/lib/pod/perl.php">file:///f:/perllib/lib/pod/perl.html</A>

</PRE>


<P>

Alternatively you may be able to get these docs prebuilt from <FONT SIZE="-1">CPAN</FONT>.
<A NAME="lbAY">&nbsp;</A>
<H2><FONT SIZE="-1">GNU</FONT> info files</H2>



<A NAME="ixABZ"></A>
Users of Emacs would appreciate it very much, especially with
<TT>&quot;CPerl&quot;</TT> mode loaded. You need to get latest <TT>&quot;pod2texi&quot;</TT> from <TT>&quot;CPAN&quot;</TT>,
or, alternately, the prebuilt info pages.
<A NAME="lbAZ">&nbsp;</A>
<H2><I></I><FONT SIZE="-1"><I>PDF</I></FONT><I></I> files</H2>

<A NAME="ixACA"></A>
for <TT>&quot;Acrobat&quot;</TT> are available on <FONT SIZE="-1">CPAN</FONT> (may be for slightly older version of
perl).
<A NAME="lbBA">&nbsp;</A>
<H2>LaTeX docs</H2>



<A NAME="ixACB"></A>
can be constructed using <TT>&quot;pod2latex&quot;</TT>.
<A NAME="lbBB">&nbsp;</A>
<H2>BUILD</H2>

<A NAME="ixACC"></A>
Here we discuss how to build Perl under <FONT SIZE="-1">OS/2</FONT>. There is an alternative
(but maybe older) view on &lt;<A HREF="http://www.shadow.net/~troc/os2perl.php">http://www.shadow.net/~troc/os2perl.html</A>&gt;.
<A NAME="lbBC">&nbsp;</A>
<H2>The short story</H2>

<A NAME="ixACD"></A>
Assume that you are a seasoned porter, so are sure that all the necessary
tools are already present on your system, and you know how to get the Perl
source distribution.  Untar it, change to the extract directory, and
<P>



<PRE>
  gnupatch -p0 &lt; os2\diff.configure
  sh Configure -des -D prefix=f:/perllib
  make
  make test
  make install
  make aout_test
  make aout_install

</PRE>


<P>

This puts the executables in f:/perllib/bin.  Manually move them to the
<TT>&quot;PATH&quot;</TT>, manually move the built <I>perl*.dll</I> to <TT>&quot;LIBPATH&quot;</TT> (here for
Perl <FONT SIZE="-1">DLL</FONT> <I>*</I> is a not-very-meaningful hex checksum), and run
<P>



<PRE>
  make installcmd INSTALLCMDDIR=d:/ir/on/path

</PRE>


<P>

Assuming that the <TT>&quot;man&quot;</TT>-files were put on an appropriate location,
this completes the installation of minimal Perl system.  (The binary
distribution contains also a lot of additional modules, and the
documentation in <FONT SIZE="-1">INF</FONT> format.)
<P>

What follows is a detailed guide through these steps.
<A NAME="lbBD">&nbsp;</A>
<H2>Prerequisites</H2>

<A NAME="ixACE"></A>
You need to have the latest <FONT SIZE="-1">EMX</FONT> development environment, the full
<FONT SIZE="-1">GNU</FONT> tool suite (gawk renamed to awk, and <FONT SIZE="-1">GNU</FONT> <I>find.exe</I>
earlier on path than the <FONT SIZE="-1">OS/2</FONT> <I>find.exe</I>, same with <I>sort.exe</I>, to
check use
<P>



<PRE>
  find --version
  sort --version

</PRE>


<P>

). You need the latest version of <I>pdksh</I> installed as <I>sh.exe</I>.
<P>

Check that you have <B></B><FONT SIZE="-1"><B>BSD</B></FONT><B></B> libraries and headers installed, and - 
optionally - Berkeley <FONT SIZE="-1">DB</FONT> headers and libraries, and crypt.
<P>

Possible locations to get the files:
<P>



<PRE>
  <A HREF="ftp://hobbes.nmsu.edu/os2/unix/">ftp://hobbes.nmsu.edu/os2/unix/</A>
  <A HREF="ftp://ftp.cdrom.com/pub/os2/unix/">ftp://ftp.cdrom.com/pub/os2/unix/</A>
  <A HREF="ftp://ftp.cdrom.com/pub/os2/dev32/">ftp://ftp.cdrom.com/pub/os2/dev32/</A>
  <A HREF="ftp://ftp.cdrom.com/pub/os2/emx09c/">ftp://ftp.cdrom.com/pub/os2/emx09c/</A>

</PRE>


<P>

It is reported that the following archives contain enough utils to
build perl: <I>gnufutil.zip</I>, <I>gnusutil.zip</I>, <I>gnututil.zip</I>, <I>gnused.zip</I>,
<I>gnupatch.zip</I>, <I>gnuawk.zip</I>, <I>gnumake.zip</I>, <I>gnugrep.zip</I>, <I>bsddev.zip</I> and
<I>ksh527rt.zip</I> (or a later version).  Note that all these utilities are
known to be available from <FONT SIZE="-1">LEO:</FONT>
<P>



<PRE>
  <A HREF="ftp://ftp.leo.org/pub/comp/os/os2/leo/gnu">ftp://ftp.leo.org/pub/comp/os/os2/leo/gnu</A>

</PRE>


<P>

Note also that the <I>db.lib</I> and <I>db.a</I> from the <FONT SIZE="-1">EMX</FONT> distribution
are not suitable for multi-threaded compile (even single-threaded
flavor of Perl uses multi-threaded C <FONT SIZE="-1">RTL</FONT>, for
compatibility with XFree86-OS/2). Get a corrected one from
<P>



<PRE>
  <A HREF="http://www.ilyaz.org/software/os2/db_mt.zip">http://www.ilyaz.org/software/os2/db_mt.zip</A>

</PRE>


<P>

If you have <I>exactly the same version of Perl</I> installed already,
make sure that no copies or perl are currently running.  Later steps
of the build may fail since an older version of <I>perl.dll</I> loaded into
memory may be found.  Running <TT>&quot;make test&quot;</TT> becomes meaningless, since
the test are checking a previous build of perl (this situation is detected
and reported by <I>lib/os2_base.t</I> test).  Do not forget to unset
<TT>&quot;PERL_EMXLOAD_SEC&quot;</TT> in environment.
<P>

Also make sure that you have <I>/tmp</I> directory on the current drive,
and <I>.</I> directory in your <TT>&quot;LIBPATH&quot;</TT>. One may try to correct the
latter condition by
<P>



<PRE>
  set BEGINLIBPATH .\.

</PRE>


<P>

if you use something like <I></I><FONT SIZE="-1"><I>CMD</I></FONT><I>.EXE</I> or latest versions of
<I>4os2.exe</I>.  (Setting <FONT SIZE="-1">BEGINLIBPATH</FONT> to just <TT>&quot;.&quot;</TT> is ignored by the
<FONT SIZE="-1">OS/2</FONT> kernel.)
<P>

Make sure your gcc is good for <TT>&quot;-Zomf&quot;</TT> linking: run <TT>&quot;omflibs&quot;</TT>
script in <I>/emx/lib</I> directory.
<P>

Check that you have link386 installed. It comes standard with <FONT SIZE="-1">OS/2</FONT>,
but may be not installed due to customization. If typing
<P>



<PRE>
  link386

</PRE>


<P>

shows you do not have it, do <I>Selective install</I>, and choose <TT>&quot;Link
object modules&quot;</TT> in <I>Optional system utilities/More</I>. If you get into
link386 prompts, press <TT>&quot;Ctrl-C&quot;</TT> to exit.
<A NAME="lbBE">&nbsp;</A>
<H2>Getting perl source</H2>

<A NAME="ixACF"></A>
You need to fetch the latest perl source (including developers
releases). With some probability it is located in 
<P>



<PRE>
  <A HREF="http://www.cpan.org/src/5.0">http://www.cpan.org/src/5.0</A>
  <A HREF="http://www.cpan.org/src/5.0/unsupported">http://www.cpan.org/src/5.0/unsupported</A>

</PRE>


<P>

If not, you may need to dig in the indices to find it in the directory
of the current maintainer.
<P>

Quick cycle of developers release may break the <FONT SIZE="-1">OS/2</FONT> build time to
time, looking into 
<P>



<PRE>
  <A HREF="http://www.cpan.org/ports/os2/">http://www.cpan.org/ports/os2/</A>

</PRE>


<P>

may indicate the latest release which was publicly released by the
maintainer. Note that the release may include some additional patches
to apply to the current source of perl.
<P>

Extract it like this
<P>



<PRE>
  tar vzxf perl5.00409.tar.gz

</PRE>


<P>

You may see a message about errors while extracting <I>Configure</I>. This is
because there is a conflict with a similarly-named file <I>configure</I>.
<P>

Change to the directory of extraction.
<A NAME="lbBF">&nbsp;</A>
<H2>Application of the patches</H2>

<A NAME="ixACG"></A>
You need to apply the patches in <I>./os2/diff.*</I> like this:
<P>



<PRE>
  gnupatch -p0 &lt; os2\diff.configure

</PRE>


<P>

You may also need to apply the patches supplied with the binary
distribution of perl.  It also makes sense to look on the
perl5-porters mailing list for the latest OS/2-related patches (see
&lt;<A HREF="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/</A>&gt;).  Such
patches usually contain strings <TT>&quot;/os2/&quot;</TT> and <TT>&quot;patch&quot;</TT>, so it makes
sense looking for these strings.
<A NAME="lbBG">&nbsp;</A>
<H2>Hand-editing</H2>

<A NAME="ixACH"></A>
You may look into the file <I>./hints/os2.sh</I> and correct anything
wrong you find there. I do not expect it is needed anywhere.
<A NAME="lbBH">&nbsp;</A>
<H2>Making</H2>

<A NAME="ixACI"></A>


<PRE>
  sh Configure -des -D prefix=f:/perllib

</PRE>


<P>

<TT>&quot;prefix&quot;</TT> means: where to install the resulting perl library. Giving
correct prefix you may avoid the need to specify <TT>&quot;PERLLIB_PREFIX&quot;</TT>,
see ``<FONT SIZE="-1">PERLLIB_PREFIX</FONT>''.
<P>

<I>Ignore the message about missing </I>&quot;ln&quot;<I>, and about </I>&quot;-c&quot;<I> option to
tr</I>. The latter is most probably already fixed, if you see it and can trace
where the latter spurious warning comes from, please inform me.
<P>

Now
<P>



<PRE>
  make

</PRE>


<P>

At some moment the built may die, reporting a <I>version mismatch</I> or
<I>unable to run perl</I>.  This means that you do not have <I>.</I> in
your <FONT SIZE="-1">LIBPATH</FONT>, so <I>perl.exe</I> cannot find the needed <I>perl67B2.dll</I> (treat
these hex digits as line noise).  After this is fixed the build
should finish without a lot of fuss.
<A NAME="lbBI">&nbsp;</A>
<H2>Testing</H2>

<A NAME="ixACJ"></A>
Now run
<P>



<PRE>
  make test

</PRE>


<P>

All tests should succeed (with some of them skipped).  If you have the
same version of Perl installed, it is crucial that you have <TT>&quot;.&quot;</TT> early
in your <FONT SIZE="-1">LIBPATH</FONT> (or in <FONT SIZE="-1">BEGINLIBPATH</FONT>), otherwise your tests will most
probably test the wrong version of Perl.
<P>

Some tests may generate extra messages similar to
<DL COMPACT>
<DT>A lot of bad free<DD>


<A NAME="ixACK"></A>
in database tests related to Berkeley <FONT SIZE="-1">DB</FONT>. <I>This should be fixed already.</I>
If it persists, you may disable this warnings, see ``<FONT SIZE="-1">PERL_BADFREE</FONT>''.
<DT>Process terminated by <FONT SIZE="-1">SIGTERM/SIGINT</FONT><DD>
<A NAME="ixACL"></A>
This is a standard message issued by <FONT SIZE="-1">OS/2</FONT> applications. *nix
applications die in silence. It is considered to be a feature. One can
easily disable this by appropriate sighandlers. 


<P>


However the test engine bleeds these message to screen in unexpected
moments. Two messages of this kind <I>should</I> be present during
testing.
</DL>
<P>

To get finer test reports, call
<P>



<PRE>
  perl t/harness

</PRE>


<P>

The report with <I>io/pipe.t</I> failing may look like this:
<P>



<PRE>
  Failed Test  Status Wstat Total Fail  Failed  List of failed
  ------------------------------------------------------------
  io/pipe.t                    12    1   8.33%  9
  7 tests skipped, plus 56 subtests skipped.
  Failed 1/195 test scripts, 99.49% okay. 1/6542 subtests failed, 99.98% okay.

</PRE>


<P>

The reasons for most important skipped tests are:
<DL COMPACT>
<DT><I>op/fs.t</I><DD>
<A NAME="ixACM"></A>
<DL COMPACT><DT><DD>

<DL COMPACT>
<DT>18<DD>
<A NAME="ixACN"></A>

Checks <TT>&quot;atime&quot;</TT> and <TT>&quot;mtime&quot;</TT> of <TT>&quot;stat()&quot;</TT> - unfortunately, <FONT SIZE="-1">HPFS</FONT>
provides only 2sec time granularity (for compatibility with <FONT SIZE="-1">FAT</FONT>?).
<DT>25<DD>
<A NAME="ixACO"></A>
Checks <TT>&quot;truncate()&quot;</TT> on a filehandle just opened for write - I do not
know why this should or should not work.
</DL>
</DL>

<DL COMPACT><DT><DD>
</DL>

<DT><I>op/stat.t</I><DD>
<A NAME="ixACP"></A>
Checks <TT>&quot;stat()&quot;</TT>. Tests:
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>4<DD>
<A NAME="ixACQ"></A>
Checks <TT>&quot;atime&quot;</TT> and <TT>&quot;mtime&quot;</TT> of <TT>&quot;stat()&quot;</TT> - unfortunately, <FONT SIZE="-1">HPFS</FONT>
provides only 2sec time granularity (for compatibility with <FONT SIZE="-1">FAT</FONT>?).
</DL>
</DL>

<DL COMPACT><DT><DD>
</DL>

</DL>
<A NAME="lbBJ">&nbsp;</A>
<H2>Installing the built perl</H2>

<A NAME="ixACR"></A>
If you haven't yet moved <TT>&quot;perl*.dll&quot;</TT> onto <FONT SIZE="-1">LIBPATH</FONT>, do it now.
<P>

Run
<P>



<PRE>
  make install

</PRE>


<P>

It would put the generated files into needed locations. Manually put
<I>perl.exe</I>, <I>perl__.exe</I> and <I>perl___.exe</I> to a location on your
<FONT SIZE="-1">PATH</FONT>, <I>perl.dll</I> to a location on your <FONT SIZE="-1">LIBPATH</FONT>.
<P>

Run
<P>



<PRE>
  make installcmd INSTALLCMDDIR=d:/ir/on/path

</PRE>


<P>

to convert perl utilities to <I>.cmd</I> files and put them on
<FONT SIZE="-1">PATH</FONT>. You need to put <I>.EXE</I>-utilities on path manually. They are
installed in <TT>&quot;$prefix/bin&quot;</TT>, here <TT>$prefix</TT> is what you gave to
<I>Configure</I>, see Making.
<P>

If you use <TT>&quot;man&quot;</TT>, either move the installed <I>*/man/</I> directories to
your <TT>&quot;MANPATH&quot;</TT>, or modify <TT>&quot;MANPATH&quot;</TT> to match the location.  (One
could have avoided this by providing a correct <TT>&quot;manpath&quot;</TT> option to
<I>./Configure</I>, or editing <I>./config.sh</I> between configuring and
making steps.)
<A NAME="lbBK">&nbsp;</A>
<H2>a.out-style build</H2>



<A NAME="ixACS"></A>
Proceed as above, but make <I>perl_.exe</I> (see ``perl_.exe'') by
<P>



<PRE>
  make perl_

</PRE>


<P>

test and install by
<P>



<PRE>
  make aout_test
  make aout_install

</PRE>


<P>

Manually put <I>perl_.exe</I> to a location on your <FONT SIZE="-1">PATH</FONT>.
<P>

<B>Note.</B> The build process for <TT>&quot;perl_&quot;</TT> <I>does not know</I> about all the
dependencies, so you should make sure that anything is up-to-date,
say, by doing
<P>



<PRE>
  make perl_dll

</PRE>


<P>

first.
<A NAME="lbBL">&nbsp;</A>
<H2>Building a binary distribution</H2>

<A NAME="ixACT"></A>
[This section provides a short overview only...]
<P>

Building should proceed differently depending on whether the version of perl
you install is already present and used on your system, or is a new version
not yet used.  The description below assumes that the version is new, so
installing its DLLs and <I>.pm</I> files will not disrupt the operation of your
system even if some intermediate steps are not yet fully working.
<P>

The other cases require a little bit more convoluted procedures.  Below I
suppose that the current version of Perl is <TT>5.8.2</TT>, so the executables are
named accordingly.
<DL COMPACT>
<DT>1.<DD>
Fully build and test the Perl distribution.  Make sure that no tests are
failing with <TT>&quot;test&quot;</TT> and <TT>&quot;aout_test&quot;</TT> targets; fix the bugs in Perl and
the Perl test suite detected by these tests.  Make sure that <TT>&quot;all_test&quot;</TT>
make target runs as clean as possible.  Check that <TT>&quot;os2/perlrexx.cmd&quot;</TT>
runs fine.
<DT>2.<DD>
Fully install Perl, including <TT>&quot;installcmd&quot;</TT> target.  Copy the generated DLLs
to <TT>&quot;LIBPATH&quot;</TT>; copy the numbered Perl executables (as in <I>perl5.8.2.exe</I>)
to <TT>&quot;PATH&quot;</TT>; copy <TT>&quot;perl_.exe&quot;</TT> to <TT>&quot;PATH&quot;</TT> as <TT>&quot;perl_5.8.2.exe&quot;</TT>.  Think whether
you need backward-compatibility DLLs.  In most cases you do not need to install
them yet; but sometime this may simplify the following steps.
<DT>3.<DD>
Make sure that <TT>&quot;CPAN.pm&quot;</TT> can download files from <FONT SIZE="-1">CPAN</FONT>.  If not, you may need
to manually install <TT>&quot;Net::FTP&quot;</TT>.
<DT>4.<DD>
Install the bundle <TT>&quot;Bundle::OS2_default&quot;</TT>


<P>




<PRE>
  perl5.8.2 -MCPAN -e &quot;install Bundle::OS2_default&quot; &lt; nul |&amp; tee 00cpan_i_1

</PRE>




<P>


This may take a couple of hours on 1GHz processor (when run the first time).
And this should not be necessarily a smooth procedure.  Some modules may not
specify required dependencies, so one may need to repeat this procedure several
times until the results stabilize.


<P>




<PRE>
  perl5.8.2 -MCPAN -e &quot;install Bundle::OS2_default&quot; &lt; nul |&amp; tee 00cpan_i_2
  perl5.8.2 -MCPAN -e &quot;install Bundle::OS2_default&quot; &lt; nul |&amp; tee 00cpan_i_3

</PRE>




<P>


Even after they stabilize, some tests may fail.


<P>


Fix as many discovered bugs as possible.  Document all the bugs which are not
fixed, and all the failures with unknown reasons.  Inspect the produced logs
<I>00cpan_i_1</I> to find suspiciously skipped tests, and other fishy events.


<P>


Keep in mind that <I>installation</I> of some modules may fail too: for example,
the DLLs to update may be already loaded by <I></I><FONT SIZE="-1"><I>CPAN</I></FONT><I>.pm</I>.  Inspect the <TT>&quot;install&quot;</TT>
logs (in the example above <I>00cpan_i_1</I> etc) for errors, and install things
manually, as in


<P>




<PRE>
  cd $CPANHOME/.cpan/build/Digest-MD5-2.31
  make install

</PRE>




<P>


Some distributions may fail some tests, but you may want to install them
anyway (as above, or via <TT>&quot;force install&quot;</TT> command of <TT>&quot;CPAN.pm&quot;</TT> shell-mode).


<P>


Since this procedure may take quite a long time to complete, it makes sense
to ``freeze'' your <FONT SIZE="-1">CPAN</FONT> configuration by disabling periodic updates of the
local copy of <FONT SIZE="-1">CPAN</FONT> index: set <TT>&quot;index_expire&quot;</TT> to some big value (I use 365),
then save the settings


<P>




<PRE>
  CPAN&gt; o conf index_expire 365
  CPAN&gt; o conf commit

</PRE>




<P>


Reset back to the default value <TT>1</TT> when you are finished.
<DT>5.<DD>
When satisfied with the results, rerun the <TT>&quot;installcmd&quot;</TT> target.  Now you
can copy <TT>&quot;perl5.8.2.exe&quot;</TT> to <TT>&quot;perl.exe&quot;</TT>, and install the other OMF-build
executables: <TT>&quot;perl__.exe&quot;</TT> etc.  They are ready to be used.
<DT>6.<DD>
Change to the <TT>&quot;./pod&quot;</TT> directory of the build tree, download the Perl logo
<I>CamelGrayBig.BMP</I>, and run


<P>




<PRE>
  ( perl2ipf &gt; perl.ipf ) |&amp; tee 00ipf
  ipfc /INF perl.ipf |&amp; tee 00inf

</PRE>




<P>


This produces the Perl docs online book <TT>&quot;perl.INF&quot;</TT>.  Install in on
<TT>&quot;BOOKSHELF&quot;</TT> path.
<DT>7.<DD>
Now is the time to build statically linked executable <I>perl_.exe</I> which
includes newly-installed via <TT>&quot;Bundle::OS2_default&quot;</TT> modules.  Doing testing
via <TT>&quot;CPAN.pm&quot;</TT> is going to be painfully slow, since it statically links
a new executable per <FONT SIZE="-1">XS</FONT> extension.


<P>


Here is a possible workaround: create a toplevel <I>Makefile.PL</I> in
<I>$CPANHOME/.cpan/build/</I> with contents being (compare with ``Making executables with a custom collection of statically loaded extensions'')


<P>




<PRE>
  use ExtUtils::MakeMaker;
  WriteMakefile NAME =&gt; 'dummy';

</PRE>




<P>


execute this as


<P>




<PRE>
  perl_5.8.2.exe Makefile.PL &lt;nul |&amp; tee 00aout_c1
  make -k all test &lt;nul |&amp; 00aout_t1

</PRE>




<P>


Again, this procedure should not be absolutely smooth.  Some <TT>&quot;Makefile.PL&quot;</TT>'s
in subdirectories may be buggy, and would not run as ``child'' scripts.  The
interdependency of modules can strike you; however, since non-XS modules
are already installed, the prerequisites of most modules have a very good
chance to be present.


<P>


If you discover some glitches, move directories of problematic modules to a
different location; if these modules are non-XS modules, you may just ignore
them - they are already installed; the remaining, <FONT SIZE="-1">XS</FONT>, modules you need to
install manually one by one.


<P>


After each such removal you need to rerun the <TT>&quot;Makefile.PL&quot;</TT>/<TT>&quot;make&quot;</TT> process;
usually this procedure converges soon.  (But be sure to convert all the
necessary external C libraries from <I>.lib</I> format to <I>.a</I> format: run one of


<P>




<PRE>
  emxaout foo.lib
  emximp -o foo.a foo.lib

</PRE>




<P>


whichever is appropriate.)  Also, make sure that the DLLs for external
libraries are usable with with executables compiled without <TT>&quot;-Zmtd&quot;</TT> options.


<P>


When you are sure that only a few subdirectories
lead to failures, you may want to add <TT>&quot;-j4&quot;</TT> option to <TT>&quot;make&quot;</TT> to speed up
skipping subdirectories with already finished build.


<P>


When you are satisfied with the results of tests, install the build C libraries
for extensions:


<P>




<PRE>
  make install |&amp; tee 00aout_i

</PRE>




<P>


Now you can rename the file <I>./perl.exe</I> generated during the last phase
to <I>perl_5.8.2.exe</I>; place it on <TT>&quot;PATH&quot;</TT>; if there is an inter-dependency
between some <FONT SIZE="-1">XS</FONT> modules, you may need to repeat the <TT>&quot;test&quot;</TT>/<TT>&quot;install&quot;</TT> loop
with this new executable and some excluded modules - until the procedure
converges.


<P>


Now you have all the necessary <I>.a</I> libraries for these Perl modules in the
places where Perl builder can find it.  Use the perl builder: change to an
empty directory, create a ``dummy'' <I>Makefile.PL</I> again, and run


<P>




<PRE>
  perl_5.8.2.exe Makefile.PL |&amp; tee 00c
  make perl                  |&amp; tee 00p

</PRE>




<P>


This should create an executable <I>./perl.exe</I> with all the statically loaded
extensions built in.  Compare the generated <I>perlmain.c</I> files to make sure
that during the iterations the number of loaded extensions only increases.
Rename <I>./perl.exe</I> to <I>perl_5.8.2.exe</I> on <TT>&quot;PATH&quot;</TT>.


<P>


When it converges, you got a functional variant of <I>perl_5.8.2.exe</I>; copy it
to <TT>&quot;perl_.exe&quot;</TT>.  You are done with generation of the local Perl installation.
<DT>8.<DD>
Make sure that the installed modules are actually installed in the location
of the new Perl, and are not inherited from entries of <TT>@INC</TT> given for
inheritance from the older versions of Perl: set <TT>&quot;PERLLIB_582_PREFIX&quot;</TT> to
redirect the new version of Perl to a new location, and copy the installed
files to this new location.  Redo the tests to make sure that the versions of
modules inherited from older versions of Perl are not needed.


<P>


Actually, the log output of pod2ipf during the step 6 gives a very detailed
info about which modules are loaded from which place; so you may use it as
an additional verification tool.


<P>


Check that some temporary files did not make into the perl install tree.
Run something like this


<P>




<PRE>
  pfind . -f &quot;!(/\.(pm|pl|ix|al|h|a|lib|txt|pod|imp|bs|dll|ld|bs|inc|xbm|yml|cgi|uu|e2x|skip|packlist|eg|cfg|html|pub|enc|all|ini|po|pot)$/i or /^\w+$/&quot;) | less

</PRE>




<P>


in the install tree (both top one and <I>sitelib</I> one).


<P>


Compress all the DLLs with <I>lxlite</I>.  The tiny <I>.exe</I> can be compressed with
<TT>&quot;/c:max&quot;</TT> (the bug only appears when there is a fixup in the last 6 bytes of a
page (?); since the tiny executables are much smaller than a page, the bug
will not hit).  Do not compress <TT>&quot;perl_.exe&quot;</TT> - it would not work under <FONT SIZE="-1">DOS</FONT>.
<DT>9.<DD>
Now you can generate the binary distribution.  This is done by running the
test of the <FONT SIZE="-1">CPAN</FONT> distribution <TT>&quot;OS2::SoftInstaller&quot;</TT>.  Tune up the file
<I>test.pl</I> to suit the layout of current version of Perl first.  Do not
forget to pack the necessary external DLLs accordingly.  Include the
description of the bugs and test suite failures you could not fix.  Include
the small-stack versions of Perl executables from Perl build directory.


<P>


Include <I>perl5.def</I> so that people can relink the perl <FONT SIZE="-1">DLL</FONT> preserving
the binary compatibility, or can create compatibility DLLs.  Include the diff
files (<TT>&quot;diff -pu old new&quot;</TT>) of fixes you did so that people can rebuild your
version.  Include <I>perl5.map</I> so that one can use remote debugging.
<DT>10.<DD>
<A NAME="ixACU"></A>
Share what you did with the other people.  Relax.  Enjoy fruits of your work.
<DT>11.<DD>
<A NAME="ixACV"></A>
Brace yourself for thanks, bug reports, hate mail and spam coming as result
of the previous step.  No good deed should remain unpunished!
</DL>
<A NAME="lbBM">&nbsp;</A>
<H2>Building custom <I>.EXE</I> files</H2>

<A NAME="ixACW"></A>
The Perl executables can be easily rebuilt at any moment.  Moreover, one can
use the <I>embedding</I> interface (see perlembed) to make very customized
executables.
<A NAME="lbBN">&nbsp;</A>
<H2>Making executables with a custom collection of statically loaded extensions</H2>

<A NAME="ixACX"></A>
It is a little bit easier to do so while <I>decreasing</I> the list of statically
loaded extensions.  We discuss this case only here.
<DL COMPACT>
<DT>1.<DD>
Change to an empty directory, and create a placeholder &lt;Makefile.PL&gt;:


<P>




<PRE>
  use ExtUtils::MakeMaker;
  WriteMakefile NAME =&gt; 'dummy';

</PRE>


<DT>2.<DD>
Run it with the flavor of Perl (<I>perl.exe</I> or <I>perl_.exe</I>) you want to
rebuild.


<P>




<PRE>
  perl_ Makefile.PL

</PRE>


<DT>3.<DD>
Ask it to create new Perl executable:


<P>




<PRE>
  make perl

</PRE>




<P>


(you may need to manually add <TT>&quot;PERLTYPE=-DPERL_CORE&quot;</TT> to this commandline on
some versions of Perl; the symptom is that the command-line globbing does not
work from <FONT SIZE="-1">OS/2</FONT> shells with the newly-compiled executable; check with


<P>




<PRE>
  .\perl.exe -wle &quot;print for @ARGV&quot; *

</PRE>




<P>


).
<DT>4.<DD>
The previous step created <I>perlmain.c</I> which contains a list of <I>newXS()</I> calls
near the end.  Removing unnecessary calls, and rerunning


<P>




<PRE>
  make perl

</PRE>




<P>


will produce a customized executable.
</DL>
<A NAME="lbBO">&nbsp;</A>
<H2>Making executables with a custom search-paths</H2>

<A NAME="ixACY"></A>
The default perl executable is flexible enough to support most usages.
However, one may want something yet more flexible; for example, one may want
to find Perl <FONT SIZE="-1">DLL</FONT> relatively to the location of the <FONT SIZE="-1">EXE</FONT> file; or one may want
to ignore the environment when setting the Perl-library search patch, etc.
<P>

If you fill comfortable with <I>embedding</I> interface (see perlembed), such
things are easy to do repeating the steps outlined in ``Making executables with a custom collection of statically loaded extensions'', and
doing more comprehensive edits to <I>main()</I> of <I>perlmain.c</I>.  The people with
little desire to understand Perl can just rename <I>main()</I>, and do necessary
modification in a custom <I>main()</I> which calls the renamed function in appropriate
time.
<P>

However, there is a third way: perl <FONT SIZE="-1">DLL</FONT> exports the <I>main()</I> function and several
callbacks to customize the search path.  Below is a complete example of a
``Perl loader'' which
<DL COMPACT>
<DT>1.<DD>
Looks for Perl <FONT SIZE="-1">DLL</FONT> in the directory <TT>&quot;$exedir/../dll&quot;</TT>;
<DT>2.<DD>
Prepends the above directory to <TT>&quot;BEGINLIBPATH&quot;</TT>;
<DT>3.<DD>
Fails if the Perl <FONT SIZE="-1">DLL</FONT> found via <TT>&quot;BEGINLIBPATH&quot;</TT> is different from what was
loaded on step 1; e.g., another process could have loaded it from <TT>&quot;LIBPATH&quot;</TT>
or from a different value of <TT>&quot;BEGINLIBPATH&quot;</TT>.  In these cases one needs to
modify the setting of the system so that this other process either does not
run, or loads the <FONT SIZE="-1">DLL</FONT> from <TT>&quot;BEGINLIBPATH&quot;</TT> with <TT>&quot;LIBPATHSTRICT=T&quot;</TT> (available
with kernels after September 2000).
<DT>4.<DD>
Loads Perl library from <TT>&quot;$exedir/../dll/lib/&quot;</TT>.
<DT>5.<DD>
Uses Bourne shell from <TT>&quot;$exedir/../dll/sh/ksh.exe&quot;</TT>.
</DL>
<P>

For best results compile the C file below with the same options as the Perl
<FONT SIZE="-1">DLL</FONT>.  However, a lot of functionality will work even if the executable is not
an <FONT SIZE="-1">EMX</FONT> applications, e.g., if compiled with
<P>



<PRE>
  gcc -Wall -DDOSISH -DOS2=1 -O2 -s -Zomf -Zsys perl-starter.c -DPERL_DLL_BASENAME=\&quot;perl312F\&quot; -Zstack 8192 -Zlinker /PM:VIO

</PRE>


<P>

Here is the sample C file:
<P>



<PRE>
  #define INCL_DOS
  #define INCL_NOPM
  /* These are needed for compile if os2.h includes os2tk.h, not os2emx.h */
  #define INCL_DOSPROCESS
  #include &lt;<A HREF="file:/usr/include/os2.h">os2.h</A>&gt;

</PRE>


<P>



<PRE>
  #include &quot;EXTERN.h&quot;
  #define PERL_IN_MINIPERLMAIN_C
  #include &quot;perl.h&quot;

</PRE>


<P>



<PRE>
  static char *me;
  HMODULE handle;

</PRE>


<P>



<PRE>
  static void
  die_with(char *msg1, char *msg2, char *msg3, char *msg4)
  {
     ULONG c;
     char *s = &quot; error: &quot;;

</PRE>


<P>



<PRE>
     DosWrite(2, me, strlen(me), &amp;c);
     DosWrite(2, s, strlen(s), &amp;c);
     DosWrite(2, msg1, strlen(msg1), &amp;c);
     DosWrite(2, msg2, strlen(msg2), &amp;c);
     DosWrite(2, msg3, strlen(msg3), &amp;c);
     DosWrite(2, msg4, strlen(msg4), &amp;c);
     DosWrite(2, &quot;\r\n&quot;, 2, &amp;c);
     exit(255);
  }

</PRE>


<P>



<PRE>
  typedef ULONG (*fill_extLibpath_t)(int type, char *pre, char *post, int replace, char *msg);
  typedef int (*main_t)(int type, char *argv[], char *env[]);
  typedef int (*handler_t)(void* data, int which);

</PRE>


<P>



<PRE>
  #ifndef PERL_DLL_BASENAME
  #  define PERL_DLL_BASENAME &quot;perl&quot;
  #endif

</PRE>


<P>



<PRE>
  static HMODULE
  load_perl_dll(char *basename)
  {
      char buf[300], fail[260];
      STRLEN l, dirl;
      fill_extLibpath_t f;
      ULONG rc_fullname;
      HMODULE handle, handle1;

</PRE>


<P>



<PRE>
      if (_execname(buf, sizeof(buf) - 13) != 0)
          die_with(&quot;Can't find full path: &quot;, strerror(errno), &quot;&quot;, &quot;&quot;);
      /* XXXX Fill `me' with new value */
      l = strlen(buf);
      while (l &amp;&amp; buf[l-1] != '/' &amp;&amp; buf[l-1] != '\\')
          l--;
      dirl = l - 1;
      strcpy(buf + l, basename);
      l += strlen(basename);
      strcpy(buf + l, &quot;.dll&quot;);
      if ( (rc_fullname = DosLoadModule(fail, sizeof fail, buf, &amp;handle)) != 0
           &amp;&amp; DosLoadModule(fail, sizeof fail, basename, &amp;handle) != 0 )
          die_with(&quot;Can't load DLL &quot;, buf, &quot;&quot;, &quot;&quot;);
      if (rc_fullname)
          return handle;                /* was loaded with short name; all is fine */
      if (DosQueryProcAddr(handle, 0, &quot;fill_extLibpath&quot;, (PFN*)&amp;f))
          die_with(buf, &quot;: DLL exports no symbol &quot;, &quot;fill_extLibpath&quot;, &quot;&quot;);
      buf[dirl] = 0;
      if (f(0 /*BEGINLIBPATH*/, buf /* prepend */, NULL /* append */,
            0 /* keep old value */, me))
          die_with(me, &quot;: prepending BEGINLIBPATH&quot;, &quot;&quot;, &quot;&quot;);
      if (DosLoadModule(fail, sizeof fail, basename, &amp;handle1) != 0)
          die_with(me, &quot;: finding perl DLL again via BEGINLIBPATH&quot;, &quot;&quot;, &quot;&quot;);
      buf[dirl] = '\\';     
      if (handle1 != handle) {
          if (DosQueryModuleName(handle1, sizeof(fail), fail))
              strcpy(fail, &quot;???&quot;);
          die_with(buf, &quot;:\n\tperl DLL via BEGINLIBPATH is different: \n\t&quot;,
                   fail,
                   &quot;\n\tYou may need to manipulate global BEGINLIBPATH and LIBPATHSTRICT&quot;
                   &quot;\n\tso that the other copy is loaded via BEGINLIBPATH.&quot;);
      }
      return handle;
  }

</PRE>


<P>



<PRE>
  int
  main(int argc, char **argv, char **env)
  {
      main_t f;
      handler_t h;

</PRE>


<P>



<PRE>
      me = argv[0];
      /**/
      handle = load_perl_dll(PERL_DLL_BASENAME);

</PRE>


<P>



<PRE>
      if (DosQueryProcAddr(handle, 0, &quot;Perl_OS2_handler_install&quot;, (PFN*)&amp;h))
          die_with(PERL_DLL_BASENAME, &quot;: DLL exports no symbol &quot;, &quot;Perl_OS2_handler_install&quot;, &quot;&quot;);
      if ( !h((void *)&quot;~installprefix&quot;, Perlos2_handler_perllib_from)
           || !h((void *)&quot;~dll&quot;, Perlos2_handler_perllib_to)
           || !h((void *)&quot;~dll/sh/ksh.exe&quot;, Perlos2_handler_perl_sh) )
          die_with(PERL_DLL_BASENAME, &quot;: Can't install @INC manglers&quot;, &quot;&quot;, &quot;&quot;);

</PRE>


<P>



<PRE>
      if (DosQueryProcAddr(handle, 0, &quot;dll_perlmain&quot;, (PFN*)&amp;f))
          die_with(PERL_DLL_BASENAME, &quot;: DLL exports no symbol &quot;, &quot;dll_perlmain&quot;, &quot;&quot;);
      return f(argc, argv, env);
  }

</PRE>


<A NAME="lbBP">&nbsp;</A>
<H2>Build FAQ</H2>

<A NAME="ixACZ"></A>
<A NAME="lbBQ">&nbsp;</A>
<H2>Some /</TT> became <TT>\ in pdksh.</H2>



<A NAME="ixADA"></A>
You have a very old pdksh. See Prerequisites.
</TT><A NAME="lbBR">&nbsp;</A>
<H2>'errno' - unresolved external</H2>



<A NAME="ixADB"></A>
You do not have MT-safe <I>db.lib</I>. See Prerequisites.
<A NAME="lbBS">&nbsp;</A>
<H2>Problems with tr or sed</H2>

<A NAME="ixADC"></A>
reported with very old version of tr and sed.
<A NAME="lbBT">&nbsp;</A>
<H2>Some problem (forget which ;-)</H2>

<A NAME="ixADD"></A>
You have an older version of <I>perl.dll</I> on your <FONT SIZE="-1">LIBPATH</FONT>, which
broke the build of extensions.
<A NAME="lbBU">&nbsp;</A>
<H2>Library ... not found</H2>

<A NAME="ixADE"></A>
You did not run <TT>&quot;omflibs&quot;</TT>. See Prerequisites.
<A NAME="lbBV">&nbsp;</A>
<H2>Segfault in make</H2>

<A NAME="ixADF"></A>
You use an old version of <FONT SIZE="-1">GNU</FONT> make. See Prerequisites.
<A NAME="lbBW">&nbsp;</A>
<H2>op/sprintf test failure</H2>

<A NAME="ixADG"></A>
This can result from a bug in emx sprintf which was fixed in 0.9d fix 03.
<A NAME="lbBX">&nbsp;</A>
<H2>Specific (mis)features of OS/2 port</H2>

<A NAME="ixADH"></A>
<A NAME="lbBY">&nbsp;</A>
<H2>setpriority</TT>, <TT>getpriority</H2>



<A NAME="ixADI"></A>
Note that these functions are compatible with *nix, not with the older
ports of '94 - 95. The priorities are absolute, go from 32 to -95,
lower is quicker. 0 is the default priority.
<P>

</TT><B></B><FONT SIZE="-1"><B>WARNING</B></FONT><B></B>.  Calling <TT>&quot;getpriority&quot;</TT> on a non-existing process could lock
the system before Warp3 fixpak22.  Starting with Warp3, Perl will use
a workaround: it aborts <I>getpriority()</I> if the process is not present.
This is not possible on older versions <TT>&quot;2.*&quot;</TT>, and has a race
condition anyway.
<A NAME="lbBZ">&nbsp;</A>
<H2>system()</H2>



<A NAME="ixADJ"></A>
Multi-argument form of <TT>&quot;system()&quot;</TT> allows an additional numeric
argument. The meaning of this argument is described in
OS2::Process.
<P>

When finding a program to run, Perl first asks the <FONT SIZE="-1">OS</FONT> to look for executables
on <TT>&quot;PATH&quot;</TT> (<FONT SIZE="-1">OS/2</FONT> adds extension <I>.exe</I> if no extension is present).
If not found, it looks for a script with possible extensions 
added in this order: no extension, <I>.cmd</I>, <I>.btm</I>, 
<I>.bat</I>, <I>.pl</I>.  If found, Perl checks the start of the file for magic
strings <TT>&quot;#!&quot;</TT> and <TT>&quot;extproc &quot;</TT>.  If found, Perl uses the rest of the
first line as the beginning of the command line to run this script.  The
only mangling done to the first line is extraction of arguments (currently
up to 3), and ignoring of the path-part of the ``interpreter'' name if it can't
be found using the full path.
<P>

E.g., <TT>&quot;system 'foo', 'bar', 'baz'&quot;</TT> may lead Perl to finding
<I>C:/emx/bin/foo.cmd</I> with the first line being
<P>



<PRE>
 extproc /bin/bash    -x   -c

</PRE>


<P>

If <I>/bin/bash.exe</I> is not found, then Perl looks for an executable <I>bash.exe</I> on
<TT>&quot;PATH&quot;</TT>.  If found in <I>C:/emx.add/bin/bash.exe</I>, then the above <I>system()</I> is
translated to
<P>



<PRE>
  system qw(C:/emx.add/bin/bash.exe -x -c C:/emx/bin/foo.cmd bar baz)

</PRE>


<P>

One additional translation is performed: instead of <I>/bin/sh</I> Perl uses
the hardwired-or-customized shell (see <TT>&quot;``</TT><FONT SIZE="-1"><TT>PERL_SH_DIR</TT></FONT><TT>''&quot;</TT>).
<P>

The above search for ``interpreter'' is recursive: if <I>bash</I> executable is not
found, but <I>bash.btm</I> is found, Perl will investigate its first line etc.
The only hardwired limit on the recursion depth is implicit: there is a limit
4 on the number of additional arguments inserted before the actual arguments
given to <I>system()</I>.  In particular, if no additional arguments are specified
on the ``magic'' first lines, then the limit on the depth is 4.
<P>

If Perl finds that the found executable is of <FONT SIZE="-1">PM</FONT> type when the
current session is not, it will start the new process in a separate session of
necessary type.  Call via <TT>&quot;OS2::Process&quot;</TT> to disable this magic.
<P>

<B></B><FONT SIZE="-1"><B>WARNING</B></FONT><B></B>.  Due to the described logic, you need to explicitly
specify <I>.com</I> extension if needed.  Moreover, if the executable
<I>perl5.6.1</I> is requested, Perl will not look for <I>perl5.6.1.exe</I>.
[This may change in the future.]
<A NAME="lbCA">&nbsp;</A>
<H2>extproc on the first line</H2>



<A NAME="ixADK"></A>
If the first chars of a Perl script are <TT>&quot;extproc &quot;</TT>, this line is treated
as <TT>&quot;#!&quot;</TT>-line, thus all the switches on this line are processed (twice
if script was started via cmd.exe).  See ``<FONT SIZE="-1">DESCRIPTION</FONT>'' in perlrun.
<A NAME="lbCB">&nbsp;</A>
<H2>Additional modules:</H2>

<A NAME="ixADL"></A>
OS2::Process, <FONT SIZE="-1">OS2::DLL</FONT>, <FONT SIZE="-1">OS2::REXX</FONT>, OS2::PrfDB, OS2::ExtAttr. These
modules provide access to additional numeric argument for <TT>&quot;system&quot;</TT>
and to the information about the running process,
to DLLs having functions with <FONT SIZE="-1">REXX</FONT> signature and to the <FONT SIZE="-1">REXX</FONT> runtime, to
<FONT SIZE="-1">OS/2</FONT> databases in the <I>.INI</I> format, and to Extended Attributes.
<P>

Two additional extensions by Andreas Kaiser, <TT>&quot;OS2::UPM&quot;</TT>, and
<TT>&quot;OS2::FTP&quot;</TT>, are included into <TT>&quot;ILYAZ&quot;</TT> directory, mirrored on <FONT SIZE="-1">CPAN</FONT>.
Other OS/2-related extensions are available too.
<A NAME="lbCC">&nbsp;</A>
<H2>Prebuilt methods:</H2>

<A NAME="ixADM"></A>
<DL COMPACT>
<DT>File::Copy::syscopy<DD>


<A NAME="ixADN"></A>
used by <TT>&quot;File::Copy::copy&quot;</TT>, see File::Copy.
<DT>DynaLoader::mod2fname<DD>


<A NAME="ixADO"></A>
used by <TT>&quot;DynaLoader&quot;</TT> for <FONT SIZE="-1">DLL</FONT> name mangling.
<DT>Cwd::current_drive()<DD>


<A NAME="ixADP"></A>
Self explanatory.
<DT>Cwd::sys_chdir(name)<DD>


<A NAME="ixADQ"></A>
leaves drive as it is.
<DT>Cwd::change_drive(name)<DD>


<A NAME="ixADR"></A>
chanes the ``current'' drive.
<DT>Cwd::sys_is_absolute(name)<DD>


<A NAME="ixADS"></A>
means has drive letter and is_rooted.
<DT>Cwd::sys_is_rooted(name)<DD>


<A NAME="ixADT"></A>
means has leading <TT>&quot;[/\\]&quot;</TT> (maybe after a drive-letter:).
<DT>Cwd::sys_is_relative(name)<DD>


<A NAME="ixADU"></A>
means changes with current dir.
<DT>Cwd::sys_cwd(name)<DD>


<A NAME="ixADV"></A>
Interface to cwd from <FONT SIZE="-1">EMX</FONT>. Used by <TT>&quot;Cwd::cwd&quot;</TT>.
<DT>Cwd::sys_abspath(name, dir)<DD>


<A NAME="ixADW"></A>
Really really odious function to implement. Returns absolute name of
file which would have <TT>&quot;name&quot;</TT> if <FONT SIZE="-1">CWD</FONT> were <TT>&quot;dir&quot;</TT>.  <TT>&quot;Dir&quot;</TT> defaults to the
current dir.
<DT>Cwd::extLibpath([type])<DD>


<A NAME="ixADX"></A>
Get current value of extended library search path. If <TT>&quot;type&quot;</TT> is
present and positive, works with <TT>&quot;END_LIBPATH&quot;</TT>, if negative, works
with <TT>&quot;LIBPATHSTRICT&quot;</TT>, otherwise with <TT>&quot;BEGIN_LIBPATH&quot;</TT>. 
<DT>Cwd::extLibpath_set( path [, type ] )<DD>


<A NAME="ixADY"></A>
Set current value of extended library search path. If <TT>&quot;type&quot;</TT> is
present and positive, works with &lt;<FONT SIZE="-1">END_LIBPATH</FONT>&gt;, if negative, works
with <TT>&quot;LIBPATHSTRICT&quot;</TT>, otherwise with <TT>&quot;BEGIN_LIBPATH&quot;</TT>.
<DT>OS2::Error(do_harderror,do_exception)<DD>


<A NAME="ixADZ"></A>
Returns<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>&quot;undef&quot;</TT> if it was not called yet, otherwise bit 1 is<BR>
set if on the previous call do_harderror was enabled, bit
2 is set if on previous call do_exception was enabled.


<P>


This function enables/disables error popups associated with 
hardware errors (Disk not ready etc.) and software exceptions.


<P>


I know of no way to find out the state of popups <I>before</I> the first call
to this function.
<DT>OS2::Errors2Drive(drive)<DD>


<A NAME="ixAEA"></A>
Returns <TT>&quot;undef&quot;</TT> if it was not called yet, otherwise return false if errors
were not requested to be written to a hard drive, or the drive letter if
this was requested.


<P>


This function may redirect error popups associated with hardware errors
(Disk not ready etc.) and software exceptions to the file <FONT SIZE="-1">POPUPLOG</FONT>.OS2 at
the root directory of the specified drive.  Overrides <I>OS2::Error()</I> specified
by individual programs.  Given argument undef will disable redirection.


<P>


Has global effect, persists after the application exits.


<P>


I know of no way to find out the state of redirection of popups to the disk
<I>before</I> the first call to this function.
<DT><I>OS2::SysInfo()</I><DD>
<A NAME="ixAEB"></A>
Returns a hash with system information. The keys of the hash are


<P>




<PRE>
        MAX_PATH_LENGTH, MAX_TEXT_SESSIONS, MAX_PM_SESSIONS,
        MAX_VDM_SESSIONS, BOOT_DRIVE, DYN_PRI_VARIATION,
        MAX_WAIT, MIN_SLICE, MAX_SLICE, PAGE_SIZE,
        VERSION_MAJOR, VERSION_MINOR, VERSION_REVISION,
        MS_COUNT, TIME_LOW, TIME_HIGH, TOTPHYSMEM, TOTRESMEM,
        TOTAVAILMEM, MAXPRMEM, MAXSHMEM, TIMER_INTERVAL,
        MAX_COMP_LENGTH, FOREGROUND_FS_SESSION,
        FOREGROUND_PROCESS

</PRE>


<DT><I>OS2::BootDrive()</I><DD>
<A NAME="ixAEC"></A>
Returns a letter without colon.
<DT>OS2::MorphPM(serve), <TT>OS2::UnMorphPM(serve)<DD>


<A NAME="ixAED"></A>
Transforms the current application into a </TT><FONT SIZE="-1"><TT>PM</TT></FONT><TT> application and back.
The argument true means that a real message loop is going to be served.
</TT><I>OS2::MorphPM()</I> returns the <FONT SIZE="-1">PM</FONT> message queue handle as an integer.


<P>


See ``Centralized management of resources'' for additional details.
<DT>OS2::Serve_Messages(force)<DD>


<A NAME="ixAEE"></A>
Fake on-demand retrieval of outstanding <FONT SIZE="-1">PM</FONT> messages.  If <TT>&quot;force&quot;</TT> is false,
will not dispatch messages if a real message loop is known to
be present.  Returns number of messages retrieved.


<P>


Dies with ``QUITing...'' if <FONT SIZE="-1">WM_QUIT</FONT> message is obtained.
<DT>OS2::Process_Messages(force [, cnt])<DD>


<A NAME="ixAEF"></A>
Retrieval of <FONT SIZE="-1">PM</FONT> messages until window creation/destruction.  
If <TT>&quot;force&quot;</TT> is false, will not dispatch messages if a real message loop
is known to be present.


<P>


Returns change in number of windows.  If <TT>&quot;cnt&quot;</TT> is given,
it is incremented by the number of messages retrieved.


<P>


Dies with ``QUITing...'' if <FONT SIZE="-1">WM_QUIT</FONT> message is obtained.
<DT>OS2::_control87(new,mask)<DD>


<A NAME="ixAEG"></A>
the same as <I><A HREF="../man3/_control87.3.php">_control87</A></I>(3) of <FONT SIZE="-1">EMX</FONT>.  Takes integers as arguments, returns
the previous coprocessor control word as an integer.  Only bits in <TT>&quot;new&quot;</TT> which
are present in <TT>&quot;mask&quot;</TT> are changed in the control word.
<DT><I>OS2::get_control87()</I><DD>
<A NAME="ixAEH"></A>
gets the coprocessor control word as an integer.
<DT>OS2::set_control87_em(new=MCW_EM,mask=MCW_EM)<DD>


<A NAME="ixAEI"></A>
The variant of <I>OS2::_control87()</I> with default values good for
handling exception mask: if no <TT>&quot;mask&quot;</TT>, uses exception mask part of <TT>&quot;new&quot;</TT>
only.  If no <TT>&quot;new&quot;</TT>, disables all the floating point exceptions.


<P>


See ``Misfeatures'' for details.
<DT>OS2::DLLname([how [, \&amp;xsub]])<DD>


<A NAME="ixAEJ"></A>
Gives the information about the Perl <FONT SIZE="-1">DLL</FONT> or the <FONT SIZE="-1">DLL</FONT> containing the C
function bound to by <TT>&amp;xsub</TT>.  The meaning of <TT>&quot;how&quot;</TT> is: default (2):
full name; 0: handle; 1: module name.
</DL>
<P>

(Note that some of these may be moved to different libraries -
eventually).
<A NAME="lbCD">&nbsp;</A>
<H2>Prebuilt variables:</H2>

<A NAME="ixAEK"></A>
<DL COMPACT>
<DT>$OS2::emx_rev<DD>
<A NAME="ixAEL"></A>
numeric value is the same as _emx_rev of <FONT SIZE="-1">EMX</FONT>, a string value the same
as _emx_vprt (similar to <TT>&quot;0.9c&quot;</TT>).
<DT>$OS2::emx_env<DD>
<A NAME="ixAEM"></A>
same as _emx_env of <FONT SIZE="-1">EMX</FONT>, a number similar to 0x8001.
<DT>$OS2::os_ver<DD>
<A NAME="ixAEN"></A>
a number <TT>&quot;OS_MAJOR + 0.001 * OS_MINOR&quot;</TT>.
<DT>$OS2::is_aout<DD>
<A NAME="ixAEO"></A>
true if the Perl library was compiled in <FONT SIZE="-1">AOUT</FONT> format.
<DT>$OS2::can_fork<DD>
<A NAME="ixAEP"></A>
true if the current executable is an <FONT SIZE="-1">AOUT</FONT> <FONT SIZE="-1">EMX</FONT> executable, so Perl can
fork.  Do not use this, use the portable check for
<TT>$Config::Config</TT>{dfork}.
<DT>$OS2::nsyserror<DD>
<A NAME="ixAEQ"></A>
This variable (default is 1) controls whether to enforce the contents
of $^E to start with <TT>&quot;SYS0003&quot;</TT>-like id.  If set to 0, then the string
value of $^E is what is available from the <FONT SIZE="-1">OS/2</FONT> message file.  (Some
messages in this file have an <TT>&quot;SYS0003&quot;</TT>-like id prepended, some not.)
</DL>
<A NAME="lbCE">&nbsp;</A>
<H2>Misfeatures</H2>

<A NAME="ixAER"></A>
<DL COMPACT>
<DT>*<DD>
Since <I><A HREF="../man3/flock.3.php">flock</A></I>(3) is present in <FONT SIZE="-1">EMX</FONT>, but is not functional, it is 
emulated by perl.  To disable the emulations, set environment variable
<TT>&quot;USE_PERL_FLOCK=0&quot;</TT>.
<DT>*<DD>
Here is the list of things which may be ``broken'' on
<FONT SIZE="-1">EMX</FONT> (from <FONT SIZE="-1">EMX</FONT> docs):
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>*<DD>
The functions <I><A HREF="../man3/recvmsg.3.php">recvmsg</A></I>(3), <I><A HREF="../man3/sendmsg.3.php">sendmsg</A></I>(3), and <I><A HREF="../man3/socketpair.3.php">socketpair</A></I>(3) are not
implemented.
<DT>*<DD>
<I><A HREF="../man3/sock_init.3.php">sock_init</A></I>(3) is not required and not implemented.
<DT>*<DD>
<I><A HREF="../man3/flock.3.php">flock</A></I>(3) is not yet implemented (dummy function).  (Perl has a workaround.)
<DT>*<DD>
<I><A HREF="../man3/kill.3.php">kill</A></I>(3):  Special treatment of PID=0, PID=1 and PID=-1 is not implemented.
<DT>*<DD>
<I><A HREF="../man3/waitpid.3.php">waitpid</A></I>(3):


<P>




<PRE>
      WUNTRACED
              Not implemented.
      waitpid() is not implemented for negative values of PID.

</PRE>


</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


Note that <TT>&quot;kill -9&quot;</TT> does not work with the current version of <FONT SIZE="-1">EMX</FONT>.
</DL>

<DT>*<DD>
See ``Text-mode filehandles''.
<DT>*<DD>
Unix-domain sockets on <FONT SIZE="-1">OS/2</FONT> live in a pseudo-file-system <TT>&quot;/sockets/...&quot;</TT>.
To avoid a failure to create a socket with a name of a different form,
<TT>&quot;/socket/&quot;</TT> is prepended to the socket name (unless it starts with this
already).


<P>


This may lead to problems later in case the socket is accessed via the
``usual'' file-system calls using the ``initial'' name.
<DT>*<DD>
Apparently, <FONT SIZE="-1">IBM</FONT> used a compiler (for some period of time around '95?) which
changes <FONT SIZE="-1">FP</FONT> mask right and left.  This is not <I>that</I> bad for <FONT SIZE="-1">IBM</FONT>'s
programs, but the same compiler was used for DLLs which are used with
general-purpose applications.  When these DLLs are used, the state of
floating-point flags in the application is not predictable.


<P>


What is much worse, some DLLs change the floating point flags when in
<I>_DLLInitTerm()</I> (e.g., <I></I><FONT SIZE="-1"><I>TCP32IP</I></FONT><I></I>).  This means that even if you do not <I>call</I>
any function in the <FONT SIZE="-1">DLL</FONT>, just the act of loading this <FONT SIZE="-1">DLL</FONT> will reset your
flags.  What is worse, the same compiler was used to compile some <FONT SIZE="-1">HOOK</FONT> DLLs.
Given that <FONT SIZE="-1">HOOK</FONT> dlls are executed in the context of <I>all</I> the applications
in the system, this means a complete unpredictablity of floating point
flags on systems using such <FONT SIZE="-1">HOOK</FONT> DLLs.  E.g., <I></I><FONT SIZE="-1"><I>GAMESRVR</I></FONT><I>.DLL</I> of <B></B><FONT SIZE="-1"><B>DIVE</B></FONT><B></B>
origin changes the floating point flags on each write to the <FONT SIZE="-1">TTY</FONT> of a <FONT SIZE="-1">VIO</FONT>
(windowed text-mode) applications.


<P>


Some other (not completely debugged) situations when <FONT SIZE="-1">FP</FONT> flags change include
some video drivers (?), and some operations related to creation of the windows.
People who code <B>OpenGL</B> may have more experience on this.


<P>


Perl is generally used in the situation when all the floating-point
exceptions are ignored, as is the default under <FONT SIZE="-1">EMX</FONT>.  If they are not ignored,
some benign Perl programs would get a <TT>&quot;SIGFPE&quot;</TT> and would die a horrible death.


<P>


To circumvent this, Perl uses two hacks.  They help against <I>one</I> type of
damage only: <FONT SIZE="-1">FP</FONT> flags changed when loading a <FONT SIZE="-1">DLL</FONT>.


<P>


One of the hacks is to disable floating point exceptions on Perl startup (as
is the default with <FONT SIZE="-1">EMX</FONT>).  This helps only with compile-time-linked DLLs
changing the flags before <I>main()</I> had a chance to be called.


<P>


The other hack is to restore <FONT SIZE="-1">FP</FONT> flags after a call to <I>dlopen()</I>.  This helps
against similar damage done by DLLs <I>_DLLInitTerm()</I> at runtime.  Currently
no way to switch these hacks off is provided.
</DL>
<A NAME="lbCF">&nbsp;</A>
<H2>Modifications</H2>

<A NAME="ixAES"></A>
Perl modifies some standard C library calls in the following ways:
<DL COMPACT>
<DT>popen<DD>


<A NAME="ixAET"></A>
<TT>&quot;my_popen&quot;</TT> uses <I>sh.exe</I> if shell is required, cf. ``<FONT SIZE="-1">PERL_SH_DIR</FONT>''.
<DT>tmpnam<DD>


<A NAME="ixAEU"></A>
is created using <TT>&quot;TMP&quot;</TT> or <TT>&quot;TEMP&quot;</TT> environment variable, via
<TT>&quot;tempnam&quot;</TT>.
<DT>tmpfile<DD>


<A NAME="ixAEV"></A>
If the current directory is not writable, file is created using modified
<TT>&quot;tmpnam&quot;</TT>, so there may be a race condition.
<DT>ctermid<DD>


<A NAME="ixAEW"></A>
a dummy implementation.
<DT>stat<DD>


<A NAME="ixAEX"></A>
<TT>&quot;os2_stat&quot;</TT> special-cases <I>/dev/tty</I> and <I>/dev/con</I>.
<DT>mkdir, <TT>rmdir<DD>


<A NAME="ixAEY"></A>
these </TT><FONT SIZE="-1"><TT>EMX</TT></FONT><TT> functions do not work if the path contains a trailing &quot;/&quot;</TT>.
Perl contains a workaround for this.
<DT>flock<DD>


<A NAME="ixAEZ"></A>
Since <I><A HREF="../man3/flock.3.php">flock</A></I>(3) is present in <FONT SIZE="-1">EMX</FONT>, but is not functional, it is 
emulated by perl.  To disable the emulations, set environment variable
<TT>&quot;USE_PERL_FLOCK=0&quot;</TT>.
</DL>
<A NAME="lbCG">&nbsp;</A>
<H2>Identifying DLLs</H2>

<A NAME="ixAFA"></A>
All the DLLs built with the current versions of Perl have <FONT SIZE="-1">ID</FONT> strings
identifying the name of the extension, its version, and the version
of Perl required for this <FONT SIZE="-1">DLL</FONT>.  Run <TT>&quot;bldlevel DLL-name&quot;</TT> to find this
info.
<A NAME="lbCH">&nbsp;</A>
<H2>Centralized management of resources</H2>

<A NAME="ixAFB"></A>
Since to call certain <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT> one needs to have a correctly initialized
<TT>&quot;Win&quot;</TT> subsystem, OS/2-specific extensions may require getting <TT>&quot;HAB&quot;</TT>s and
<TT>&quot;HMQ&quot;</TT>s.  If an extension would do it on its own, another extension could
fail to initialize.
<P>

Perl provides a centralized management of these resources:
<DL COMPACT>
<DT>HAB<DD>


<A NAME="ixAFC"></A>
To get the <FONT SIZE="-1">HAB</FONT>, the extension should call <TT>&quot;hab = perl_hab_GET()&quot;</TT> in C.  After
this call is performed, <TT>&quot;hab&quot;</TT> may be accessed as <TT>&quot;Perl_hab&quot;</TT>.  There is
no need to release the <FONT SIZE="-1">HAB</FONT> after it is used.


<P>


If by some reasons <I>perl.h</I> cannot be included, use


<P>




<PRE>
  extern int Perl_hab_GET(void);

</PRE>




<P>


instead.
<DT>HMQ<DD>


<A NAME="ixAFD"></A>
There are two cases:
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>*<DD>
the extension needs an <TT>&quot;HMQ&quot;</TT> only because some <FONT SIZE="-1">API</FONT> will not work otherwise.
Use <TT>&quot;serve = 0&quot;</TT> below.
<DT>*<DD>
the extension needs an <TT>&quot;HMQ&quot;</TT> since it wants to engage in a <FONT SIZE="-1">PM</FONT> event loop.
Use <TT>&quot;serve = 1&quot;</TT> below.
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


To get an <TT>&quot;HMQ&quot;</TT>, the extension should call <TT>&quot;hmq = perl_hmq_GET(serve)&quot;</TT> in C.
After this call is performed, <TT>&quot;hmq&quot;</TT> may be accessed as <TT>&quot;Perl_hmq&quot;</TT>.


<P>


To signal to Perl that <FONT SIZE="-1">HMQ</FONT> is not needed any more, call
<TT>&quot;perl_hmq_UNSET(serve)&quot;</TT>.  Perl process will automatically morph/unmorph itself
into/from a <FONT SIZE="-1">PM</FONT> process if <FONT SIZE="-1">HMQ</FONT> is needed/not-needed.  Perl will automatically
enable/disable <TT>&quot;WM_QUIT&quot;</TT> message during shutdown if the message queue is
served/not-served.


<P>


<B></B><FONT SIZE="-1"><B>NOTE</B></FONT><B></B>.  If during a shutdown there is a message queue which did not disable
<FONT SIZE="-1">WM_QUIT</FONT>, and which did not process the received <FONT SIZE="-1">WM_QUIT</FONT> message, the
shutdown will be automatically cancelled.  Do not call <TT><A HREF="../man1/perl_hmq_GET.1.php">perl_hmq_GET</A>(1)</TT>
unless you are going to process messages on an orderly basis.
</DL>

<DT>* Treating errors reported by <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT><DD>
<A NAME="ixAFE"></A>
There are two principal conventions (it is useful to call them <TT>&quot;Dos*&quot;</TT>
and <TT>&quot;Win*&quot;</TT> - though this part of the function signature is not always
determined by the name of the <FONT SIZE="-1">API</FONT>) of reporting the error conditions
of <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT>.  Most of <TT>&quot;Dos*&quot;</TT> APIs report the error code as the result
of the call (so 0 means success, and there are many types of errors).
Most of <TT>&quot;Win*&quot;</TT> <FONT SIZE="-1">API</FONT> report success/fail via the result being
<TT>&quot;TRUE&quot;</TT>/<TT>&quot;FALSE&quot;</TT>; to find the reason for the failure one should call
<I>WinGetLastError()</I> <FONT SIZE="-1">API</FONT>.


<P>


Some <TT>&quot;Win*&quot;</TT> entry points also overload a ``meaningful'' return value
with the error indicator; having a 0 return value indicates an error.
Yet some other <TT>&quot;Win*&quot;</TT> entry points overload things even more, and 0
return value may mean a successful call returning a valid value 0, as
well as an error condition; in the case of a 0 return value one should
call <I>WinGetLastError()</I> <FONT SIZE="-1">API</FONT> to distinguish a successful call from a
failing one.


<P>


By convention, all the calls to <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT> should indicate their
failures by resetting $^E.  All the Perl-accessible functions which
call <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT> may be broken into two classes: some <I>die()</I>s when an <FONT SIZE="-1">API</FONT>
error is encountered, the other report the error via a false return
value (of course, this does not concern Perl-accessible functions
which <I>expect</I> a failure of the <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT> call, having some workarounds
coded).


<P>


Obviously, in the situation of the last type of the signature of an <FONT SIZE="-1">OS/2</FONT>
<FONT SIZE="-1">API</FONT>, it is must more convenient for the users if the failure is
indicated by <I>die()</I>ing: one does not need to check $^E to know that
something went wrong.  If, however, this solution is not desirable by
some reason, the code in question should reset $^E to 0 before making
this <FONT SIZE="-1">OS/2</FONT> <FONT SIZE="-1">API</FONT> call, so that the caller of this Perl-accessible
function has a chance to distinguish a success-but-0-return value from
a failure.  (One may return undef as an alternative way of reporting
an error.)


<P>


The macros to simplify this type of error propagation are
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>CheckOSError(expr)<DD>


<A NAME="ixAFF"></A>
Returns true on error, sets $^E.  Expects <I>expr()</I> be a call of
<TT>&quot;Dos*&quot;</TT>-style <FONT SIZE="-1">API</FONT>.
<DT>CheckWinError(expr)<DD>


<A NAME="ixAFG"></A>
Returns true on error, sets $^E.  Expects <I>expr()</I> be a call of
<TT>&quot;Win*&quot;</TT>-style <FONT SIZE="-1">API</FONT>.
<DT>SaveWinError(expr)<DD>


<A NAME="ixAFH"></A>
Returns <TT>&quot;expr&quot;</TT>, sets $^E from <I>WinGetLastError()</I> if <TT>&quot;expr&quot;</TT> is false.
<DT>SaveCroakWinError(expr,die,name1,name2)<DD>


<A NAME="ixAFI"></A>
Returns <TT>&quot;expr&quot;</TT>, sets $^E from <I>WinGetLastError()</I> if <TT>&quot;expr&quot;</TT> is false,
and <I>die()</I>s if <TT>&quot;die&quot;</TT> and $^E are true.  The message to die is the
concatenated strings <TT>&quot;name1&quot;</TT> and <TT>&quot;name2&quot;</TT>, separated by <TT>&quot;: &quot;</TT> from
the contents of $^E.
<DT>WinError_2_Perl_rc<DD>


<A NAME="ixAFJ"></A>
Sets <TT>&quot;Perl_rc&quot;</TT> to the return value of <I>WinGetLastError()</I>.
<DT>FillWinError<DD>


<A NAME="ixAFK"></A>
Sets <TT>&quot;Perl_rc&quot;</TT> to the return value of <I>WinGetLastError()</I>, and sets $^E
to the corresponding value.
<DT>FillOSError(rc)<DD>


<A NAME="ixAFL"></A>
Sets <TT>&quot;Perl_rc&quot;</TT> to <TT>&quot;rc&quot;</TT>, and sets $^E to the corresponding value.
</DL>
</DL>

<DL COMPACT><DT><DD>
</DL>

<DT>* Loading DLLs and ordinals in DLLs<DD>
<A NAME="ixAFM"></A>
Some DLLs are only present in some versions of <FONT SIZE="-1">OS/2</FONT>, or in some
configurations of <FONT SIZE="-1">OS/2</FONT>.  Some exported entry points are present only
in DLLs shipped with some versions of <FONT SIZE="-1">OS/2</FONT>.  If these DLLs and entry
points were linked directly for a Perl executable/DLL or from a Perl
extensions, this binary would work only with the specified
versions/setups.  Even if these entry points were not needed, the
<I>load</I> of the executable (or <FONT SIZE="-1">DLL</FONT>) would fail.


<P>


For example, many newer useful APIs are not present in <FONT SIZE="-1">OS/2</FONT> v2; many
PM-related APIs require DLLs not available on floppy-boot setup.


<P>


To make these calls fail <I>only when the calls are executed</I>, one
should call these <FONT SIZE="-1">API</FONT> via a dynamic linking <FONT SIZE="-1">API</FONT>.  There is a subsystem
in Perl to simplify such type of calls.  A large number of entry
points available for such linking is provided (see <TT>&quot;entries_ordinals&quot;</TT>
- and also <TT>&quot;PMWIN_entries&quot;</TT> - in <I>os2ish.h</I>).  These ordinals can be
accessed via the APIs:


<P>




<PRE>
  CallORD(), DeclFuncByORD(), DeclVoidFuncByORD(),
  DeclOSFuncByORD(), DeclWinFuncByORD(), AssignFuncPByORD(),
  DeclWinFuncByORD_CACHE(), DeclWinFuncByORD_CACHE_survive(),
  DeclWinFuncByORD_CACHE_resetError_survive(),
  DeclWinFunc_CACHE(), DeclWinFunc_CACHE_resetError(),
  DeclWinFunc_CACHE_survive(), DeclWinFunc_CACHE_resetError_survive()

</PRE>




<P>


See the header files and the C code in the supplied OS/2-related
modules for the details on usage of these functions.


<P>


Some of these functions also combine dynaloading semantic with the
error-propagation semantic discussed above.
</DL>
<A NAME="lbCI">&nbsp;</A>
<H2>Perl flavors</H2>

<A NAME="ixAFN"></A>
Because of idiosyncrasies of <FONT SIZE="-1">OS/2</FONT> one cannot have all the eggs in the
same basket (though <FONT SIZE="-1">EMX</FONT> environment tries hard to overcome this
limitations, so the situation may somehow improve). There are 4
executables for Perl provided by the distribution:
<A NAME="lbCJ">&nbsp;</A>
<H2><I>perl.exe</I></H2>

<A NAME="ixAFO"></A>
The main workhorse. This is a chimera executable: it is compiled as an
<TT>&quot;a.out&quot;</TT>-style executable, but is linked with <TT>&quot;omf&quot;</TT>-style dynamic
library <I>perl.dll</I>, and with dynamic <FONT SIZE="-1">CRT</FONT> <FONT SIZE="-1">DLL</FONT>. This executable is a
<FONT SIZE="-1">VIO</FONT> application.
<P>

It can load perl dynamic extensions, and it can <I>fork()</I>.
<P>

<B>Note.</B> Keep in mind that <I>fork()</I> is needed to open a pipe to yourself.
<A NAME="lbCK">&nbsp;</A>
<H2><I>perl_.exe</I></H2>

<A NAME="ixAFP"></A>
This is a statically linked <TT>&quot;a.out&quot;</TT>-style executable. It cannot
load dynamic Perl extensions. The executable supplied in binary
distributions has a lot of extensions prebuilt, thus the above restriction is 
important only if you use custom-built extensions. This executable is a <FONT SIZE="-1">VIO</FONT>
application.
<P>

<I>This is the only executable with does not require </I><FONT SIZE="-1"><I>OS/2</I></FONT><I>.</I> The
friends locked into <TT>&quot;M$&quot;</TT> world would appreciate the fact that this
executable runs under <FONT SIZE="-1">DOS</FONT>, Win0.3*, Win0.95 and WinNT with an
appropriate extender. See ``Other OSes''.
<A NAME="lbCL">&nbsp;</A>
<H2><I>perl__.exe</I></H2>

<A NAME="ixAFQ"></A>
This is the same executable as <I>perl___.exe</I>, but it is a <FONT SIZE="-1">PM</FONT>
application. 
<P>

<B>Note.</B> Usually (unless explicitly redirected during the startup)
<FONT SIZE="-1">STDIN</FONT>, <FONT SIZE="-1">STDERR</FONT>, and <FONT SIZE="-1">STDOUT</FONT> of a <FONT SIZE="-1">PM</FONT>
application are redirected to <I>nul</I>. However, it is possible to <I>see</I>
them if you start <TT>&quot;perl__.exe&quot;</TT> from a <FONT SIZE="-1">PM</FONT> program which emulates a
console window, like <I>Shell mode</I> of Emacs or <FONT SIZE="-1">EPM</FONT>. Thus it <I>is
possible</I> to use Perl debugger (see perldebug) to debug your <FONT SIZE="-1">PM</FONT>
application (but beware of the message loop lockups - this will not
work if you have a message queue to serve, unless you hook the serving
into the <I>getc()</I> function of the debugger).
<P>

Another way to see the output of a <FONT SIZE="-1">PM</FONT> program is to run it as
<P>



<PRE>
  pm_prog args 2&gt;&amp;1 | cat -

</PRE>


<P>

with a shell <I>different</I> from <I>cmd.exe</I>, so that it does not create
a link between a <FONT SIZE="-1">VIO</FONT> session and the session of <TT>&quot;pm_porg&quot;</TT>.  (Such a link
closes the <FONT SIZE="-1">VIO</FONT> window.)  E.g., this works with <I>sh.exe</I> - or with Perl!
<P>



<PRE>
  open P, 'pm_prog args 2&gt;&amp;1 |' or die;
  print while &lt;P&gt;;

</PRE>


<P>

The flavor <I>perl__.exe</I> is required if you want to start your program without
a <FONT SIZE="-1">VIO</FONT> window present, but not <TT>&quot;detach&quot;</TT>ed (run <TT>&quot;help detach&quot;</TT> for more info).
Very useful for extensions which use <FONT SIZE="-1">PM</FONT>, like <TT>&quot;Perl/Tk&quot;</TT> or <TT>&quot;OpenGL&quot;</TT>.
<P>

Note also that the differences between <FONT SIZE="-1">PM</FONT> and <FONT SIZE="-1">VIO</FONT> executables are only
in the <I>default</I> behaviour.  One can start <I>any</I> executable in
<I>any</I> kind of session by using the arguments <TT>&quot;/fs&quot;</TT>, <TT>&quot;/pm&quot;</TT> or
<TT>&quot;/win&quot;</TT> switches of the command <TT>&quot;start&quot;</TT> (of <I></I><FONT SIZE="-1"><I>CMD</I></FONT><I>.EXE</I> or a similar
shell).  Alternatively, one can use the numeric first argument of the
<TT>&quot;system&quot;</TT> Perl function (see <TT>&quot;OS2::Process&quot;</TT>).
<A NAME="lbCM">&nbsp;</A>
<H2><I>perl___.exe</I></H2>

<A NAME="ixAFR"></A>
This is an <TT>&quot;omf&quot;</TT>-style executable which is dynamically linked to
<I>perl.dll</I> and <FONT SIZE="-1">CRT</FONT> <FONT SIZE="-1">DLL</FONT>. I know no advantages of this executable
over <TT>&quot;perl.exe&quot;</TT>, but it cannot <I>fork()</I> at all. Well, one advantage is
that the build process is not so convoluted as with <TT>&quot;perl.exe&quot;</TT>.
<P>

It is a <FONT SIZE="-1">VIO</FONT> application.
<A NAME="lbCN">&nbsp;</A>
<H2>Why strange names?</H2>

<A NAME="ixAFS"></A>
Since Perl processes the <TT>&quot;#!&quot;</TT>-line (cf. 
``<FONT SIZE="-1">DESCRIPTION</FONT>'' in perlrun, ``Switches'' in perlrun,
``Not a perl script'' in perldiag, 
``No Perl script found in input'' in perldiag), it should know when a
program <I>is a Perl</I>. There is some naming convention which allows
Perl to distinguish correct lines from wrong ones. The above names are
almost the only names allowed by this convention which do not contain
digits (which have absolutely different semantics).
<A NAME="lbCO">&nbsp;</A>
<H2>Why dynamic linking?</H2>

<A NAME="ixAFT"></A>
Well, having several executables dynamically linked to the same huge
library has its advantages, but this would not substantiate the
additional work to make it compile. The reason is the complicated-to-developers
but very quick and convenient-to-users ``hard'' dynamic linking used by <FONT SIZE="-1">OS/2</FONT>.
<P>

There are two distinctive features of the dyna-linking model of <FONT SIZE="-1">OS/2:</FONT>
first, all the references to external functions are resolved at the compile time;
second, there is no runtime fixup of the DLLs after they are loaded into memory.
The first feature is an enormous advantage over other models: it avoids
conflicts when several DLLs used by an application export entries with
the same name.  In such cases ``other'' models of dyna-linking just choose
between these two entry points using some random criterion - with predictable
disasters as results.  But it is the second feature which requires the build
of <I>perl.dll</I>.
<P>

The address tables of DLLs are patched only once, when they are
loaded. The addresses of the entry points into DLLs are guaranteed to be
the same for all the programs which use the same <FONT SIZE="-1">DLL</FONT>.  This removes the
runtime fixup - once <FONT SIZE="-1">DLL</FONT> is loaded, its code is read-only.
<P>

While this allows some (significant?) performance advantages, this makes life
much harder for developers, since the above scheme makes it impossible
for a <FONT SIZE="-1">DLL</FONT> to be ``linked'' to a symbol in the <I>.EXE</I> file.  Indeed, this
would need a <FONT SIZE="-1">DLL</FONT> to have different relocations tables for the
(different) executables which use this <FONT SIZE="-1">DLL</FONT>.
<P>

However, a dynamically loaded Perl extension is forced to use some symbols
from the perl
executable, e.g., to know how to find the arguments to the functions:
the arguments live on the perl
internal evaluation stack. The solution is to put the main code of
the interpreter into a <FONT SIZE="-1">DLL</FONT>, and make the <I>.EXE</I> file which just loads
this <FONT SIZE="-1">DLL</FONT> into memory and supplies command-arguments.  The extension <FONT SIZE="-1">DLL</FONT>
cannot link to symbols in <I>.EXE</I>, but it has no problem linking
to symbols in the <I>.DLL</I>.
<P>

This <I>greatly</I> increases the load time for the application (as well as
complexity of the compilation). Since interpreter is in a <FONT SIZE="-1">DLL</FONT>,
the C <FONT SIZE="-1">RTL</FONT> is basically forced to reside in a <FONT SIZE="-1">DLL</FONT> as well (otherwise
extensions would not be able to use <FONT SIZE="-1">CRT</FONT>).  There are some advantages if
you use different flavors of perl, such as running <I>perl.exe</I> and
<I>perl__.exe</I> simultaneously: they share the memory of <I>perl.dll</I>.
<P>

<B></B><FONT SIZE="-1"><B>NOTE</B></FONT><B></B>.  There is one additional effect which makes DLLs more wasteful:
DLLs are loaded in the shared memory region, which is a scarse resource
given the 512M barrier of the ``standard'' <FONT SIZE="-1">OS/2</FONT> virtual memory.  The code of
<I>.EXE</I> files is also shared by all the processes which use the particular
<I>.EXE</I>, but they are ``shared in the private address space of the process'';
this is possible because the address at which different sections
of the <I>.EXE</I> file are loaded is decided at compile-time, thus all the
processes have these sections loaded at same addresses, and no fixup
of internal links inside the <I>.EXE</I> is needed.
<P>

Since DLLs may be loaded at run time, to have the same mechanism for DLLs
one needs to have the address range of <I>any of the loaded</I> DLLs in the
system to be available <I>in all the processes</I> which did not load a particular
<FONT SIZE="-1">DLL</FONT> yet.  This is why the DLLs are mapped to the shared memory region.
<A NAME="lbCP">&nbsp;</A>
<H2>Why chimera build?</H2>

<A NAME="ixAFU"></A>
Current <FONT SIZE="-1">EMX</FONT> environment does not allow DLLs compiled using Unixish
<TT>&quot;a.out&quot;</TT> format to export symbols for data (or at least some types of
data). This forces <TT>&quot;omf&quot;</TT>-style compile of <I>perl.dll</I>.
<P>

Current <FONT SIZE="-1">EMX</FONT> environment does not allow <I>.EXE</I> files compiled in
<TT>&quot;omf&quot;</TT> format to <I>fork()</I>. <I>fork()</I> is needed for exactly three Perl
operations:
<DL COMPACT>
<DT>*<DD>
explicit <I>fork()</I> in the script, 
<DT>*<DD>
<TT>&quot;open FH, &quot;|-&quot;&quot;</TT>
<DT>*<DD>
<TT>&quot;open FH, &quot;-|&quot;&quot;</TT>, in other words, opening pipes to itself.
</DL>
<P>

While these operations are not questions of life and death, they are
needed for a lot of
useful scripts. This forces <TT>&quot;a.out&quot;</TT>-style compile of
<I>perl.exe</I>.
<A NAME="lbCQ">&nbsp;</A>
<H2>ENVIRONMENT</H2>

<A NAME="ixAFV"></A>
Here we list environment variables with are either <FONT SIZE="-1">OS/2-</FONT> and <FONT SIZE="-1">DOS-</FONT> and
Win*-specific, or are more important under <FONT SIZE="-1">OS/2</FONT> than under other OSes.
<A NAME="lbCR">&nbsp;</A>
<H2>PERLLIB_PREFIX</H2>



<A NAME="ixAFW"></A>
Specific for <FONT SIZE="-1">EMX</FONT> port. Should have the form
<P>



<PRE>
  path1;path2

</PRE>


<P>

or
<P>



<PRE>
  path1 path2

</PRE>


<P>

If the beginning of some prebuilt path matches <I>path1</I>, it is
substituted with <I>path2</I>.
<P>

Should be used if the perl library is moved from the default
location in preference to <TT>&quot;<A HREF="../man5/PERL.5.php">PERL</A>(5)LIB&quot;</TT>, since this would not leave wrong
entries in <TT>@INC</TT>.  For example, if the compiled version of perl looks for <TT>@INC</TT>
in <I>f:/perllib/lib</I>, and you want to install the library in
<I>h:/opt/gnu</I>, do
<P>



<PRE>
  set PERLLIB_PREFIX=f:/perllib/lib;h:/opt/gnu

</PRE>


<P>

This will cause Perl with the prebuilt <TT>@INC</TT> of
<P>



<PRE>
  f:/perllib/lib/5.00553/os2
  f:/perllib/lib/5.00553
  f:/perllib/lib/site_perl/5.00553/os2
  f:/perllib/lib/site_perl/5.00553
  .

</PRE>


<P>

to use the following <TT>@INC:</TT>
<P>



<PRE>
  h:/opt/gnu/5.00553/os2
  h:/opt/gnu/5.00553
  h:/opt/gnu/site_perl/5.00553/os2
  h:/opt/gnu/site_perl/5.00553
  .

</PRE>


<A NAME="lbCS">&nbsp;</A>
<H2>PERL_BADLANG</H2>



<A NAME="ixAFX"></A>
If 0, perl ignores <I>setlocale()</I> failing. May be useful with some
strange <I>locale</I>s.
<A NAME="lbCT">&nbsp;</A>
<H2>PERL_BADFREE</H2>



<A NAME="ixAFY"></A>
If 0, perl would not warn of in case of unwarranted <I>free()</I>. With older
perls this might be
useful in conjunction with the module DB_File, which was buggy when
dynamically linked and OMF-built.
<P>

Should not be set with newer Perls, since this may hide some <I>real</I> problems.
<A NAME="lbCU">&nbsp;</A>
<H2>PERL_SH_DIR</H2>



<A NAME="ixAFZ"></A>
Specific for <FONT SIZE="-1">EMX</FONT> port. Gives the directory part of the location for
<I>sh.exe</I>.
<A NAME="lbCV">&nbsp;</A>
<H2>USE_PERL_FLOCK</H2>



<A NAME="ixAGA"></A>
Specific for <FONT SIZE="-1">EMX</FONT> port. Since <I><A HREF="../man3/flock.3.php">flock</A></I>(3) is present in <FONT SIZE="-1">EMX</FONT>, but is not 
functional, it is emulated by perl.  To disable the emulations, set 
environment variable <TT>&quot;USE_PERL_FLOCK=0&quot;</TT>.
<A NAME="lbCW">&nbsp;</A>
<H2>TMP</TT> or <TT>TEMP</H2>



<A NAME="ixAGB"></A>
Specific for </TT><FONT SIZE="-1"><TT>EMX</TT></FONT><TT> port. Used as storage place for temporary files.
</TT><A NAME="lbCX">&nbsp;</A>
<H2>Evolution</H2>

<A NAME="ixAGC"></A>
Here we list major changes which could make you by surprise.
<A NAME="lbCY">&nbsp;</A>
<H2>Text-mode filehandles</H2>

<A NAME="ixAGD"></A>
Starting from version 5.8, Perl uses a builtin translation layer for
text-mode files.  This replaces the efficient well-tested <FONT SIZE="-1">EMX</FONT> layer by
some code which should be best characterized as a ``quick hack''.
<P>

In addition to possible bugs and an inability to follow changes to the
translation policy with off/on switches of <FONT SIZE="-1">TERMIO</FONT> translation, this
introduces a serious incompatible change: before <I>sysread()</I> on
text-mode filehandles would go through the translation layer, now it
would not.
<A NAME="lbCZ">&nbsp;</A>
<H2>Priorities</H2>

<A NAME="ixAGE"></A>
<TT>&quot;setpriority&quot;</TT> and <TT>&quot;getpriority&quot;</TT> are not compatible with earlier
ports by Andreas Kaiser. See <TT>&quot;setpriority, getpriority&quot;</TT>.
<A NAME="lbDA">&nbsp;</A>
<H2><FONT SIZE="-1">DLL</FONT> name mangling: pre 5.6.2</H2>

<A NAME="ixAGF"></A>
With the release 5.003_01 the dynamically loadable libraries
should be rebuilt when a different version of Perl is compiled. In particular,
DLLs (including <I>perl.dll</I>) are now created with the names
which contain a checksum, thus allowing workaround for <FONT SIZE="-1">OS/2</FONT> scheme of
caching DLLs.
<P>

It may be possible to code a simple workaround which would 
<DL COMPACT>
<DT>*<DD>
find the old DLLs looking through the old <TT>@INC</TT>;
<DT>*<DD>
mangle the names according to the scheme of new perl and copy the DLLs to
these names;
<DT>*<DD>
edit the internal <TT>&quot;LX&quot;</TT> tables of <FONT SIZE="-1">DLL</FONT> to reflect the change of the name
(probably not needed for Perl extension DLLs, since the internally coded names
are not used for ``specific'' DLLs, they used only for ``global'' DLLs).
<DT>*<DD>
edit the internal <TT>&quot;IMPORT&quot;</TT> tables and change the name of the ``old''
<I>perl????.dll</I> to the ``new'' <I>perl????.dll</I>.
</DL>
<A NAME="lbDB">&nbsp;</A>
<H2><FONT SIZE="-1">DLL</FONT> name mangling: 5.6.2 and beyond</H2>

<A NAME="ixAGG"></A>
In fact mangling of <I>extension</I> DLLs was done due to misunderstanding
of the <FONT SIZE="-1">OS/2</FONT> dynaloading model.  <FONT SIZE="-1">OS/2</FONT> (effectively) maintains two
different tables of loaded <FONT SIZE="-1">DLL:</FONT>
<DL COMPACT>
<DT>Global DLLs<DD>
<A NAME="ixAGH"></A>
those loaded by the base name from <TT>&quot;LIBPATH&quot;</TT>; including those
associated at link time;
<DT>specific DLLs<DD>
<A NAME="ixAGI"></A>
loaded by the full name.
</DL>
<P>

When resolving a request for a global <FONT SIZE="-1">DLL</FONT>, the table of already-loaded
specific DLLs is (effectively) ignored; moreover, specific DLLs are
<I>always</I> loaded from the prescribed path.
<P>

There is/was a minor twist which makes this scheme fragile: what to do
with DLLs loaded from
<DL COMPACT>
<DT>BEGINLIBPATH and <TT>ENDLIBPATH<DD>


<A NAME="ixAGJ"></A>
(which depend on the process)
<DT></TT><I>.</I> from LIBPATH<DD>


<A NAME="ixAGK"></A>
which <I>effectively</I> depends on the process (although <TT>&quot;LIBPATH&quot;</TT> is the
same for all the processes).
</DL>
<P>

Unless <TT>&quot;LIBPATHSTRICT&quot;</TT> is set to <TT>&quot;T&quot;</TT> (and the kernel is after
2000/09/01), such DLLs are considered to be global.  When loading a
global <FONT SIZE="-1">DLL</FONT> it is first looked in the table of already-loaded global
DLLs.  Because of this the fact that one executable loaded a <FONT SIZE="-1">DLL</FONT> from
<TT>&quot;BEGINLIBPATH&quot;</TT> and <TT>&quot;ENDLIBPATH&quot;</TT>, or <I>.</I> from <TT>&quot;LIBPATH&quot;</TT> may affect
<I>which</I> <FONT SIZE="-1">DLL</FONT> is loaded when <I>another</I> executable requests a <FONT SIZE="-1">DLL</FONT> with
the same name.  <I>This</I> is the reason for version-specific mangling of
the <FONT SIZE="-1">DLL</FONT> name for perl <FONT SIZE="-1">DLL</FONT>.
<P>

Since the Perl extension DLLs are always loaded with the full path,
there is no need to mangle their names in a version-specific ways:
their directory already reflects the corresponding version of perl,
and <TT>@INC</TT> takes into account binary compatibility with older version.
Starting from <TT>5.6.2</TT> the name mangling scheme is fixed to be the
same as for Perl 5.005_53 (same as in a popular binary release).  Thus
new Perls will be able to <I>resolve the names</I> of old extension DLLs
if <TT>@INC</TT> allows finding their directories.
<P>

However, this still does not guarantee that these <FONT SIZE="-1">DLL</FONT> may be loaded.
The reason is the mangling of the name of the <I>Perl </I><FONT SIZE="-1"><I>DLL</I></FONT><I></I>.  And since
the extension DLLs link with the Perl <FONT SIZE="-1">DLL</FONT>, extension DLLs for older
versions would load an older Perl <FONT SIZE="-1">DLL</FONT>, and would most probably
segfault (since the data in this <FONT SIZE="-1">DLL</FONT> is not properly initialized).
<P>

There is a partial workaround (which can be made complete with newer
<FONT SIZE="-1">OS/2</FONT> kernels): create a forwarder <FONT SIZE="-1">DLL</FONT> with the same name as the <FONT SIZE="-1">DLL</FONT> of
the older version of Perl, which forwards the entry points to the
newer Perl's <FONT SIZE="-1">DLL</FONT>.  Make this <FONT SIZE="-1">DLL</FONT> accessible on (say) the <TT>&quot;BEGINLIBPATH&quot;</TT> of
the new Perl executable.  When the new executable accesses old Perl's
extension DLLs, they would request the old Perl's <FONT SIZE="-1">DLL</FONT> by name, get the
forwarder instead, so effectively will link with the currently running
(new) Perl <FONT SIZE="-1">DLL</FONT>.
<P>

This may break in two ways:
<DL COMPACT>
<DT>*<DD>
Old perl executable is started when a new executable is running has
loaded an extension compiled for the old executable (ouph!).  In this
case the old executable will get a forwarder <FONT SIZE="-1">DLL</FONT> instead of the old
perl <FONT SIZE="-1">DLL</FONT>, so would link with the new perl <FONT SIZE="-1">DLL</FONT>.  While not directly
fatal, it will behave the same as new executable.  This beats the whole
purpose of explicitly starting an old executable.
<DT>*<DD>
A new executable loads an extension compiled for the old executable
when an old perl executable is running.  In this case the extension
will not pick up the forwarder - with fatal results.
</DL>
<P>

With support for <TT>&quot;LIBPATHSTRICT&quot;</TT> this may be circumvented - unless
one of DLLs is started from <I>.</I> from <TT>&quot;LIBPATH&quot;</TT> (I do not know
whether <TT>&quot;LIBPATHSTRICT&quot;</TT> affects this case).
<P>

<B></B><FONT SIZE="-1"><B>REMARK</B></FONT><B></B>.  Unless newer kernels allow <I>.</I> in <TT>&quot;BEGINLIBPATH&quot;</TT> (older
do not), this mess cannot be completely cleaned.  (It turns out that
as of the beginning of 2002, <I>.</I> is not allowed, but <I>.\.</I> is - and
it has the same effect.)
<P>

<B></B><FONT SIZE="-1"><B>REMARK</B></FONT><B></B>.  <TT>&quot;LIBPATHSTRICT&quot;</TT>, <TT>&quot;BEGINLIBPATH&quot;</TT> and <TT>&quot;ENDLIBPATH&quot;</TT> are
not environment variables, although <I>cmd.exe</I> emulates them on <TT>&quot;SET
...&quot;</TT> lines.  From Perl they may be accessed by Cwd::extLibpath and
Cwd::extLibpath_set.
<A NAME="lbDC">&nbsp;</A>
<H2><FONT SIZE="-1">DLL</FONT> forwarder generation</H2>

<A NAME="ixAGL"></A>
Assume that the old <FONT SIZE="-1">DLL</FONT> is named <I>perlE0AC.dll</I> (as is one for
5.005_53), and the new version is 5.6.1.  Create a file
<I>perl5shim.def-leader</I> with
<P>



<PRE>
  LIBRARY 'perlE0AC' INITINSTANCE TERMINSTANCE
  DESCRIPTION '@#<A HREF="mailto:perl5-porters@perl.org">perl5-porters@perl.org</A>:5.006001#@ Perl module for 5.00553 -&gt; Perl 5.6.1 forwarder'
  CODE LOADONCALL
  DATA LOADONCALL NONSHARED MULTIPLE
  EXPORTS

</PRE>


<P>

modifying the versions/names as needed.  Run
<P>



<PRE>
 perl -wnle &quot;next if 0../EXPORTS/; print qq(  \&quot;$1\&quot;) if /\&quot;(\w+)\&quot;/&quot; perl5.def &gt;lst

</PRE>


<P>

in the Perl build directory (to make the <FONT SIZE="-1">DLL</FONT> smaller replace perl5.def
with the definition file for the older version of Perl if present).
<P>



<PRE>
 cat perl5shim.def-leader lst &gt;perl5shim.def
 gcc -Zomf -Zdll -o perlE0AC.dll perl5shim.def -s -llibperl

</PRE>


<P>

(ignore multiple <TT>&quot;warning L4085&quot;</TT>).
<A NAME="lbDD">&nbsp;</A>
<H2>Threading</H2>

<A NAME="ixAGM"></A>
As of release 5.003_01 perl is linked to multithreaded C <FONT SIZE="-1">RTL</FONT>
<FONT SIZE="-1">DLL</FONT>.  If perl itself is not compiled multithread-enabled, so will not be perl's
<I>malloc()</I>. However, extensions may use multiple thread on their own
risk. 
<P>

This was needed to compile <TT>&quot;Perl/Tk&quot;</TT> for XFree86-OS/2 out-of-the-box, and
link with DLLs for other useful libraries, which typically are compiled
with <TT>&quot;-Zmt -Zcrtdll&quot;</TT>.
<A NAME="lbDE">&nbsp;</A>
<H2>Calls to external programs</H2>

<A NAME="ixAGN"></A>
Due to a popular demand the perl external program calling has been
changed wrt Andreas Kaiser's port.  <I>If</I> perl needs to call an
external program <I>via shell</I>, the <I>f:/bin/sh.exe</I> will be called, or
whatever is the override, see ``<FONT SIZE="-1">PERL_SH_DIR</FONT>''.
<P>

Thus means that you need to get some copy of a <I>sh.exe</I> as well (I
use one from pdksh). The path <I>F:/bin</I> above is set up automatically during
the build to a correct value on the builder machine, but is
overridable at runtime,
<P>

<B>Reasons:</B> a consensus on <TT>&quot;perl5-porters&quot;</TT> was that perl should use
one non-overridable shell per platform. The obvious choices for <FONT SIZE="-1">OS/2</FONT>
are <I>cmd.exe</I> and <I>sh.exe</I>. Having perl build itself would be impossible
with <I>cmd.exe</I> as a shell, thus I picked up <TT>&quot;sh.exe&quot;</TT>. This assures almost
100% compatibility with the scripts coming from *nix. As an added benefit 
this works as well under <FONT SIZE="-1">DOS</FONT> if you use DOS-enabled port of pdksh 
(see ``Prerequisites'').
<P>

<B>Disadvantages:</B> currently <I>sh.exe</I> of pdksh calls external programs
via <I>fork()</I>/<I>exec()</I>, and there is <I>no</I> functioning <I>exec()</I> on
<FONT SIZE="-1">OS/2</FONT>. <I>exec()</I> is emulated by <FONT SIZE="-1">EMX</FONT> by an asynchronous call while the caller
waits for child completion (to pretend that the <TT>&quot;pid&quot;</TT> did not change). This
means that 1 <I>extra</I> copy of <I>sh.exe</I> is made active via <I>fork()</I>/<I>exec()</I>,
which may lead to some resources taken from the system (even if we do
not count extra work needed for <I>fork()</I>ing).
<P>

Note that this a lesser issue now when we do not spawn <I>sh.exe</I>
unless needed (metachars found).
<P>

One can always start <I>cmd.exe</I> explicitly via
<P>



<PRE>
  system 'cmd', '/c', 'mycmd', 'arg1', 'arg2', ...

</PRE>


<P>

If you need to use <I>cmd.exe</I>, and do not want to hand-edit thousands of your
scripts, the long-term solution proposed on p5-p is to have a directive
<P>



<PRE>
  use OS2::Cmd;

</PRE>


<P>

which will override <I>system()</I>, <I>exec()</I>, <TT>``</TT>, and
<TT>&quot;open(,'...|')&quot;</TT>. With current perl you may override only <I>system()</I>,
<I>readpipe()</I> - the explicit version of <TT>``</TT>, and maybe <I>exec()</I>. The code
will substitute the one-argument call to <I>system()</I> by
<TT>&quot;CORE::system('cmd.exe', '/c', shift)&quot;</TT>.
<P>

If you have some working code for <TT>&quot;OS2::Cmd&quot;</TT>, please send it to me,
I will include it into distribution. I have no need for such a module, so
cannot test it.
<P>

For the details of the current situation with calling external programs,
see ``2 (and <FONT SIZE="-1">DOS</FONT>) programs under Perl'' in Starting <FONT SIZE="-1">OS</FONT>.  Set us mention a couple
of features:
<DL COMPACT>
<DT>*<DD>
External scripts may be called by their basename.  Perl will try the same
extensions as when processing <B>-S</B> command-line switch.
<DT>*<DD>
External scripts starting with <TT>&quot;#!&quot;</TT> or <TT>&quot;extproc &quot;</TT> will be executed directly,
without calling the shell, by calling the program specified on the rest of
the first line.
</DL>
<A NAME="lbDF">&nbsp;</A>
<H2>Memory allocation</H2>

<A NAME="ixAGO"></A>
Perl uses its own <I>malloc()</I> under <FONT SIZE="-1">OS/2</FONT> - interpreters are usually malloc-bound
for speed, but perl is not, since its malloc is lightning-fast.
Perl-memory-usage-tuned benchmarks show that Perl's malloc is 5 times quicker
than <FONT SIZE="-1">EMX</FONT> one.  I do not have convincing data about memory footprint, but
a (pretty random) benchmark showed that Perl's one is 5% better.
<P>

Combination of perl's <I>malloc()</I> and rigid <FONT SIZE="-1">DLL</FONT> name resolution creates
a special problem with library functions which expect their return value to
be <I>free()</I>d by system's <I>free()</I>. To facilitate extensions which need to call 
such functions, system memory-allocation functions are still available with
the prefix <TT>&quot;emx_&quot;</TT> added. (Currently only <FONT SIZE="-1">DLL</FONT> perl has this, it should 
propagate to <I>perl_.exe</I> shortly.)
<A NAME="lbDG">&nbsp;</A>
<H2>Threads</H2>

<A NAME="ixAGP"></A>
One can build perl with thread support enabled by providing <TT>&quot;-D usethreads&quot;</TT>
option to <I>Configure</I>.  Currently <FONT SIZE="-1">OS/2</FONT> support of threads is very 
preliminary.
<P>

Most notable problems: 
<DL COMPACT>
<DT>COND_WAIT<DD>


<A NAME="ixAGQ"></A>
may have a race condition (but probably does not due to edge-triggered
nature of <FONT SIZE="-1">OS/2</FONT> Event semaphores).  (Needs a reimplementation (in terms of chaining
waiting threads, with the linked list stored in per-thread structure?)?)
<DT><I>os2.c</I><DD>
<A NAME="ixAGR"></A>
has a couple of static variables used in OS/2-specific functions.  (Need to be
moved to per-thread structure, or serialized?)
</DL>
<P>

Note that these problems should not discourage experimenting, since they
have a low probability of affecting small programs.
<A NAME="lbDH">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAGS"></A>
This description is not updated often (since 5.6.1?), see <I>./os2/Changes</I>
(perlos2delta) for more info.
<A NAME="lbDI">&nbsp;</A>
<H2>AUTHOR</H2>

<A NAME="ixAGT"></A>
Ilya Zakharevich, <A HREF="mailto:cpan@ilyaz.org">cpan@ilyaz.org</A>
<A NAME="lbDJ">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAGU"></A>
<I><A HREF="../man1/perl.1.php">perl</A></I>(1).
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">Target</A><DD>
<DT><A HREF="#lbAF">Other OSes</A><DD>
<DT><A HREF="#lbAG">Prerequisites</A><DD>
<DT><A HREF="#lbAH">Starting Perl programs under <FONT SIZE="-1">OS/2</FONT> (and <FONT SIZE="-1">DOS</FONT> and...)</A><DD>
<DT><A HREF="#lbAI">Starting <FONT SIZE="-1">OS/2</FONT> (and <FONT SIZE="-1">DOS</FONT>) programs under Perl</A><DD>
<DT><A HREF="#lbAJ">Frequently asked questions</A><DD>
<DT><A HREF="#lbAK">It does not work</A><DD>
<DT><A HREF="#lbAL">I cannot run external programs</A><DD>
<DT><A HREF="#lbAM">I cannot embed perl into my program, or use <I>perl.dll</I> from my program.</A><DD>
<DT><A HREF="#lbAN">`` and pipe-<TT>open do not work under </TT><FONT SIZE="-1"><TT>DOS</TT></FONT><TT>.</A><DD>
<DT><A HREF="#lbAO">Cannot start find.exe pattern file</A><DD>
<DT><A HREF="#lbAP">INSTALLATION</A><DD>
<DT><A HREF="#lbAQ">Automatic binary installation</A><DD>
<DT><A HREF="#lbAR">Manual binary installation</A><DD>
<DT><A HREF="#lbAS"><B>Warning</B></A><DD>
<DT><A HREF="#lbAT">Accessing documentation</A><DD>
<DT><A HREF="#lbAU"><FONT SIZE="-1">OS/2</FONT> <I>.INF</I> file</A><DD>
<DT><A HREF="#lbAV">Plain text</A><DD>
<DT><A HREF="#lbAW">Manpages</A><DD>
<DT><A HREF="#lbAX"><FONT SIZE="-1">HTML</FONT></A><DD>
<DT><A HREF="#lbAY"><FONT SIZE="-1">GNU</FONT> info files</A><DD>
<DT><A HREF="#lbAZ"><I></I><FONT SIZE="-1"><I>PDF</I></FONT><I></I> files</A><DD>
<DT><A HREF="#lbBA">LaTeX docs</A><DD>
<DT><A HREF="#lbBB">BUILD</A><DD>
<DT><A HREF="#lbBC">The short story</A><DD>
<DT><A HREF="#lbBD">Prerequisites</A><DD>
<DT><A HREF="#lbBE">Getting perl source</A><DD>
<DT><A HREF="#lbBF">Application of the patches</A><DD>
<DT><A HREF="#lbBG">Hand-editing</A><DD>
<DT><A HREF="#lbBH">Making</A><DD>
<DT><A HREF="#lbBI">Testing</A><DD>
<DT><A HREF="#lbBJ">Installing the built perl</A><DD>
<DT><A HREF="#lbBK">a.out-style build</A><DD>
<DT><A HREF="#lbBL">Building a binary distribution</A><DD>
<DT><A HREF="#lbBM">Building custom <I>.EXE</I> files</A><DD>
<DT><A HREF="#lbBN">Making executables with a custom collection of statically loaded extensions</A><DD>
<DT><A HREF="#lbBO">Making executables with a custom search-paths</A><DD>
<DT><A HREF="#lbBP">Build FAQ</A><DD>
<DT><A HREF="#lbBQ">Some / became <TT>\ in pdksh.</A><DD>
<DT><A HREF="#lbBR">'errno' - unresolved external</A><DD>
<DT><A HREF="#lbBS">Problems with tr or sed</A><DD>
<DT><A HREF="#lbBT">Some problem (forget which ;-)</A><DD>
<DT><A HREF="#lbBU">Library ... not found</A><DD>
<DT><A HREF="#lbBV">Segfault in make</A><DD>
<DT><A HREF="#lbBW">op/sprintf test failure</A><DD>
<DT><A HREF="#lbBX">Specific (mis)features of OS/2 port</A><DD>
<DT><A HREF="#lbBY">setpriority, <TT>getpriority</A><DD>
<DT><A HREF="#lbBZ">system()</A><DD>
<DT><A HREF="#lbCA">extproc on the first line</A><DD>
<DT><A HREF="#lbCB">Additional modules:</A><DD>
<DT><A HREF="#lbCC">Prebuilt methods:</A><DD>
<DT><A HREF="#lbCD">Prebuilt variables:</A><DD>
<DT><A HREF="#lbCE">Misfeatures</A><DD>
<DT><A HREF="#lbCF">Modifications</A><DD>
<DT><A HREF="#lbCG">Identifying DLLs</A><DD>
<DT><A HREF="#lbCH">Centralized management of resources</A><DD>
<DT><A HREF="#lbCI">Perl flavors</A><DD>
<DT><A HREF="#lbCJ"><I>perl.exe</I></A><DD>
<DT><A HREF="#lbCK"><I>perl_.exe</I></A><DD>
<DT><A HREF="#lbCL"><I>perl__.exe</I></A><DD>
<DT><A HREF="#lbCM"><I>perl___.exe</I></A><DD>
<DT><A HREF="#lbCN">Why strange names?</A><DD>
<DT><A HREF="#lbCO">Why dynamic linking?</A><DD>
<DT><A HREF="#lbCP">Why chimera build?</A><DD>
<DT><A HREF="#lbCQ">ENVIRONMENT</A><DD>
<DT><A HREF="#lbCR">PERLLIB_PREFIX</A><DD>
<DT><A HREF="#lbCS">PERL_BADLANG</A><DD>
<DT><A HREF="#lbCT">PERL_BADFREE</A><DD>
<DT><A HREF="#lbCU">PERL_SH_DIR</A><DD>
<DT><A HREF="#lbCV">USE_PERL_FLOCK</A><DD>
<DT><A HREF="#lbCW">TMP or <TT>TEMP</A><DD>
<DT><A HREF="#lbCX">Evolution</A><DD>
<DT><A HREF="#lbCY">Text-mode filehandles</A><DD>
<DT><A HREF="#lbCZ">Priorities</A><DD>
<DT><A HREF="#lbDA"><FONT SIZE="-1">DLL</FONT> name mangling: pre 5.6.2</A><DD>
<DT><A HREF="#lbDB"><FONT SIZE="-1">DLL</FONT> name mangling: 5.6.2 and beyond</A><DD>
<DT><A HREF="#lbDC"><FONT SIZE="-1">DLL</FONT> forwarder generation</A><DD>
<DT><A HREF="#lbDD">Threading</A><DD>
<DT><A HREF="#lbDE">Calls to external programs</A><DD>
<DT><A HREF="#lbDF">Memory allocation</A><DD>
<DT><A HREF="#lbDG">Threads</A><DD>
<DT><A HREF="#lbDH">BUGS</A><DD>
<DT><A HREF="#lbDI">AUTHOR</A><DD>
<DT><A HREF="#lbDJ">SEE ALSO</A><DD>
</DL>

</div>






</div>




</body>
</html>
