
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>TEXT2PCAP</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="/global/main.css" title="default">
</head>

<body>



<div id="container">


<div id="content">

<div id='catHeader'><table width='100%'><tr><td>
<H1>TEXT2PCAP</H1>
Section: The Ethereal Network Analyzer (1)<BR>Updated: 2004-08-12<BR>
</td><td align='right' valign='bottom'><div class='ad_header_right'></div></td></tr></table></div></div>
<div id='categories'>
<div class='ad_man_right'>
</div>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

text2pcap - Generate a capture file from an ASCII hexdump of packets
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSYS</H2>

<A NAME="ixAAC"></A>
<B>text2pcap</B>
[&nbsp;<B>-h</B>&nbsp;]
[&nbsp;<B>-d</B>&nbsp;]
[&nbsp;<B>-q</B>&nbsp;]
[&nbsp;<B>-o</B>&nbsp;hex|oct&nbsp;]
[&nbsp;<B>-l</B>&nbsp;typenum&nbsp;]
[&nbsp;<B>-e</B>&nbsp;l3pid&nbsp;]
[&nbsp;<B>-i</B>&nbsp;proto&nbsp;]
[&nbsp;<B>-m</B>&nbsp;max-packet&nbsp;]
[&nbsp;<B>-u</B>&nbsp;srcport,destport&nbsp;]
[&nbsp;<B>-T</B>&nbsp;srcport,destport&nbsp;]
[&nbsp;<B>-s</B>&nbsp;srcport,destport,tag&nbsp;]
[&nbsp;<B>-S</B>&nbsp;srcport,destport,ppi&nbsp;]
[&nbsp;<B>-t</B>&nbsp;timefmt&nbsp;]
<I>infile</I>
<I>outfile</I>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
<B>Text2pcap</B> is a program that reads in an <FONT SIZE="-1">ASCII</FONT> hex dump and writes
the data described into a <B>libpcap</B>-style capture file. <B>text2pcap</B>
can read hexdumps with multiple packets in them, and build a capture
file of multiple packets. <B>text2pcap</B> is also capable of generating
dummy Ethernet, <FONT SIZE="-1">IP</FONT> and <FONT SIZE="-1">UDP</FONT> or <FONT SIZE="-1">TCP</FONT> headers, in order to build fully
processable packet dumps from hexdumps of application-level data
only. 
<P>

<B>Text2pcap</B> understands a hexdump of the form generated by <I>od -t
x1</I>. In other words, each byte is individually displayed and
surrounded with a space. Each line begins with an offset describing
the position in the file. The offset is a hex number (can also be
octal - see <B>-o</B>), of more than two hex digits. Here is a sample dump
that <B>text2pcap</B> can recognize:
<P>



<PRE>
    000000 00 e0 1e a7 05 6f 00 10 ........
    000008 5a a0 b9 12 08 00 46 00 ........
    000010 03 68 00 00 00 00 0a 2e ........
    000018 ee 33 0f 19 08 7f 0f 19 ........
    000020 03 80 94 04 00 00 10 01 ........
    000028 16 a2 0a 00 03 50 00 0c ........
    000030 01 01 0f 19 03 80 11 01 ........

</PRE>


<P>

There is no limit on the width or number of bytes per line. Also the
text dump at the end of the line is ignored. Bytes/hex numbers can be
uppercase or lowercase. Any text before the offset is ignored,
including email forwarding characters '&gt;'. Any lines of text between
the bytestring lines is ignored. The offsets are used to track the
bytes, so offsets must be correct. Any line which has only bytes
without a leading offset is ignored. An offset is recognized as being
a hex number longer than two characters. Any text after the bytes is
ignored (e.g. the character dump). Any hex numbers in this text are
also ignored. An offset of zero is indicative of starting a new
packet, so a single text file with a series of hexdumps can be
converted into a packet capture with multiple packets. Multiple
packets are read in with timestamps differing by one second each. In
general, short of these restrictions, <B>text2pcap</B> is pretty liberal
about reading in hexdumps and has been tested with a variety of
mangled outputs (including being forwarded through email multiple
times, with limited line wrap etc.)
<P>

There are a couple of other special features to note. Any line where
the first non-whitespace character is '#' will be ignored as a
comment. Any line beginning with #TEXT2PCAP is a directive and options
can be inserted after this command to be processed by
<B>text2pcap</B>. Currently there are no directives implemented; in the
future, these may be used to give more fine grained control on the
dump and the way it should be processed e.g. timestamps, encapsulation
type etc.
<P>

<B>Text2pcap</B> also allows the user to read in dumps of
application-level data, by inserting dummy L2, L3 and L4 headers
before each packet. The user can elect to insert Ethernet headers,
Ethernet and <FONT SIZE="-1">IP</FONT>, or Ethernet, <FONT SIZE="-1">IP</FONT> and <FONT SIZE="-1">UDP/TCP</FONT> headers before each
packet. This allows Ethereal or any other full-packet decoder to
handle these dumps.
<A NAME="lbAE">&nbsp;</A>
<H2>OPTIONS</H2>

<A NAME="ixAAE"></A>
<DL COMPACT>
<DT>-h<DD>
<A NAME="ixAAF"></A>
Displays a help message.
<DT>-d<DD>
<A NAME="ixAAG"></A>
Displays debugging information during the process. Can be used
multiple times to generate more debugging information.
<DT>-q<DD>
<A NAME="ixAAH"></A>
Be completely quiet during the process.
<DT>-o hex|oct<DD>
<A NAME="ixAAI"></A>
Specify the radix for the offsets (hex or octal). Defaults to
hex. This corresponds to the <TT>&quot;-A&quot;</TT> option for <I>od</I>.
<DT>-l<DD>
<A NAME="ixAAJ"></A>
Specify the link-layer type of this packet. Default is Ethernet
(1). See <I>net/bpf.h</I> for the complete list of possible
encapsulations. Note that this option should be used if your dump is a
complete hex dump of an encapsulated packet and you wish to specify
the exact type of encapsulation. Example: <I>-l 7</I> for ARCNet packets.
<DT>-e l3pid<DD>
<A NAME="ixAAK"></A>
Include a dummy Ethernet header before each packet. Specify the L3PID
for the Ethernet header in hex. Use this option if your dump has Layer
3 header and payload (e.g. <FONT SIZE="-1">IP</FONT> header), but no Layer 2
encapsulation. Example: <I>-e 0x806</I> to specify an <FONT SIZE="-1">ARP</FONT> packet. 


<P>


For <FONT SIZE="-1">IP</FONT> packets, instead of generating a fake Ethernet header you can
also use <I>-l 12</I> to indicate a raw <FONT SIZE="-1">IP</FONT> packet to Ethereal. Note that
<I>-l 12</I> does not work for any non-IP Layer 3 packet (e.g. <FONT SIZE="-1">ARP</FONT>),
whereas generating a dummy Ethernet header with <I>-e</I> works for any
sort of L3 packet.
<DT>-i proto<DD>
<A NAME="ixAAL"></A>
Include dummy <FONT SIZE="-1">IP</FONT> headers before each packet. Specify the <FONT SIZE="-1">IP</FONT> protocol
for the packet in decimal. Use this option if your dump is the payload
of an <FONT SIZE="-1">IP</FONT> packet (i.e. has complete L4 information) but does not have
an <FONT SIZE="-1">IP</FONT> header. Note that this automatically includes an appropriate
Ethernet header as well. Example: <I>-i 46</I> to specify an <FONT SIZE="-1">RSVP</FONT> packet
(<FONT SIZE="-1">IP</FONT> protocol 46).
<DT>-m max-packet<DD>
<A NAME="ixAAM"></A>
Set the maximum packet length, default is 64000.
Useful for testing various packet boundaries when only an application
level datastream is available.  Example:


<P>


<I>od -Ax -tx1 stream | text2pcap -m1460 -T1234,1234 - stream.pcap</I>


<P>


will convert from plain datastream format to a sequence of Ethernet
<FONT SIZE="-1">TCP</FONT> packets.
<DT>-u srcport,destport<DD>
<A NAME="ixAAN"></A>
Include dummy <FONT SIZE="-1">UDP</FONT> headers before each packet. Specify the source and
destination <FONT SIZE="-1">UDP</FONT> ports for the packet in decimal. Use this option if
your dump is the <FONT SIZE="-1">UDP</FONT> payload of a packet but does not include any <FONT SIZE="-1">UDP</FONT>,
<FONT SIZE="-1">IP</FONT> or Ethernet headers. Note that this automatically includes
appropriate Ethernet and <FONT SIZE="-1">IP</FONT> headers with each packet. Example: <I>-u
1000,69</I> to make the packets look like <FONT SIZE="-1">TFTP/UDP</FONT> packets.
<DT>-T srcport,destport<DD>
<A NAME="ixAAO"></A>
Include dummy <FONT SIZE="-1">TCP</FONT> headers before each packet. Specify the source and
destination <FONT SIZE="-1">TCP</FONT> ports for the packet in decimal. Use this option if
your dump is the <FONT SIZE="-1">TCP</FONT> payload of a packet but does not include any <FONT SIZE="-1">TCP</FONT>,
<FONT SIZE="-1">IP</FONT> or Ethernet headers. Note that this automatically includes
appropriate Ethernet and <FONT SIZE="-1">IP</FONT> headers with each packet.
Sequence numbers will start a 0.
<DT>-s srcport,destport,tag<DD>
<A NAME="ixAAP"></A>
Include dummy <FONT SIZE="-1">SCTP</FONT> headers before each packet.  Specify, in decimal, the
source and destination <FONT SIZE="-1">SCTP</FONT> ports, and verification tag, for the packet. 
Use this option if your dump is the <FONT SIZE="-1">SCTP</FONT> payload of a packet but does
not include any <FONT SIZE="-1">SCTP</FONT>, <FONT SIZE="-1">IP</FONT> or Ethernet headers.  Note that this
automatically includes appropriate Ethernet and <FONT SIZE="-1">IP</FONT> headers with each
packet.  A <FONT SIZE="-1">CRC32C</FONT> checksum will be put into the <FONT SIZE="-1">SCTP</FONT> header.
<DT>-S srcport,destport,ppi<DD>
<A NAME="ixAAQ"></A>
Include dummy <FONT SIZE="-1">SCTP</FONT> headers before each packet.  Specify, in decimal, the
source and destination <FONT SIZE="-1">SCTP</FONT> ports, and a verification tag of 0, for the
packet, and prepend a dummy <FONT SIZE="-1">SCTP</FONT> <FONT SIZE="-1">DATA</FONT> chunk header with a payload
protocol identifier if <I>ppi</I>.  Use this option if your dump is the <FONT SIZE="-1">SCTP</FONT>
payload of a packet but does not include any <FONT SIZE="-1">SCTP</FONT>, <FONT SIZE="-1">IP</FONT> or Ethernet
headers.  Note that this automatically includes appropriate Ethernet and
<FONT SIZE="-1">IP</FONT> headers with each packet.  A <FONT SIZE="-1">CRC32C</FONT> checksum will be put into the
<FONT SIZE="-1">SCTP</FONT> header.
<DT>-t timefmt<DD>
<A NAME="ixAAR"></A>
Treats the text before the packet as a date/time code; <I>timefmt</I> is a
format string of the sort supported by <B></B><A HREF="../man3/strptime.3.php">strptime</A><B>(3)</B>.
Example: The time ``10:15:14.5476'' has the format code ``%H:%M:%S.''


<P>


<B></B><FONT SIZE="-1"><B>NOTE:</B></FONT><B></B> The subsecond component delimiter must be specified (.) but no
pattern is required; the remaining number is assumed to be fractions of
a second.
</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAS"></A>
<I><A HREF="../man8/tcpdump.8.php">tcpdump</A>(8)</I>, <I><A HREF="../man3/pcap.3.php">pcap</A>(3)</I>, <I><A HREF="../man1/ethereal.1.php">ethereal</A>(1)</I>, <I><A HREF="../man1/editcap.1.php">editcap</A>(1)</I>, <I><A HREF="../man3/strptime.3.php">strptime</A>(3)</I>.
<A NAME="lbAG">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAT"></A>
<B>Text2pcap</B> is part of the <B>Ethereal</B> distribution.  The latest version
of <B>Ethereal</B> can be found at <B><A HREF="http://www.ethereal.com">http://www.ethereal.com</A></B>.
<A NAME="lbAH">&nbsp;</A>
<H2>AUTHORS</H2>

<A NAME="ixAAU"></A>


<PRE>
  Ashok Narayanan          &lt;ashokn[AT]cisco.com&gt;

</PRE>


<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSYS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">OPTIONS</A><DD>
<DT><A HREF="#lbAF">SEE ALSO</A><DD>
<DT><A HREF="#lbAG">NOTES</A><DD>
<DT><A HREF="#lbAH">AUTHORS</A><DD>
</DL>

</div>






</div>




</body>
</html>
