
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>PERLTODO</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="/global/main.css" title="default">
</head>

<body>



<div id="container">


<div id="content">

<div id='catHeader'><table width='100%'><tr><td>
<H1>PERLTODO</H1>
Section: Perl Programmers Reference Guide (1)<BR>Updated: 2004-04-23<BR>
</td><td align='right' valign='bottom'><div class='ad_header_right'></div></td></tr></table></div></div>
<div id='categories'>
<div class='ad_man_right'>
</div>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

perltodo - Perl TO-DO List
<A NAME="lbAC">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAC"></A>
This is a list of wishes for Perl.  Send updates to
<I><A HREF="mailto:perl5-porters@perl.org">perl5-porters@perl.org</A></I>.  If you want to work on any of these
projects, be sure to check the perl5-porters archives for past ideas,
flames, and propaganda.  This will save you time and also prevent you
from implementing something that Larry has already vetoed.  One set
of archives may be found at:
<P>



<PRE>
    <A HREF="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/</A>

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>assertions</H2>

<A NAME="ixAAD"></A>
Clean up and finish support for assertions. See assertions.
<A NAME="lbAE">&nbsp;</A>
<H2>iCOW</H2>

<A NAME="ixAAE"></A>
Sarathy and Arthur have a proposal for an improved Copy On Write which
specifically will be able to <FONT SIZE="-1">COW</FONT> new ithreads. If this can be implemented
it would be a good thing.
<A NAME="lbAF">&nbsp;</A>
<H2>(?{...}) closures in regexps</H2>

<A NAME="ixAAF"></A>
Fix (or rewrite) the implementation of the <TT>&quot;/(?{...})/&quot;</TT> closures.
<A NAME="lbAG">&nbsp;</A>
<H2>A re-entrant regexp engine</H2>

<A NAME="ixAAG"></A>
This will allow the use of a regex from inside (?{ }), (??{ }) and
(?(?{ })|) constructs.
<A NAME="lbAH">&nbsp;</A>
<H2>pragmata</H2>

<A NAME="ixAAH"></A>
<A NAME="lbAI">&nbsp;</A>
<H2>lexical pragmas</H2>

<A NAME="ixAAI"></A>
Reimplement the mechanism of lexical pragmas to be more extensible. Fix
current pragmas that don't work well (or at all) with lexical scopes or in
run-time eval(<FONT SIZE="-1">STRING</FONT>) (<TT>&quot;sort&quot;</TT>, <TT>&quot;re&quot;</TT>, <TT>&quot;encoding&quot;</TT> for example). <FONT SIZE="-1">MJD</FONT> has a
preliminary patch that implements this.
<A NAME="lbAJ">&nbsp;</A>
<H2>use less 'memory'</H2>

<A NAME="ixAAJ"></A>
Investigate trade offs to switch out perl's choices on memory usage.
Particularly perl should be able to give memory back.
<A NAME="lbAK">&nbsp;</A>
<H2>prototypes and functions</H2>

<A NAME="ixAAK"></A>
<A NAME="lbAL">&nbsp;</A>
<H2>_ prototype character</H2>

<A NAME="ixAAL"></A>
Study the possibility of adding a new prototype character, <TT>&quot;_&quot;</TT>, meaning
``this argument defaults to <TT>$_</TT>''.
<A NAME="lbAM">&nbsp;</A>
<H2>inlining autoloaded constants</H2>

<A NAME="ixAAM"></A>
Currently the optimiser can inline constants when expressed as subroutines
with prototype ($) that return a constant. Likewise, many packages wrapping
C libraries export lots of constants as subroutines which are AUTOLOADed on
demand. However, these have no prototypes, so can't be seen as constants by
the optimiser. Some way of cheaply (low syntax, low memory overhead) to the
perl compiler that a name is a constant would be great, so that it knows to
call the <FONT SIZE="-1">AUTOLOAD</FONT> routine at compile time, and then inline the constant.
<A NAME="lbAN">&nbsp;</A>
<H2>Finish off lvalue functions</H2>

<A NAME="ixAAN"></A>
The old perltodo notes ``They don't work in the debugger, and they don't work for
list or hash slices.''
<A NAME="lbAO">&nbsp;</A>
<H2>Unicode and UTF8</H2>

<A NAME="ixAAO"></A>
<A NAME="lbAP">&nbsp;</A>
<H2>Implicit Latin 1 =&gt; Unicode translation</H2>

<A NAME="ixAAP"></A>
Conversions from byte strings to <FONT SIZE="-1">UTF-8</FONT> currently map high bit characters
to Unicode without translation (or, depending on how you look at it, by
implicitly assuming that the byte strings are in Latin-1). As perl assumes
the C locale by default, upgrading a string to <FONT SIZE="-1">UTF-8</FONT> may change the
meaning of its contents regarding character classes, case mapping, etc.
This should probably emit a warning (at least).
<A NAME="lbAQ">&nbsp;</A>
<H2><FONT SIZE="-1">UTF8</FONT> caching code</H2>

<A NAME="ixAAQ"></A>
The string position/offset cache is not optional. It should be.
<A NAME="lbAR">&nbsp;</A>
<H2>Unicode in Filenames</H2>

<A NAME="ixAAR"></A>
chdir, chmod, chown, chroot, exec, glob, link, lstat, mkdir, open,
opendir, qx, readdir, readlink, rename, rmdir, stat, symlink, sysopen,
system, truncate, unlink, utime, -X.  All these could potentially accept
Unicode filenames either as input or output (and in the case of system
and qx Unicode in general, as input or output to/from the shell).
Whether a filesystem - an operating system pair understands Unicode in
filenames varies.
<P>

Known combinations that have some level of understanding include
Microsoft <FONT SIZE="-1">NTFS</FONT>, Apple <FONT SIZE="-1">HFS+</FONT> (In Mac <FONT SIZE="-1">OS</FONT> 9 and X) and Apple <FONT SIZE="-1">UFS</FONT> (in Mac
<FONT SIZE="-1">OS</FONT> X), <FONT SIZE="-1">NFS</FONT> v4 is rumored to be Unicode, and of course Plan 9.  How to
create Unicode filenames, what forms of Unicode are accepted and used
(<FONT SIZE="-1">UCS-2</FONT>, <FONT SIZE="-1">UTF-16</FONT>, <FONT SIZE="-1">UTF-8</FONT>), what (if any) is the normalization form used,
and so on, varies.  Finding the right level of interfacing to Perl
requires some thought.  Remember that an <FONT SIZE="-1">OS</FONT> does not implicate a
filesystem.
<P>

(The Windows -C command flag ``wide <FONT SIZE="-1">API</FONT> support'' has been at least
temporarily retired in 5.8.1, and the -C has been repurposed, see
perlrun.)
<A NAME="lbAS">&nbsp;</A>
<H2>Unicode in %ENV</H2>



<A NAME="ixAAS"></A>
Currently the <TT>%ENV</TT> entries are always byte strings.
<A NAME="lbAT">&nbsp;</A>
<H2>Regexps</H2>

<A NAME="ixAAT"></A>
<A NAME="lbAU">&nbsp;</A>
<H2>regexp optimiser optional</H2>

<A NAME="ixAAU"></A>
The regexp optimiser is not optional. It should configurable to be, to allow
its performance to be measured, and its bugs to be easily demonstrated.
<A NAME="lbAV">&nbsp;</A>
<H2>common suffices/prefices in regexps (trie optimization)</H2>

<A NAME="ixAAV"></A>
Currently, the user has to optimize <TT>&quot;foo|far&quot;</TT> and <TT>&quot;foo|goo&quot;</TT> into
<TT>&quot;f(?:oo|ar)&quot;</TT> and <TT>&quot;[fg]oo&quot;</TT> by hand; this could be done automatically.
<A NAME="lbAW">&nbsp;</A>
<H2>POD</H2>

<A NAME="ixAAW"></A>
<A NAME="lbAX">&nbsp;</A>
<H2><FONT SIZE="-1">POD</FONT> -&gt; <FONT SIZE="-1">HTML</FONT> conversion still sucks</H2>

<A NAME="ixAAX"></A>
Which is crazy given just how simple <FONT SIZE="-1">POD</FONT> purports to be, and how simple <FONT SIZE="-1">HTML</FONT>
can be.
<A NAME="lbAY">&nbsp;</A>
<H2>Misc medium sized projects</H2>

<A NAME="ixAAY"></A>
<A NAME="lbAZ">&nbsp;</A>
<H2><FONT SIZE="-1">UNITCHECK</FONT></H2>

<A NAME="ixAAZ"></A>
Introduce a new special block, <FONT SIZE="-1">UNITCHECK</FONT>, which is run at the end of a
compilation unit (module, file, eval(<FONT SIZE="-1">STRING</FONT>) block). This will correspond to
the Perl 6 <FONT SIZE="-1">CHECK</FONT>. Perl 5's <FONT SIZE="-1">CHECK</FONT> cannot be changed or removed because the
O.pm/B.pm backend framework depends on it.
<A NAME="lbBA">&nbsp;</A>
<H2>optional optimizer</H2>

<A NAME="ixABA"></A>
Make the peephole optimizer optional.
<A NAME="lbBB">&nbsp;</A>
<H2>You <FONT SIZE="-1">WANT</FONT> *how* many</H2>

<A NAME="ixABB"></A>
Currently contexts are void, scalar and list. split has a special mechanism in
place to pass in the number of return values wanted. It would be useful to
have a general mechanism for this, backwards compatible and little speed hit.
This would allow proposals such as short circuiting sort to be implemented
as a module on <FONT SIZE="-1">CPAN</FONT>.
<A NAME="lbBC">&nbsp;</A>
<H2>lexical aliases</H2>

<A NAME="ixABC"></A>
Allow lexical aliases (maybe via the syntax <TT>&quot;my \$alias = \$foo&quot;</TT>.
<A NAME="lbBD">&nbsp;</A>
<H2>no 6</H2>

<A NAME="ixABD"></A>
Make <TT>&quot;no 6&quot;</TT> and <TT>&quot;no v6&quot;</TT> work (opposite of <TT>&quot;use 5.005&quot;</TT>, etc.).
<A NAME="lbBE">&nbsp;</A>
<H2>IPv6</H2>

<A NAME="ixABE"></A>
Clean this up. Check everything in core works
<A NAME="lbBF">&nbsp;</A>
<H2>entersub <FONT SIZE="-1">XS</FONT> vs Perl</H2>

<A NAME="ixABF"></A>
At the moment pp_entersub is huge, and has code to deal with entering both
perl and and <FONT SIZE="-1">XS</FONT> subroutines. Subroutine implementations rarely change between 
perl and <FONT SIZE="-1">XS</FONT> at run time, so investigate using 2 ops to enter subs (one for
<FONT SIZE="-1">XS</FONT>, one for perl) and swap between if a sub is redefined.
<A NAME="lbBG">&nbsp;</A>
<H2>@INC source filter to Filter::Simple</H2>

<A NAME="ixABG"></A>
The second return value from a sub in <TT>@INC</TT> can be a source filter. This isn't
documented. It should be changed to use Filter::Simple, tested and documented.
<A NAME="lbBH">&nbsp;</A>
<H2>bincompat functions</H2>

<A NAME="ixABH"></A>
There are lots of functions which are retained for binary compatibility.
Clean these up. Move them to mathom.c, and don't compile for blead?
<A NAME="lbBI">&nbsp;</A>
<H2>Use fchown/fchmod internally</H2>

<A NAME="ixABI"></A>
The old perltodo notes ``This has been done in places, but needs a thorough
code review. Also fchdir is available in some platforms.''
<A NAME="lbBJ">&nbsp;</A>
<H2>Tests</H2>

<A NAME="ixABJ"></A>
<A NAME="lbBK">&nbsp;</A>
<H2>Make Schwern poorer</H2>

<A NAME="ixABK"></A>
Tests for everything, At which point Schwern coughs up <TT>$500</TT> to <FONT SIZE="-1">TPF</FONT>.
<A NAME="lbBL">&nbsp;</A>
<H2>test B</H2>

<A NAME="ixABL"></A>
A test suite for the B module would be nice.
<A NAME="lbBM">&nbsp;</A>
<H2>Improve tests for Config.pm</H2>

<A NAME="ixABM"></A>
Config.pm doesn't appear to be well tested.
<A NAME="lbBN">&nbsp;</A>
<H2>common test code for timed bailout</H2>

<A NAME="ixABN"></A>
Write portable self destruct code for tests to stop them burning <FONT SIZE="-1">CPU</FONT> in
infinite loops. Needs to avoid using alarm, as some of the tests are testing
alarm/sleep or timers.
<A NAME="lbBO">&nbsp;</A>
<H2>Installation</H2>

<A NAME="ixABO"></A>
<A NAME="lbBP">&nbsp;</A>
<H2>compressed man pages</H2>

<A NAME="ixABP"></A>
Be able to install them
<A NAME="lbBQ">&nbsp;</A>
<H2>Make Config.pm cope with differences between build and installed perl</H2>

<A NAME="ixABQ"></A>
<A NAME="lbBR">&nbsp;</A>
<H2>Relocatable perl</H2>

<A NAME="ixABR"></A>
Make it possible to create a relocatable perl binary. Will need some collusion
with Config.pm. We could use a syntax of ... for location of current binary?
<A NAME="lbBS">&nbsp;</A>
<H2>make <FONT SIZE="-1">HTML</FONT> install work</H2>

<A NAME="ixABS"></A>
<A NAME="lbBT">&nbsp;</A>
<H2>put patchlevel in -v</H2>

<A NAME="ixABT"></A>
Currently perl from p4/rsync ships with a patchlevel.h file that usually
defines one local patch, of the form ``<FONT SIZE="-1">MAINT12345</FONT>'' or ``<FONT SIZE="-1">RC1</FONT>''. The output of
perl -v doesn't report that a perl isn't an official release, and this
information can get lost in bugs reports. Because of this, the minor version
isn't bumped up util <FONT SIZE="-1">RC</FONT> time, to minimise the possibility of versions of perl
escaping that believe themselves to be newer than they actually are.
<P>

It would be useful to find an elegant way to have the ``this is an interim
maintenance release'' or ``this is a release candidate'' in the terse -v output,
and have it so that it's easy for the pumpking to remove this just as the
release tarball is rolled up. This way the version pulled out of rsync would
always say ``I'm a development release'' and it would be safe to bump the
reported minor version as soon as a release ships, which would aid perl
developers.
<A NAME="lbBU">&nbsp;</A>
<H2>Incremental things</H2>

<A NAME="ixABU"></A>
Some tasks that don't need to get done in one big hit.
<A NAME="lbBV">&nbsp;</A>
<H2>autovivification</H2>

<A NAME="ixABV"></A>
Make all autovivification consistent w.r.t <FONT SIZE="-1">LVALUE/RVALUE</FONT> and strict/no strict;
<A NAME="lbBW">&nbsp;</A>
<H2>fix tainting bugs</H2>

<A NAME="ixABW"></A>
Fix the bugs revealed by running the test suite with the <TT>&quot;-t&quot;</TT> switch (via
<TT>&quot;make test.taintwarn&quot;</TT>).
<A NAME="lbBX">&nbsp;</A>
<H2>Make tainting consistent</H2>

<A NAME="ixABX"></A>
Tainting would be easier to use if it didn't take documented shortcuts and allow
taint to ``leak'' everywhere within an expression.
<A NAME="lbBY">&nbsp;</A>
<H2>Dual life everything</H2>

<A NAME="ixABY"></A>
As part of the ``dists'' plan, anything that doesn't belong in the smallest perl
distribution needs to be dual lifed. Anything else can be too.
<A NAME="lbBZ">&nbsp;</A>
<H2>Vague things</H2>

<A NAME="ixABZ"></A>
Some more nebulous ideas
<A NAME="lbCA">&nbsp;</A>
<H2>threads</H2>

<A NAME="ixACA"></A>
Make threads more robust.
<A NAME="lbCB">&nbsp;</A>
<H2><FONT SIZE="-1">POSIX</FONT> memory footprint</H2>

<A NAME="ixACB"></A>
Ilya observed that use <FONT SIZE="-1">POSIX</FONT>; eats memory like there's no tomorrow, and at
various times worked to cut it down. There is probably still fat to cut out -
for example <FONT SIZE="-1">POSIX</FONT> passes Exporter some very memory hungry data structures.
<A NAME="lbCC">&nbsp;</A>
<H2>Optimize away @_</H2>



<A NAME="ixACC"></A>
The old perltodo notes ``Look at the ''reification&quot; code in <TT>&quot;av.c&quot;</TT>&quot;
<A NAME="lbCD">&nbsp;</A>
<H2>switch ops</H2>

<A NAME="ixACD"></A>
The old perltodo notes &quot;Although we have <TT>&quot;Switch.pm&quot;</TT> in core, Larry points to
the dormant <TT>&quot;nswitch&quot;</TT> and <TT>&quot;cswitch&quot;</TT> ops in <I>pp.c</I>; using these opcodes would
be much faster.&quot;
<A NAME="lbCE">&nbsp;</A>
<H2>Attach/detach debugger from running program</H2>

<A NAME="ixACE"></A>
The old perltodo notes &quot;With <TT>&quot;gdb&quot;</TT>, you can attach the debugger to a running
program if you pass the process <FONT SIZE="-1">ID</FONT>. It would be good to do this with the Perl
debugger on a running Perl program, although I'm not sure how it would be done.&quot;
ssh and screen do this with named pipes in tmp. Maybe we can too.
<A NAME="lbCF">&nbsp;</A>
<H2>A decent benchmark</H2>

<A NAME="ixACF"></A>
perlbench seems impervious to any recent changes made to the perl core. It would
be useful to have a reasonable general benchmarking suite that roughly
represented what current perl programs do, and measurably reported whether
tweaks to the core improve, degrade or don't really affect performance, to
guide people attempting to optimise the guts of perl.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">DESCRIPTION</A><DD>
<DT><A HREF="#lbAD">assertions</A><DD>
<DT><A HREF="#lbAE">iCOW</A><DD>
<DT><A HREF="#lbAF">(?{...}) closures in regexps</A><DD>
<DT><A HREF="#lbAG">A re-entrant regexp engine</A><DD>
<DT><A HREF="#lbAH">pragmata</A><DD>
<DT><A HREF="#lbAI">lexical pragmas</A><DD>
<DT><A HREF="#lbAJ">use less 'memory'</A><DD>
<DT><A HREF="#lbAK">prototypes and functions</A><DD>
<DT><A HREF="#lbAL">_ prototype character</A><DD>
<DT><A HREF="#lbAM">inlining autoloaded constants</A><DD>
<DT><A HREF="#lbAN">Finish off lvalue functions</A><DD>
<DT><A HREF="#lbAO">Unicode and UTF8</A><DD>
<DT><A HREF="#lbAP">Implicit Latin 1 =&gt; Unicode translation</A><DD>
<DT><A HREF="#lbAQ"><FONT SIZE="-1">UTF8</FONT> caching code</A><DD>
<DT><A HREF="#lbAR">Unicode in Filenames</A><DD>
<DT><A HREF="#lbAS">Unicode in 0.000000E+00NV</A><DD>
<DT><A HREF="#lbAT">Regexps</A><DD>
<DT><A HREF="#lbAU">regexp optimiser optional</A><DD>
<DT><A HREF="#lbAV">common suffices/prefices in regexps (trie optimization)</A><DD>
<DT><A HREF="#lbAW">POD</A><DD>
<DT><A HREF="#lbAX"><FONT SIZE="-1">POD</FONT> -&gt; <FONT SIZE="-1">HTML</FONT> conversion still sucks</A><DD>
<DT><A HREF="#lbAY">Misc medium sized projects</A><DD>
<DT><A HREF="#lbAZ"><FONT SIZE="-1">UNITCHECK</FONT></A><DD>
<DT><A HREF="#lbBA">optional optimizer</A><DD>
<DT><A HREF="#lbBB">You <FONT SIZE="-1">WANT</FONT> *how* many</A><DD>
<DT><A HREF="#lbBC">lexical aliases</A><DD>
<DT><A HREF="#lbBD">no 6</A><DD>
<DT><A HREF="#lbBE">IPv6</A><DD>
<DT><A HREF="#lbBF">entersub <FONT SIZE="-1">XS</FONT> vs Perl</A><DD>
<DT><A HREF="#lbBG">@INC source filter to Filter::Simple</A><DD>
<DT><A HREF="#lbBH">bincompat functions</A><DD>
<DT><A HREF="#lbBI">Use fchown/fchmod internally</A><DD>
<DT><A HREF="#lbBJ">Tests</A><DD>
<DT><A HREF="#lbBK">Make Schwern poorer</A><DD>
<DT><A HREF="#lbBL">test B</A><DD>
<DT><A HREF="#lbBM">Improve tests for Config.pm</A><DD>
<DT><A HREF="#lbBN">common test code for timed bailout</A><DD>
<DT><A HREF="#lbBO">Installation</A><DD>
<DT><A HREF="#lbBP">compressed man pages</A><DD>
<DT><A HREF="#lbBQ">Make Config.pm cope with differences between build and installed perl</A><DD>
<DT><A HREF="#lbBR">Relocatable perl</A><DD>
<DT><A HREF="#lbBS">make <FONT SIZE="-1">HTML</FONT> install work</A><DD>
<DT><A HREF="#lbBT">put patchlevel in -v</A><DD>
<DT><A HREF="#lbBU">Incremental things</A><DD>
<DT><A HREF="#lbBV">autovivification</A><DD>
<DT><A HREF="#lbBW">fix tainting bugs</A><DD>
<DT><A HREF="#lbBX">Make tainting consistent</A><DD>
<DT><A HREF="#lbBY">Dual life everything</A><DD>
<DT><A HREF="#lbBZ">Vague things</A><DD>
<DT><A HREF="#lbCA">threads</A><DD>
<DT><A HREF="#lbCB"><FONT SIZE="-1">POSIX</FONT> memory footprint</A><DD>
<DT><A HREF="#lbCC">Optimize away @_</A><DD>
<DT><A HREF="#lbCD">switch ops</A><DD>
<DT><A HREF="#lbCE">Attach/detach debugger from running program</A><DD>
<DT><A HREF="#lbCF">A decent benchmark</A><DD>
</DL>

</div>






</div>




</body>
</html>
