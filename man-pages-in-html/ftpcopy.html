
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>ftpcopy</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="/global/main.css" title="default">
</head>

<body>



<div id="container">


<div id="content">

<div id='catHeader'><table width='100%'><tr><td>
<H1>ftpcopy</H1>
Section: User Commands  (1)<BR>Updated: 0.6.2<BR>
</td><td align='right' valign='bottom'><div class='ad_header_right'></div></td></tr></table></div></div>
<div id='categories'>
<div class='ad_man_right'>
</div>



<BR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

ftpcopy - mirror or copy files from a FTP server

<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

ftpcopy <A HREF="ftp://host[:port]/directory">ftp://host[:port]/directory</A> [local-directory]




or




ftpcopy host[:port] /directory [local-directory]
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>ftpcopy</B> copies a FTP site recursivly. It afterwards deletes all
files in the local directory tree which were not found on the
remote site.




<I>local-directory</I> defaults to &quot;.&quot; - the current working directory -
if the <I>-n</I> (<I>--no-delete</I>) option is used. <I>local-directory</I>
is not needed if the <I>--interactive</I> option is used.
Otherwise you must provide a <I>local-directory</I> argument.
<A NAME="lbAE">&nbsp;</A>
<H2>OPTIONS</H2>




<A NAME="lbAF">&nbsp;</A>
<H3>bsection</H3>







<DL COMPACT>
<DT><DD>



<DT><DD>

Use NAME to login on the ftp server.
The default is `anonymous'. Use an empty name to force to not log in.


<DT><DD>

Use PASS as password to login on the ftp server.
The default is `<A HREF="mailto:anonymous@invalid.example">anonymous@invalid.example</A>'. Use an empty password
to enforce not sending any password.


<DT><DD>

Send ACCOUNT as the account name using the <I>ACCT</I> ftp command if 
the ftp servers asks for one.


<DT><DD>

<I>ACCOUNT</I> in ftp speak is some kind of sub account in some other
terminologies. If you don't understand what it means you have
a good chance to never need this option anyway. If you think you
need it please try the <I>-u</I> option first.


<DT><DD>

Number of tries to connect and log in. The default is 1, meaning that
ftpls will give up after the first error.


<DT><DD>

This option was added in version 0.3.0.


<DT><DD>

ftpcopy will sleep for NUMBER seconds after a try to 
connect or login has failed. The default is 5, a zero
is treated as one, and abuse (especially together with
--tries) is likely to annoy the server administrator.


<DT><DD>

This option was added in version 0.4.5.


<DT><DD>

Only use IPv4, even is IPv6 is available. This option effectively
disallows the use of IPv6, except for DNS queries.


<DT><DD>

This option was added in version 0.6.0.


<DT><DD>

Only use IPv6, even is IPv4 is available. This option effectively
disallows the use of IPv4, except for DNS queries.


<DT><DD>

This option was added in version 0.6.0.



<P>



</DL>
<A NAME="lbAG">&nbsp;</A>
<H3>bsection</H3>





<P>


<DL COMPACT>
<DT><DD>



<DT><DD>

this controls the amount of logging done:






0: nothing except warnings and error messages



1: downloads and deletes



2: links/symlinks created, files we already got



3: useless stuff





<DT><DD>

The default is 1.


<DT><DD>

Log transfer rates.


<DT><DD>

This option was added in version 0.3.9.


<DT><DD>

Report progress to the standard error output (file descriptor 2).


<DT><DD>

This will print a report of the download every
second: a short form of the file name, the bytes
got and expected and the percentage received.


<DT><DD>

This option was added in version 0.6.0.



<P>



</DL>
<A NAME="lbAH">&nbsp;</A>
<H3>bsection</H3>





<P>
<P>


<DL COMPACT>
<DT><DD>



<DT><DD>

Download only files modified in the last <I>NUMBER</I> days.
Locally existing copies of the not downloaded files will be kept.


<DT><DD>

Download only files up to BYTES bytes length. Locally existing copies of 
overlong files will be deleted during the clean-up step.


<DT><DD>

This option was added in version 0.5.1.


<DT><DD>

Exclude files and directories matching <I>WILDCARD</I> (note that 
this means shell style wildcards, not regular expression like
those of grep). 
<BR>

You can repeat this option as often as you want. You can 
intermix it with the <I>-i</I> option.
<BR>

See 

below, for more information.


<DT><DD>

This option was added in version 0.3.0.


<DT><DD>

Include files and directories matching <I>WILDCARD</I>. You can repeat 
this option as often as you want. You can intermix it with the 
<I>-x</I> option.
<BR>

See 

below, for more information.


<DT><DD>

This option was added in version 0.3.0.


<DT><DD>

Do not compare file sizes when checking the remote file has to be
downloaded.


<DT><DD>

This option was added in version 0.4.4.


<DT><DD>

Do not compare file modification times when checking the remote file 
has to be downloaded. This option may be combined with --ignore-size,
in which case a file will never be downloaded regardless of changes
in file size or modification time. In other words: ftpcopy will not
download any updates.


<DT><DD>

This option was added in version 0.4.4.


<DT><DD>

Descend at most LEVEL directories deep.
0 means <I>do not enter sub directories at all</I>, 1 means <I>enter 
sub-directories, but not their sub-directories</I>, and so on.
The default is 2^32-1, meaning <I>enter all</I>.


<DT><DD>

This option was added in version 0.5.2.



<P>



</DL>
<A NAME="lbAI">&nbsp;</A>
<H3>bsection</H3>





<P>


<DL COMPACT>
<DT><DD>



<DT><DD>

Do not delete files. This influences the cleanup step at the end,
when ftpcopy removes files not found on the server. It doesn't
stop ftpcopy from deleting files when it detects something in
it's way during a download.


<DT><DD>

Do not delete more then COUNT files.
This option may be useful to limit the impact
of a tempoary loss of files on the server.
The default is 0, meaning unlimited.
This, too, only influences the cleanup step.


<DT><DD>

This option was added in version 0.4.5.



<P>



</DL>
<A NAME="lbAJ">&nbsp;</A>
<H3>bsection</H3>





<P>


<DL COMPACT>
<DT><DD>



<DT><DD>

Only create the directory hierarchie, do not download files.
Any file in the tree will be deleted unless the <I>-n</I> option
is also given. Note: if the <I>-s</I> option is also given
then even symbolic links to files will be created (without
the files, of course).


<DT><DD>

Do not copy or delete files: Only show what would be done.


<DT><DD>

This option was added in version 0.3.6.


<DT><DD>

Timeout to use for network read/write and connect operations. The default 
is 30 seconds and is usually sufficient.


<DT><DD>

This option was added in version 0.3.8.


<DT><DD>

Limit the transfer rate of file downloads to about that many bytes per 
seconds. The implementation is crude and simple, by sleeping up to one
second between network reads, and therefore does not even try to limit
the rate exactly to that number. On the other hand it usually works and
is unlikely to break things by causing timeouts.


<DT><DD>

This option was added in version 0.4.7.


<DT><DD>

This option tells <B>ftpcopy</B> to ignore any directories given on the 
command line, and to read commands from the standard input. Each
command consists of two lines, the first being a directory on the
remote server, and the second a local directory.


<DT><DD>

<B>ftpcopy</B> will print an <B>END-OF-COPY</B> line after each operation.


<DT><DD>

This option was added in version 0.3.6.
<P>



<P>



</DL>
<A NAME="lbAK">&nbsp;</A>
<H3>bsection</H3>





or &quot;things you may need in a less than perfect world&quot;:
<P>


<DL COMPACT>
<DT><DD>



<DT><DD>

Do directory listings in ASCII mode instead of binary mode. Use this
option if the FTP server is unable to correctly list directories in 
binary mode, for example, if you see a message like this (outside this
manual page this usually comes on one line):


<DT><DD>

<PRE>
  ftpcopy: fatal: received unwanted answer to LIST:
  426 Data connection: Illegal seek.
</PRE>



<DT><DD>

This option was added in version 0.5.2.


<DT><DD>

Add OPTS to LIST command.
<BR>

This allows to pass arbitrary options to the
FTP servers LIST command. Note that ftpcopy does
not cope well with recursive directory listings.


<DT><DD>

This option was added in version 0.3.0.


<DT><DD>

Deal with symbolic links. This is only useful to mirror sites
which create listings through /bin/ls. This will fail if a file name in
a link contains a ` -&gt; ' sequence.


<DT><DD>

Do not use the poll() system call even if it's available, but use select().
This allows <B>ftpcopy</B> to be used together with the runsocks program 
from the socks5 reference implementation. Please note that you'll
need a directly reachable name server anyway, as the DNS library 
in use does not support SOCKS (you can always use IP addresses).


<DT><DD>

This option was added in version 0.3.8.


<DT><DD>

Use the MDTM FTP command to determine file modification time.


<DT><DD>

The default is to take the times from the directory listings. This
doesn't work if the server implements an inferior listing format
(most do) and doesn't send time stamps in universal coordinated
time (UTC).


<DT><DD>

This option makes <B>ftpcopy</B> send a MDTM command for any file
it might want to download. The drawback is that this eats 
performance: ftpcopy usually sends just one command for a complete 
directory its traverses. With the <I>--mdtm</I> option it has to
send an additional command for any file.


<DT><DD>

This option was added in version 0.3.10.


<DT><DD>

Allow data connections to the address IP4.


<DT><DD>

Normally <B>ftpcopy</B> only accepts data connections to the addresses of 
the host it connected to. The list of addresses contains the IP addresses
of the host, as returned by the DNS query, or the IPv4 address of the
host, in case an IPv4 address was given on the commandline.
<P>
This option allows to add one or more IP addresses, separated by 
commas, to the internal list. It may be given more than once.


<DT><DD>

You may want to use this option if you are behind some kind of machine
(gateway) doing NAT (network address translation) or maquerading and 
<B>ftpcopy</B> prints an error message containing 
&quot;illegal redirect by FTP server&quot;.
<P>
<B>Note</B>: If you are <I>not</I> behind a NAT gateway, then do not use
this option without thinking: FTP redirects may be used to launch 
denial of service attacks against innocent targets.


<DT><DD>

The environment variable FTPCOPY_ALLOW_PASV_IP has the same function.


<DT><DD>

This option was added in version 0.6.1.


<DT><DD>

Do not try to resume downloads.


<DT><DD>

The REST command, needed to resume a failed download, is badly 
specified and is likely to be misinterpreted and -implemented. 
Use this option in case of trouble.


<DT><DD>

This option was added in version 0.6.0.


<DT><DD>

Change all local file names to lower case.


<DT><DD>

Use this only if you are absolutely sure that the remote side doesn't
contain any files or directories whose names collide with each other.
Otherwise this will waste bandwidth.


<DT><DD>

This option was added in version 0.3.8.
<P>



</DL>
<A NAME="lbAL">&nbsp;</A>
<H2>REMOVED OPTIONS</H2>



<DL COMPACT>
<DT><DD>



<DT><DD>



<DT><DD>

These options have been added in version 0.3.0 and removed in 0.3.7.
<I>--keep-dir</I> made ftpcopy keep a local directory even if it had been
replaced by a link to an other directory or a file, <I>--remove-dir</I>
did exactly the opposite. <I>--keep-dir</I> was the default for 
historical reasons.
<BR>

The current behaviour is like that of
<I>--remove-dir</I>: ftpcopy creates a copy of the remote ftp site.




</DL>
<A NAME="lbAM">&nbsp;</A>
<H2>IN/EXCLUDE</H2>

In- and exclude lists are internally mixed together, keeping the
order in which they were given. The list starts with an implicit 
`<I>include *</I>'.  <B>ftpcopy</B> honors the last match.




The wildcard matching is done against the full remote path of the
file. The <I>/</I> character has no special meaning for the matching:
it is treated like any other.




Note: you have to include top level directories of files or
directories you want to include. Something like this will <B>not</B>
work:




<BR>&nbsp;&nbsp;&nbsp;&nbsp;--exclude&nbsp;&quot;*&quot;&nbsp;--include&nbsp;&quot;/w/h/e/r/e/file.c&quot;




You need to include /w, /w/h and so on.
<A NAME="lbAN">&nbsp;</A>
<H2>EXAMPLES</H2>




<A NAME="lbAO">&nbsp;</A>
<H3>bsection</H3>





<PRE>
        ftpcopy  \
        --exclude '*.cdb'  \
        --exclude '*software/precompiled*' \
        cr.yp.to / /private/file/0/mirror/cr.yp.to
</PRE>





This means:






i'm not interested in .cdb files.



precompiled stuff is also not downloaded.



the host to connect to is <I>cr.yp.to</I>.



the remote directory is <I>/</I>.



and <I>/private/file/0/mirror/cr.yp.to</I> is the local
directory.



<A NAME="lbAP">&nbsp;</A>
<H2>AUTHOR</H2>

Uwe Ohse, <A HREF="mailto:uwe@ohse.de">uwe@ohse.de</A>
<A NAME="lbAQ">&nbsp;</A>
<H2>SEE ALSO</H2>



 <B>ftpls.html</B><A HREF="../man1/ftpls.1.php">ftpls</A>(1)  



 <B>ftpcp.html</B><A HREF="../man1/ftpcp.1.php">ftpcp</A>(1)  






The homepage may be more up-to-date, see
<BR>

<A HREF="http://www.ohse.de/uwe/ftpcopy.html.">http://www.ohse.de/uwe/ftpcopy.html.</A>

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">OPTIONS</A><DD>
<DL>
<DT><A HREF="#lbAF">bsection</A><DD>
<DT><A HREF="#lbAG">bsection</A><DD>
<DT><A HREF="#lbAH">bsection</A><DD>
<DT><A HREF="#lbAI">bsection</A><DD>
<DT><A HREF="#lbAJ">bsection</A><DD>
<DT><A HREF="#lbAK">bsection</A><DD>
</DL>
<DT><A HREF="#lbAL">REMOVED OPTIONS</A><DD>
<DT><A HREF="#lbAM">IN/EXCLUDE</A><DD>
<DT><A HREF="#lbAN">EXAMPLES</A><DD>
<DL>
<DT><A HREF="#lbAO">bsection</A><DD>
</DL>
<DT><A HREF="#lbAP">AUTHOR</A><DD>
<DT><A HREF="#lbAQ">SEE ALSO</A><DD>
</DL>

</div>






</div>




</body>
</html>
